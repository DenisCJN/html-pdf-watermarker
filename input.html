
<!-- saved from url=(0067)https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=600, initial-scale=1"><style>body{max-width:680px;margin:auto;padding:20px;text-align:justify;line-height:140%;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font-smoothing:antialiased;color:#222;font-family:Palatino,Georgia,"Times New Roman",serif}</style><style>@media print{*{-webkit-print-color-adjust:exact;text-shadow:none !important}}body{counter-reset: h1 paragraph line item list-item}@page{margin:0;size:auto}#mdContextMenu{position:absolute;background:#383838;cursor:default;border:1px solid #999;color:#fff;padding:4px 0px;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,"Helvetica Neue",sans-serif;font-size:85%;font-weight:600;border-radius:4px;box-shadow:0px 3px 10px rgba(0,0,0,35%)}#mdContextMenu div{padding:0px 20px}#mdContextMenu div:hover{background:#1659d1}.md code,.md pre{font-family:Menlo,Consolas,monospace;font-size:85%;text-align:left;line-height:140%}.md .mediumToc code,.md longToc code,.md .shortToc code,.md h1 code,.md h2 code,.md h3 code,.md h4 code,.md h5 code,.md h6 code{font-size:unset}.md div.title{font-size:26px;font-weight:800;line-height:120%;text-align:center}.md div.afterTitles{height:10px}.md div.subtitle{text-align:center}.md iframe.textinsert, .md object.textinsert,.md iframe:not(.markdeep){display:block;margin-top:10px;margin-bottom:10px;width:100%;height:75vh;border:1px solid #000;border-radius:4px;background:#f5f5f4}.md .image{display:inline-block}.md img{max-width:100%;page-break-inside:avoid}.md li{text-align:left;text-indent:0}.md pre.listing {width:100%;tab-size:4;-moz-tab-size:4;-o-tab-size:4;counter-reset:line;overflow-x:auto;resize:horizontal}.md pre.listing .linenumbers span.line:before{width:30px;margin-left:-28px;font-size:80%;text-align:right;counter-increment:line;content:counter(line);display:inline-block;padding-right:13px;margin-right:8px;color:#ccc}.md div.tilde{margin:20px 0 -10px;text-align:center}.md .imagecaption,.md .tablecaption,.md .listingcaption{display:inline-block;margin:7px 5px 12px;text-align:justify;font-style:italic}.md img.pixel{image-rendering:-moz-crisp-edges;image-rendering:pixelated}.md blockquote.fancyquote{margin:25px 0 25px;text-align:left;line-height:160%}.md blockquote.fancyquote::before{content:"“";color:#DDD;font-family:Times New Roman;font-size:45px;line-height:0;margin-right:6px;vertical-align:-0.3em}.md span.fancyquote{font-size:118%;color:#777;font-style:italic}.md span.fancyquote::after{content:"”";font-style:normal;color:#DDD;font-family:Times New Roman;font-size:45px;line-height:0;margin-left:6px;vertical-align:-0.3em}.md blockquote.fancyquote .author{width:100%;margin-top:10px;display:inline-block;text-align:right}.md small{font-size:60%}.md big{font-size:150%}.md div.title,contents,.md .tocHeader,.md h1,.md h2,.md h3,.md h4,.md h5,.md h6,.md .shortTOC,.md .mediumTOC,.nonumberh1,.nonumberh2,.nonumberh3,.nonumberh4,.nonumberh5,.nonumberh6{font-family:Verdana,Helvetica,Arial,sans-serif;margin:13.4px 0 13.4px;padding:15px 0 3px;border-top:none;clear:both}.md .tocTop {display:none}.md h1,.md h2,.md h3,.md h4,.md h5,.md h6,.md .nonumberh1,.md .nonumberh2,.md .nonumberh3,.md .nonumberh4,.md .nonumberh5,.md .nonumberh6{page-break-after:avoid;break-after:avoid}.md svg.diagram{display:block;font-family:Menlo,Consolas,monospace;font-size:85%;text-align:center;stroke-linecap:round;stroke-width:2px;page-break-inside:avoid;stroke:#000;fill:#000}.md svg.diagram .opendot{fill:#fff}.md svg.diagram .shadeddot{fill:#CCC}.md svg.diagram .dotteddot{stroke:#000;stroke-dasharray:4;fill:none}.md svg.diagram text{stroke:none}@media print{@page{margin:1in 5mm;transform: scale(150%)}}@media print{.md .pagebreak{page-break-after:always;visibility:hidden}}.md a{font-family:Georgia,Palatino,'Times New Roman'}.md h1,.md .tocHeader,.md .nonumberh1{border-bottom:3px solid;font-size:20px;font-weight:bold;}.md h1,.md .nonumberh1{counter-reset:h2 h3 h4 h5 h6}.md h2,.md .nonumberh2{counter-reset:h3 h4 h5 h6;border-bottom:2px solid #999;color:#555;font-weight:bold;font-size:18px;}.md h3,.md h4,.md h5,.md h6,.md .nonumberh3,.md .nonumberh4,.md .nonumberh5,.md .nonumberh6{font-family:Verdana,Helvetica,Arial,sans-serif;color:#555;font-size:16px;}.md h3{counter-reset:h4 h5 h6}.md h4{counter-reset:h5 h6}.md h5{counter-reset:h6}.md div.table{margin:16px 0 16px 0}.md table{border-collapse:collapse;line-height:140%;page-break-inside:avoid}.md table.table{margin:auto}.md table.calendar{width:100%;margin:auto;font-size:11px;font-family:Verdana,Helvetica,Arial,sans-serif}.md table.calendar th{font-size:16px}.md .today{background:#ECF8FA}.md .calendar .parenthesized{color:#999;font-style:italic}.md table.table th{color:#FFF;background-color:#AAA;border:1px solid #888;padding:8px 15px 8px 15px}.md table.table td{padding:5px 15px 5px 15px;border:1px solid #888}.md table.table tr:nth-child(even){background:#EEE}.md pre.tilde{border-top: 1px solid #CCC;border-bottom: 1px solid #CCC;padding: 5px 0 5px 20px;margin:0 0 0 0;background:#FCFCFC;page-break-inside:avoid}.md a.target{width:0px;height:0px;visibility:hidden;font-size:0px;display:inline-block}.md a:link, .md a:visited{color:#38A;text-decoration:none}.md a:link:hover{text-decoration:underline}.md dt{font-weight:700}.md dl>dd{margin-top:-8px; margin-bottom:8px}.md dl>table{margin:35px 0 30px}.md code{page-break-inside:avoid;} @media print{.md .listing code{white-space:pre-wrap}}.md .endnote{font-size:13px;line-height:15px;padding-left:10px;text-indent:-10px}.md .bib{padding-left:80px;text-indent:-80px;text-align:left}.markdeepFooter{font-size:9px;text-align:right;padding-top:80px;color:#999}.md .mediumTOC{float:right;font-size:12px;line-height:15px;border-left:1px solid #CCC;padding-left:15px;margin:15px 0px 15px 25px}.md .mediumTOC .level1{font-weight:600}.md .longTOC .level1{font-weight:600;display:block;padding-top:12px;margin:0 0 -20px}.md .shortTOC{text-align:center;font-weight:bold;margin-top:15px;font-size:14px}.md .admonition{position:relative;margin:1em 0;padding:.4rem 1rem;border-radius:.2rem;border-left:2.5rem solid rgba(68,138,255,.4);background-color:rgba(68,138,255,.15);}.md .admonition-title{font-weight:bold;border-bottom:solid 1px rgba(68,138,255,.4);padding-bottom:4px;margin-bottom:4px;margin-left: -1rem;padding-left:1rem;margin-right:-1rem;border-color:rgba(68,138,255,.4)}.md .admonition.tip{border-left:2.5rem solid rgba(50,255,90,.4);background-color:rgba(50,255,90,.15)}.md .admonition.tip::before{content:"\24d8";font-weight:bold;font-size:150%;position:relative;top:3px;color:rgba(26,128,46,.8);left:-2.95rem;display:block;width:0;height:0}.md .admonition.tip>.admonition-title{border-color:rgba(50,255,90,.4)}.md .admonition.warn,.md .admonition.warning{border-left:2.5rem solid rgba(255,145,0,.4);background-color:rgba(255,145,0,.15)}.md .admonition.warn::before,.md .admonition.warning::before{content:"\26A0";font-weight:bold;font-size:150%;position:relative;top:2px;color:rgba(128,73,0,.8);left:-2.95rem;display:block;width:0;height:0}.md .admonition.warn>.admonition-title,.md .admonition.warning>.admonition-title{border-color:rgba(255,145,0,.4)}.md .admonition.error{border-left: 2.5rem solid rgba(255,23,68,.4);background-color:rgba(255,23,68,.15)}.md .admonition.error>.admonition-title{border-color:rgba(255,23,68,.4)}.md .admonition.error::before{content: "\2612";font-family:"Arial";font-size:200%;position:relative;color:rgba(128,12,34,.8);top:-2px;left:-3rem;display:block;width:0;height:0}.md .admonition p:last-child{margin-bottom:0}.md li.checked,.md li.unchecked{list-style:none;overflow:visible;text-indent:-1.2em}.md li.checked:before,.md li.unchecked:before{content:"\2611";display:block;float:left;width:1em;font-size:120%}.md li.unchecked:before{content:"\2610"}</style><style>.md h1::before {
content:counter(h1) " ";
counter-increment: h1;margin-right:10px}

.md h2::before {
content:counter(h1) "."counter(h2) " ";
counter-increment: h2;margin-right:10px}

.md h3::before {
content:counter(h1) "."counter(h2) "."counter(h3) " ";
counter-increment: h3;margin-right:10px}

.md h4::before {
content:counter(h1) "."counter(h2) "."counter(h3) "."counter(h4) " ";
counter-increment: h4;margin-right:10px}

.md h5::before {
content:counter(h1) "."counter(h2) "."counter(h3) "."counter(h4) "."counter(h5) " ";
counter-increment: h5;margin-right:10px}

.md h6::before {
content:counter(h1) "."counter(h2) "."counter(h3) "."counter(h4) "."counter(h5) "."counter(h6) " ";
counter-increment: h6;margin-right:10px}

</style><style>.hljs{display:block;overflow-x:auto;padding:0.5em;background:#fff;color:#000;-webkit-text-size-adjust:none}.hljs-comment{color:#006a00}.hljs-keyword{color:#02E}.hljs-literal,.nginx .hljs-title{color:#aa0d91}.method,.hljs-list .hljs-title,.hljs-tag .hljs-title,.setting .hljs-value,.hljs-winutils,.tex .hljs-command,.http .hljs-title,.hljs-request,.hljs-status,.hljs-name{color:#008}.hljs-envvar,.tex .hljs-special{color:#660}.hljs-string{color:#c41a16}.hljs-tag .hljs-value,.hljs-cdata,.hljs-filter .hljs-argument,.hljs-attr_selector,.apache .hljs-cbracket,.hljs-date,.hljs-regexp{color:#080}.hljs-sub .hljs-identifier,.hljs-pi,.hljs-tag,.hljs-tag .hljs-keyword,.hljs-decorator,.ini .hljs-title,.hljs-shebang,.hljs-prompt,.hljs-hexcolor,.hljs-rule .hljs-value,.hljs-symbol,.hljs-symbol .hljs-string,.hljs-number,.css .hljs-function,.hljs-function .hljs-title,.coffeescript .hljs-attribute{color:#A0C}.hljs-function .hljs-title{font-weight:bold;color:#000}.hljs-class .hljs-title,.smalltalk .hljs-class,.hljs-type,.hljs-typename,.hljs-tag .hljs-attribute,.hljs-doctype,.hljs-class .hljs-id,.hljs-built_in,.setting,.hljs-params,.clojure .hljs-attribute{color:#5c2699}.hljs-variable{color:#3f6e74}.css .hljs-tag,.hljs-rule .hljs-property,.hljs-pseudo,.hljs-subst{color:#000}.css .hljs-class,.css .hljs-id{color:#9b703f}.hljs-value .hljs-important{color:#ff7700;font-weight:bold}.hljs-rule .hljs-keyword{color:#c5af75}.hljs-annotation,.apache .hljs-sqbracket,.nginx .hljs-built_in{color:#9b859d}.hljs-preprocessor,.hljs-preprocessor *,.hljs-pragma{color:#643820}.tex .hljs-formula{background-color:#eee;font-style:italic}.diff .hljs-header,.hljs-chunk{color:#808080;font-weight:bold}.diff .hljs-change{background-color:#bccff9}.hljs-addition{background-color:#baeeba}.hljs-deletion{background-color:#ffc8bd}.hljs-comment .hljs-doctag{font-weight:bold}.method .hljs-id{color:#000}</style><style>div.title { padding-top: 40px; } div.afterTitles { height: 15px; }</style>
<link rel="icon" type="image/png" href="https://raytracing.github.io/favicon.png">
<!-- Markdeep: https://casual-effects.com/markdeep/ -->



                               <script type="text/javascript" src="./input_files/MathJax.js"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover, .MJXp-munder {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > *, .MJXp-munder > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none; box-sizing: content-box}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_test {font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow: hidden; height: 1px}
.MathJax_test.mjx-test-display {display: table!important}
.MathJax_test.mjx-test-inline {display: inline!important; margin-right: -1px}
.MathJax_test.mjx-test-default {display: block!important; clear: both}
.MathJax_ex_box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60ex}
.MathJax_em_box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60em}
.mjx-test-inline .MathJax_left_box {display: inline-block; width: 0; float: left}
.mjx-test-inline .MathJax_right_box {display: inline-block; width: 0; float: right}
.mjx-test-display .MathJax_right_box {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head><body id="md" style="visibility: visible;"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"><br></div></div><div id="MathJax_Message" style="display: none;"></div><script type="text/x-mathjax-config;executed=true">MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "AMS"} } });</script><span style="display:none"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot; /&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 0em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(3.825em, 1000em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mrow" id="MathJax-Span-2"></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.128em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-1">\newcommand{\n}{\hat{n}}\newcommand{\thetai}{\theta_\mathrm{i}}\newcommand{\thetao}{\theta_\mathrm{o}}\newcommand{\d}[1]{\mathrm{d}#1}\newcommand{\w}{\hat{\omega}}\newcommand{\wi}{\w_\mathrm{i}}\newcommand{\wo}{\w_\mathrm{o}}\newcommand{\wh}{\w_\mathrm{h}}\newcommand{\Li}{L_\mathrm{i}}\newcommand{\Lo}{L_\mathrm{o}}\newcommand{\Le}{L_\mathrm{e}}\newcommand{\Lr}{L_\mathrm{r}}\newcommand{\Lt}{L_\mathrm{t}}\newcommand{\O}{\mathrm{O}}\newcommand{\degrees}{{^{\large\circ}}}\newcommand{\T}{\mathsf{T}}\newcommand{\mathset}[1]{\mathbb{#1}}\newcommand{\Real}{\mathset{R}}\newcommand{\Integer}{\mathset{Z}}\newcommand{\Boolean}{\mathset{B}}\newcommand{\Complex}{\mathset{C}}\newcommand{\un}[1]{\,\mathrm{#1}}</script>
</span>
<span class="md"><p><title>Ray Tracing: The Rest of Your Life</title></p><div class="title"> Ray Tracing: The Rest of Your Life </div>

<div class="subtitle"> <a href="https://github.com/petershirley">Peter Shirley</a>, <a href="https://github.com/trevordblack">Trevor David Black</a>, <a href="https://github.com/hollasch">Steve Hollasch</a> </div>
<div class="subtitle"> <br> </div>
<div class="subtitle"> Version 4.0.0-alpha.2, 2024-04-07 </div>
<div class="subtitle"> <br> </div>
<div class="subtitle"> Copyright 2018-2024 Peter Shirley. All rights reserved. </div>
<div class="afterTitles"></div>

<p></p>
<div class="longTOC"><div class="tocHeader">Contents</div><p><a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#" class="tocTop">(Top)</a><br>
<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#overview" class="level1"><span class="tocNumber">1&nbsp; </span>Overview</a><br>
<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#asimplemontecarloprogram" class="level1"><span class="tocNumber">2&nbsp; </span>A Simple Monte Carlo Program</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#asimplemontecarloprogram/estimatingpi" class="level2"><span class="tocNumber">2.1&nbsp; </span>Estimating Pi</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#asimplemontecarloprogram/showingconvergence" class="level2"><span class="tocNumber">2.2&nbsp; </span>Showing Convergence</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#asimplemontecarloprogram/stratifiedsamples(jittering)" class="level2"><span class="tocNumber">2.3&nbsp; </span>Stratified Samples (Jittering)</a><br>
<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#onedimensionalmontecarlointegration" class="level1"><span class="tocNumber">3&nbsp; </span>One Dimensional Monte Carlo Integration</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#onedimensionalmontecarlointegration/expectedvalue" class="level2"><span class="tocNumber">3.1&nbsp; </span>Expected Value</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#onedimensionalmontecarlointegration/integratingx%C2%B2" class="level2"><span class="tocNumber">3.2&nbsp; </span>Integrating x²</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#onedimensionalmontecarlointegration/densityfunctions" class="level2"><span class="tocNumber">3.3&nbsp; </span>Density Functions</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#onedimensionalmontecarlointegration/constructingapdf" class="level2"><span class="tocNumber">3.4&nbsp; </span>Constructing a PDF</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#onedimensionalmontecarlointegration/choosingoursamples" class="level2"><span class="tocNumber">3.5&nbsp; </span>Choosing our Samples</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#onedimensionalmontecarlointegration/approximatingdistributions" class="level2"><span class="tocNumber">3.6&nbsp; </span>Approximating Distributions</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#onedimensionalmontecarlointegration/importancesampling" class="level2"><span class="tocNumber">3.7&nbsp; </span>Importance Sampling</a><br>
<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#montecarlointegrationonthesphereofdirections" class="level1"><span class="tocNumber">4&nbsp; </span>Monte Carlo Integration on the Sphere of Directions</a><br>
<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#lightscattering" class="level1"><span class="tocNumber">5&nbsp; </span>Light Scattering</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#lightscattering/albedo" class="level2"><span class="tocNumber">5.1&nbsp; </span>Albedo</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#lightscattering/scattering" class="level2"><span class="tocNumber">5.2&nbsp; </span>Scattering</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#lightscattering/thescatteringpdf" class="level2"><span class="tocNumber">5.3&nbsp; </span>The Scattering PDF</a><br>
<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#playingwithimportancesampling" class="level1"><span class="tocNumber">6&nbsp; </span>Playing with Importance Sampling</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#playingwithimportancesampling/returningtothecornellbox" class="level2"><span class="tocNumber">6.1&nbsp; </span>Returning to the Cornell Box</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#playingwithimportancesampling/usingauniformpdfinsteadofaperfectmatch" class="level2"><span class="tocNumber">6.2&nbsp; </span>Using a Uniform PDF Instead of a Perfect Match</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#playingwithimportancesampling/randomhemisphericalsampling" class="level2"><span class="tocNumber">6.3&nbsp; </span>Random Hemispherical Sampling</a><br>
<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#generatingrandomdirections" class="level1"><span class="tocNumber">7&nbsp; </span>Generating Random Directions</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#generatingrandomdirections/randomdirectionsrelativetothezaxis" class="level2"><span class="tocNumber">7.1&nbsp; </span>Random Directions Relative to the Z Axis</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#generatingrandomdirections/uniformsamplingahemisphere" class="level2"><span class="tocNumber">7.2&nbsp; </span>Uniform Sampling a Hemisphere</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#generatingrandomdirections/cosinesamplingahemisphere" class="level2"><span class="tocNumber">7.3&nbsp; </span>Cosine Sampling a Hemisphere</a><br>
<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#orthonormalbases" class="level1"><span class="tocNumber">8&nbsp; </span>Orthonormal Bases</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#orthonormalbases/relativecoordinates" class="level2"><span class="tocNumber">8.1&nbsp; </span>Relative Coordinates</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#orthonormalbases/generatinganorthonormalbasis" class="level2"><span class="tocNumber">8.2&nbsp; </span>Generating an Orthonormal Basis</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#orthonormalbases/theonbclass" class="level2"><span class="tocNumber">8.3&nbsp; </span>The ONB Class</a><br>
<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#samplinglightsdirectly" class="level1"><span class="tocNumber">9&nbsp; </span>Sampling Lights Directly</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#samplinglightsdirectly/gettingthepdfofalight" class="level2"><span class="tocNumber">9.1&nbsp; </span>Getting the PDF of a Light</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#samplinglightsdirectly/lightsampling" class="level2"><span class="tocNumber">9.2&nbsp; </span>Light Sampling</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#samplinglightsdirectly/switchingtounidirectionallight" class="level2"><span class="tocNumber">9.3&nbsp; </span>Switching to Unidirectional Light</a><br>
<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#mixturedensities" class="level1"><span class="tocNumber">10&nbsp; </span>Mixture Densities</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#mixturedensities/thepdfclass" class="level2"><span class="tocNumber">10.1&nbsp; </span>The PDF Class</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#mixturedensities/samplingdirectionstowardsahittable" class="level2"><span class="tocNumber">10.2&nbsp; </span>Sampling Directions towards a Hittable</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#mixturedensities/themixturepdfclass" class="level2"><span class="tocNumber">10.3&nbsp; </span>The Mixture PDF Class</a><br>
<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#somearchitecturaldecisions" class="level1"><span class="tocNumber">11&nbsp; </span>Some Architectural Decisions</a><br>
<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#cleaninguppdfmanagement" class="level1"><span class="tocNumber">12&nbsp; </span>Cleaning Up PDF Management</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#cleaninguppdfmanagement/diffuseversusspecular" class="level2"><span class="tocNumber">12.1&nbsp; </span>Diffuse Versus Specular</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#cleaninguppdfmanagement/handlingspecular" class="level2"><span class="tocNumber">12.2&nbsp; </span>Handling Specular</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#cleaninguppdfmanagement/samplingasphereobject" class="level2"><span class="tocNumber">12.3&nbsp; </span>Sampling a Sphere Object</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#cleaninguppdfmanagement/updatingthespherecode" class="level2"><span class="tocNumber">12.4&nbsp; </span>Updating the Sphere Code</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#cleaninguppdfmanagement/addingpdffunctionstohittablelists" class="level2"><span class="tocNumber">12.5&nbsp; </span>Adding PDF Functions to Hittable Lists</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#cleaninguppdfmanagement/handlingsurfaceacne" class="level2"><span class="tocNumber">12.6&nbsp; </span>Handling Surface Acne</a><br>
<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#therestofyourlife" class="level1"><span class="tocNumber">13&nbsp; </span>The Rest of Your Life</a><br>
<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#acknowledgments" class="level1"><span class="tocNumber">14&nbsp; </span>Acknowledgments</a><br>
<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#citingthisbook" class="level1"><span class="tocNumber">15&nbsp; </span>Citing This Book</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#citingthisbook/basicdata" class="level2"><span class="tocNumber">15.1&nbsp; </span>Basic Data</a><br>
&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#citingthisbook/snippets" class="level2"><span class="tocNumber">15.2&nbsp; </span>Snippets</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#citingthisbook/snippets/markdown" class="level3"><span class="tocNumber">15.2.1&nbsp; </span>Markdown</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#citingthisbook/snippets/html" class="level3"><span class="tocNumber">15.2.2&nbsp; </span>HTML</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#citingthisbook/snippets/latexandbibtex" class="level3"><span class="tocNumber">15.2.3&nbsp; </span>LaTeX and BibTex</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#citingthisbook/snippets/biblatex" class="level3"><span class="tocNumber">15.2.4&nbsp; </span>BibLaTeX</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#citingthisbook/snippets/ieee" class="level3"><span class="tocNumber">15.2.5&nbsp; </span>IEEE</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#citingthisbook/snippets/mla:" class="level3"><span class="tocNumber">15.2.6&nbsp; </span>MLA:</a><br>
</p></div><a class="target" name="overview">&nbsp;</a><a class="target" name="overview">&nbsp;</a><a class="target" name="toc1">&nbsp;</a><h1>Overview</h1>
<p>

In <em class="underscore">Ray Tracing in One Weekend</em> and <em class="underscore">Ray Tracing: the Next Week</em>, you built a “real” ray tracer.

</p><p>

If you are motivated, you can take the source and information contained in those books to implement
any visual effect you want. The source provides a meaningful and robust foundation upon which to
build out a raytracer for a small hobby project. Most of the visual effects found in commercial ray
tracers rely on the techniques described in these first two books. However, your capacity to add
increasingly complicated visual effects like subsurface scattering or nested dielectrics will be
severely limited by a missing mathematical foundation. In this volume, I assume that you are either
a highly interested student, or are someone who is pursuing a career related to ray tracing. We will
be diving into the math of creating a very serious ray tracer. When you are done, you should be well
equipped to use and modify the various commercial ray tracers found in many popular domains, such as
the movie, television, product design, and architecture industries.

</p><p>

There are many many things I do not cover in this short volume. For example, there are many ways of
writing Monte Carlo rendering programs—I dive into only one of them. I don’t cover shadow rays
(deciding instead to make rays more likely to go toward lights), nor do I cover bidirectional
methods, Metropolis methods, or photon mapping. You'll find many of these techniques in the
so-called “serious ray tracers”, but they are not covered here because it is more important to cover
the concepts, math, and terms of the field. I think of this book as a deep exposure that should be
your first of many, and it will equip you with some of the concepts, math, and terms that you'll
need in order to study these and other interesting techniques.

</p><p>

I hope that you find the math as fascinating as I do.

</p><p>

See the <a href="https://raytracing.github.io/README.md">project README</a> file for information about this project, the repository on GitHub,
directory structure, building &amp; running, and how to make or reference corrections and contributions.

</p><p>

As before, see <a href="https://github.com/RayTracing/raytracing.github.io/wiki/Further-Readings">our Further Reading wiki page</a> for additional project related
resources.

</p><p>

These books have been formatted to print well directly from your browser. We also include PDFs of
each book <a href="https://github.com/RayTracing/raytracing.github.io/releases/">with each release</a>, in the “Assets” section.

</p><p>

Thanks to everyone who lent a hand on this project. You can find them in the <a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#acknowledgments">acknowledgments</a> section
at the end of this book.

</p>
<a class="target" name="asimplemontecarloprogram">&nbsp;</a><a class="target" name="asimplemontecarloprogram">&nbsp;</a><a class="target" name="toc2">&nbsp;</a><h1>A Simple Monte Carlo Program</h1>
<p>

Let’s start with one of the simplest Monte Carlo programs. If you're not familiar with Monte Carlo
programs, then it'll be good to pause and catch you up. There are two kinds of randomized
algorithms: Monte Carlo and Las Vegas. Randomized algorithms can be found everywhere in computer
graphics, so getting a decent foundation isn't a bad idea. A randomized algorithm uses some amount
of randomness in its computation. A Las Vegas (LV) random algorithm always produces the correct
result, whereas a Monte Carlo (MC) algorithm <em class="underscore">may</em> produce a correct result—and frequently gets it
wrong! But for especially complicated problems such as ray tracing, we may not place as huge a
priority on being perfectly exact as on getting an answer in a reasonable amount of time. LV
algorithms will eventually arrive at the correct result, but we can't make too many guarantees on
how long it will take to get there. The classic example of an LV algorithm is the <em class="underscore">quicksort</em>
sorting algorithm. The quicksort algorithm will always complete with a fully sorted list, but, the
time it takes to complete is random. Another good example of an LV algorithm is the code that we use
to pick a random point in a unit sphere:

</p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-function"><span class="hljs-keyword">inline</span> vec3 <span class="hljs-title">random_in_unit_sphere</span><span class="hljs-params">()</span> </span>{
<span class="line"></span>    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
<span class="line"></span>        <span class="hljs-keyword">auto</span> p = vec3::<span class="hljs-built_in">random</span>(<span class="hljs-number">-1</span>,<span class="hljs-number">1</span>);
<span class="line"></span>        <span class="hljs-keyword">if</span> (p.<span class="hljs-built_in">length_squared</span>() &lt; <span class="hljs-number">1</span>)
<span class="line"></span>            <span class="hljs-keyword">return</span> p;
<span class="line"></span>    }
<span class="line"></span>}</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_las-vegas-algo">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;1:</b> <kbd>[vec3.h]</kbd> A Las Vegas algorithm</div></center>
<p>


This code will always eventually arrive at a random point in the unit sphere, but we can't say
beforehand how long it'll take. It may take only 1 iteration, it may take 2, 3, 4, or even longer.
Whereas, an MC program will give a statistical estimate of an answer, and this estimate will get
more and more accurate the longer you run it. Which means that at a certain point, we can just
decide that the answer is accurate <em class="underscore">enough</em> and call it quits. This basic characteristic of simple
programs producing noisy but ever-better answers is what MC is all about, and is especially good for
applications like graphics where great accuracy is not needed.

</p>
<a class="target" name="estimatingpi">&nbsp;</a><a class="target" name="asimplemontecarloprogram/estimatingpi">&nbsp;</a><a class="target" name="toc2.1">&nbsp;</a><h2>Estimating Pi</h2>
<p>

The canonical example of a Monte Carlo algorithm is estimating <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-4"><span class="mi" id="MathJax-Span-5"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">\pi</script>, so let's do that. There are
many ways to estimate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-7"><span class="mi" id="MathJax-Span-8"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-3">\pi</script>, with the Buffon Needle problem being a classic case study. We’ll do a
variation inspired by this method. Suppose you have a circle inscribed inside a square:

</p><p>

  </p><center><div class="image" style=""><a href="./input_files/fig-3.01-circ-square.jpg" target="_blank"><img class="markdeep" src="./input_files/fig-3.01-circ-square.jpg"></a><center><span class="imagecaption"><a class="target" name="figure_circ-square">&nbsp;</a><b style="font-style:normal;">Figure&nbsp;1:</b> Estimating π with a circle inside a square
  </span></center></div></center>

<p></p><p>

Now, suppose you pick random points inside the square. The fraction of those random points that end
up inside the circle should be proportional to the area of the circle. The exact fraction should in
fact be the ratio of the circle area to the square area:

</p><p>

  <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-9" style="width: 4.496em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.722em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.519em, 1003.72em, 3.463em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-10"><span class="mfrac" id="MathJax-Span-11"><span style="display: inline-block; position: relative; width: 1.707em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.139em, 1001.04em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.514em;"><span class="mrow" id="MathJax-Span-12"><span class="mi" id="MathJax-Span-13"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span class="msubsup" id="MathJax-Span-14"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-15"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.218em; left: 0.261em;"><span class="mn" id="MathJax-Span-16" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.191em, 1001.6em, 2.585em, -999.997em); top: -1.392em; left: 50%; margin-left: -0.772em;"><span class="mrow" id="MathJax-Span-17"><span class="mo" id="MathJax-Span-18"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-19"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-20"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="msubsup" id="MathJax-Span-21"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mo" id="MathJax-Span-22"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.167em; left: 0.261em;"><span class="mn" id="MathJax-Span-23" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1001.71em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.707em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mo" id="MathJax-Span-24" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-25" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mi" id="MathJax-Span-26"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-27"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">4</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.52em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.519em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.309em; border-left: 0px solid; width: 0px; height: 3.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mrow><mi>π</mi><msup><mi>r</mi><mn>2</mn></msup></mrow><mrow><mo stretchy="false">(</mo><mn>2</mn><mi>r</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></mfrac><mo>=</mo><mfrac><mi>π</mi><mn>4</mn></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-4"> \frac{\pi r^2}{(2r)^2} = \frac{\pi}{4} </script>

</p><p>

</p><div class="together">
Since the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-28" style="width: 0.313em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.261em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-29"><span class="mi" id="MathJax-Span-30"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-5">r</script> cancels out, we can pick whatever is computationally convenient. Let’s go with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-31" style="width: 2.224em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.81em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1001.81em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-32"><span class="mi" id="MathJax-Span-33"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-34" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-35" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-6">r=1</script>,
centered at the origin:

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"rtweekend.h"</span></span>
<span class="line"></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iomanip&gt;</span></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;math.h&gt;</span></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span>
<span class="line"></span>
<span class="line"></span><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
<span class="line"></span>    <span class="hljs-type">int</span> N = <span class="hljs-number">100000</span>;
<span class="line"></span>    <span class="hljs-type">int</span> inside_circle = <span class="hljs-number">0</span>;
<span class="line"></span>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; N; i++) {
<span class="line"></span>        <span class="hljs-keyword">auto</span> x = <span class="hljs-built_in">random_double</span>(<span class="hljs-number">-1</span>,<span class="hljs-number">1</span>);
<span class="line"></span>        <span class="hljs-keyword">auto</span> y = <span class="hljs-built_in">random_double</span>(<span class="hljs-number">-1</span>,<span class="hljs-number">1</span>);
<span class="line"></span>        <span class="hljs-keyword">if</span> (x*x + y*y &lt; <span class="hljs-number">1</span>)
<span class="line"></span>            inside_circle++;
<span class="line"></span>    }
<span class="line"></span>    std::cout &lt;&lt; std::fixed &lt;&lt; std::<span class="hljs-built_in">setprecision</span>(<span class="hljs-number">12</span>);
<span class="line"></span>    std::cout &lt;&lt; <span class="hljs-string">"Estimate of Pi = "</span> &lt;&lt; (<span class="hljs-number">4.0</span> * inside_circle) / N &lt;&lt; <span class="hljs-string">'\n'</span>;
<span class="line"></span>}</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_estpi-1">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;2:</b> <kbd>[pi.cc]</kbd> Estimating π</div></center>
<p>


The answer of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-36" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-37"><span class="mi" id="MathJax-Span-38"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">\pi</script> found will vary from computer to computer based on the initial random seed. On
my computer, this gives me the answer <code>Estimate of Pi = 3.143760000000</code>.

</p><p>

</p></div>

<p></p>
<a class="target" name="showingconvergence">&nbsp;</a><a class="target" name="asimplemontecarloprogram/showingconvergence">&nbsp;</a><a class="target" name="toc2.2">&nbsp;</a><h2>Showing Convergence</h2>
<p>

If we change the program to run forever and just print out a running estimate:

</p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"rtweekend.h"</span></span>
<span class="line"></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iomanip&gt;</span></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;math.h&gt;</span></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span>
<span class="line"></span>
<span class="line"></span><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
<span class="line"></span>    <span class="hljs-type">int</span> inside_circle = <span class="hljs-number">0</span>;
<span class="line"></span>    <span class="hljs-type">int</span> runs = <span class="hljs-number">0</span>;
<span class="line"></span>    std::cout &lt;&lt; std::fixed &lt;&lt; std::<span class="hljs-built_in">setprecision</span>(<span class="hljs-number">12</span>);
<span class="line"></span>    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
<span class="line"></span>        runs++;
<span class="line"></span>        <span class="hljs-keyword">auto</span> x = <span class="hljs-built_in">random_double</span>(<span class="hljs-number">-1</span>,<span class="hljs-number">1</span>);
<span class="line"></span>        <span class="hljs-keyword">auto</span> y = <span class="hljs-built_in">random_double</span>(<span class="hljs-number">-1</span>,<span class="hljs-number">1</span>);
<span class="line"></span>        <span class="hljs-keyword">if</span> (x*x + y*y &lt; <span class="hljs-number">1</span>)
<span class="line"></span>            inside_circle++;
<span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">if</span> (runs % <span class="hljs-number">100000</span> == <span class="hljs-number">0</span>)
<span class="line"></span>            std::cout &lt;&lt; <span class="hljs-string">"Estimate of Pi = "</span>
<span class="line"></span>                      &lt;&lt; (<span class="hljs-number">4.0</span> * inside_circle) / runs
<span class="line"></span>                      &lt;&lt; <span class="hljs-string">'\n'</span>;
<span class="line"></span>    }
<span class="line"></span>}</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_estpi-2">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;3:</b> <kbd>[pi.cc]</kbd> Estimating π, v2</div></center>

<a class="target" name="stratifiedsamples(jittering)">&nbsp;</a><a class="target" name="asimplemontecarloprogram/stratifiedsamples(jittering)">&nbsp;</a><a class="target" name="toc2.3">&nbsp;</a><h2>Stratified Samples (Jittering)</h2>
<p>

We get very quickly near <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-39" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-40"><span class="mi" id="MathJax-Span-41"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">\pi</script>, and then more slowly zero in on it. This is an example of the <em class="underscore">Law
of Diminishing Returns</em>, where each sample helps less than the last. This is the worst part of Monte
Carlo. We can mitigate this diminishing return by <em class="underscore">stratifying</em> the samples (often called
<em class="underscore">jittering</em>), where instead of taking random samples, we take a grid and take one sample within
each:

</p><p>

  </p><center><div class="image" style=""><a href="./input_files/fig-3.02-jitter.jpg" target="_blank"><img class="markdeep" src="./input_files/fig-3.02-jitter.jpg"></a><center><span class="imagecaption"><a class="target" name="figure_jitter">&nbsp;</a><b style="font-style:normal;">Figure&nbsp;2:</b> Sampling areas with jittered points</span></center></div></center>

<p></p><p>

</p><div class="together">
This changes the sample generation, but we need to know how many samples we are taking in advance
because we need to know the grid. Let’s take a million and try it both ways:

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"rtweekend.h"</span></span>
<span class="line"></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iomanip&gt;</span></span>
<span class="line"></span>
<span class="line"></span><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
<span class="line"></span>    <span class="hljs-type">int</span> inside_circle = <span class="hljs-number">0</span>;
<span class="line"></span>    <span class="hljs-type">int</span> inside_circle_stratified = <span class="hljs-number">0</span>;
<span class="line"></span>    <span class="hljs-type">int</span> sqrt_N = <span class="hljs-number">1000</span>;
<span class="line"></span>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; sqrt_N; i++) {
<span class="line"></span>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; sqrt_N; j++) {
<span class="line"></span>            <span class="hljs-keyword">auto</span> x = <span class="hljs-built_in">random_double</span>(<span class="hljs-number">-1</span>,<span class="hljs-number">1</span>);
<span class="line"></span>            <span class="hljs-keyword">auto</span> y = <span class="hljs-built_in">random_double</span>(<span class="hljs-number">-1</span>,<span class="hljs-number">1</span>);
<span class="line"></span>            <span class="hljs-keyword">if</span> (x*x + y*y &lt; <span class="hljs-number">1</span>)
<span class="line"></span>                inside_circle++;
<span class="line"></span>            x = <span class="hljs-number">2</span>*((i + <span class="hljs-built_in">random_double</span>()) / sqrt_N) - <span class="hljs-number">1</span>;
<span class="line"></span>            y = <span class="hljs-number">2</span>*((j + <span class="hljs-built_in">random_double</span>()) / sqrt_N) - <span class="hljs-number">1</span>;
<span class="line"></span>            <span class="hljs-keyword">if</span> (x*x + y*y &lt; <span class="hljs-number">1</span>)
<span class="line"></span>                inside_circle_stratified++;
<span class="line"></span>        }
<span class="line"></span>    }
<span class="line"></span>
<span class="line"></span>    std::cout &lt;&lt; std::fixed &lt;&lt; std::<span class="hljs-built_in">setprecision</span>(<span class="hljs-number">12</span>);
<span class="line"></span>    std::cout
<span class="line"></span>        &lt;&lt; <span class="hljs-string">"Regular    Estimate of Pi = "</span>
<span class="line"></span>        &lt;&lt; (<span class="hljs-number">4.0</span> * inside_circle) / (sqrt_N*sqrt_N) &lt;&lt; <span class="hljs-string">'\n'</span>
<span class="line"></span>        &lt;&lt; <span class="hljs-string">"Stratified Estimate of Pi = "</span>
<span class="line"></span>        &lt;&lt; (<span class="hljs-number">4.0</span> * inside_circle_stratified) / (sqrt_N*sqrt_N) &lt;&lt; <span class="hljs-string">'\n'</span>;
<span class="line"></span>}</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_estpi-3">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;4:</b> <kbd>[pi.cc]</kbd> Estimating π, v3</div></center>
<p>


</p></div>

<p></p><p>

</p><div class="together">
On my computer, I get:

<p></p><pre class="listing tilde"><code><span class="line"></span>Regular    Estimate <span class="hljs-type">of</span> <span class="hljs-variable">Pi</span> <span class="hljs-operator">=</span> <span class="hljs-number">3.141184000000</span>
<span class="line"></span>Stratified Estimate <span class="hljs-type">of</span> <span class="hljs-variable">Pi</span> <span class="hljs-operator">=</span> <span class="hljs-number">3.141460000000</span></code></pre><p>

Where the first 12 decimal places of pi are:

</p><pre class="listing tilde"><code><span class="line"></span>3.141592653589</code></pre><p>

</p></div>

<p></p><p>

Interestingly, the stratified method is not only better, it converges with a better asymptotic rate!
Unfortunately, this advantage decreases with the dimension of the problem (so for example, with the
3D sphere volume version the gap would be less). This is called the <em class="underscore">Curse of Dimensionality</em>. Ray
tracing is a very high-dimensional algorithm, where each reflection adds two new dimensions:
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-42" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.054em, 1000.88em, 1.501em, -999.997em); top: -0.979em; left: 0em;"><span class="mrow" id="MathJax-Span-43"><span class="msubsup" id="MathJax-Span-44"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-45"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ϕ</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-46" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.984em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>ϕ</mi><mi>o</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-9">\phi_o</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-47" style="width: 0.932em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.054em, 1000.78em, 1.501em, -999.997em); top: -0.979em; left: 0em;"><span class="mrow" id="MathJax-Span-48"><span class="msubsup" id="MathJax-Span-49"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-50"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mi" id="MathJax-Span-51" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.984em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mi>o</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-10">\theta_o</script>. We won't be stratifying the output reflection angle in this book, simply
because it is a little bit too complicated to cover, but there is a lot of interesting research
currently happening in this space.

</p><p>

As an intermediary, we'll be stratifying the locations of the sampling positions around each pixel
location.

</p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"rtweekend.h"</span></span>
<span class="line"></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"camera.h"</span></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"hittable_list.h"</span></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"material.h"</span></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"quad.h"</span></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"sphere.h"</span></span>
<span class="line"></span>
<span class="line"></span><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
<span class="line"></span>    hittable_list world;
<span class="line"></span>
<span class="line"></span>    <span class="hljs-keyword">auto</span> red   = <span class="hljs-built_in">make_shared</span>&lt;lambertian&gt;(<span class="hljs-built_in">color</span>(<span class="hljs-number">.65</span>, <span class="hljs-number">.05</span>, <span class="hljs-number">.05</span>));
<span class="line"></span>    <span class="hljs-keyword">auto</span> white = <span class="hljs-built_in">make_shared</span>&lt;lambertian&gt;(<span class="hljs-built_in">color</span>(<span class="hljs-number">.73</span>, <span class="hljs-number">.73</span>, <span class="hljs-number">.73</span>));
<span class="line"></span>    <span class="hljs-keyword">auto</span> green = <span class="hljs-built_in">make_shared</span>&lt;lambertian&gt;(<span class="hljs-built_in">color</span>(<span class="hljs-number">.12</span>, <span class="hljs-number">.45</span>, <span class="hljs-number">.15</span>));
<span class="line"></span>    <span class="hljs-keyword">auto</span> light = <span class="hljs-built_in">make_shared</span>&lt;diffuse_light&gt;(<span class="hljs-built_in">color</span>(<span class="hljs-number">15</span>, <span class="hljs-number">15</span>, <span class="hljs-number">15</span>));
<span class="line"></span>
<span class="line"></span>    <span class="hljs-comment">// Cornell box sides</span>
<span class="line"></span>    world.<span class="hljs-built_in">add</span>(<span class="hljs-built_in">make_shared</span>&lt;quad&gt;(<span class="hljs-built_in">point3</span>(<span class="hljs-number">555</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>), <span class="hljs-built_in">vec3</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">555</span>), <span class="hljs-built_in">vec3</span>(<span class="hljs-number">0</span>,<span class="hljs-number">555</span>,<span class="hljs-number">0</span>), green));
<span class="line"></span>    world.<span class="hljs-built_in">add</span>(<span class="hljs-built_in">make_shared</span>&lt;quad&gt;(<span class="hljs-built_in">point3</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">555</span>), <span class="hljs-built_in">vec3</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">-555</span>), <span class="hljs-built_in">vec3</span>(<span class="hljs-number">0</span>,<span class="hljs-number">555</span>,<span class="hljs-number">0</span>), red));
<span class="line"></span>    world.<span class="hljs-built_in">add</span>(<span class="hljs-built_in">make_shared</span>&lt;quad&gt;(<span class="hljs-built_in">point3</span>(<span class="hljs-number">0</span>,<span class="hljs-number">555</span>,<span class="hljs-number">0</span>), <span class="hljs-built_in">vec3</span>(<span class="hljs-number">555</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>), <span class="hljs-built_in">vec3</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">555</span>), white));
<span class="line"></span>    world.<span class="hljs-built_in">add</span>(<span class="hljs-built_in">make_shared</span>&lt;quad&gt;(<span class="hljs-built_in">point3</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">555</span>), <span class="hljs-built_in">vec3</span>(<span class="hljs-number">555</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>), <span class="hljs-built_in">vec3</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">-555</span>), white));
<span class="line"></span>    world.<span class="hljs-built_in">add</span>(<span class="hljs-built_in">make_shared</span>&lt;quad&gt;(<span class="hljs-built_in">point3</span>(<span class="hljs-number">555</span>,<span class="hljs-number">0</span>,<span class="hljs-number">555</span>), <span class="hljs-built_in">vec3</span>(<span class="hljs-number">-555</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>), <span class="hljs-built_in">vec3</span>(<span class="hljs-number">0</span>,<span class="hljs-number">555</span>,<span class="hljs-number">0</span>), white));
<span class="line"></span>
<span class="line"></span>    <span class="hljs-comment">// Light</span>
<span class="line"></span>    world.<span class="hljs-built_in">add</span>(<span class="hljs-built_in">make_shared</span>&lt;quad&gt;(<span class="hljs-built_in">point3</span>(<span class="hljs-number">213</span>,<span class="hljs-number">554</span>,<span class="hljs-number">227</span>), <span class="hljs-built_in">vec3</span>(<span class="hljs-number">130</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>), <span class="hljs-built_in">vec3</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">105</span>), light));
<span class="line"></span>
<span class="line"></span>    <span class="hljs-comment">// Box 1</span>
<span class="line"></span>    shared_ptr&lt;hittable&gt; box1 = <span class="hljs-built_in">box</span>(<span class="hljs-built_in">point3</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>), <span class="hljs-built_in">point3</span>(<span class="hljs-number">165</span>,<span class="hljs-number">330</span>,<span class="hljs-number">165</span>), white);
<span class="line"></span>    box1 = <span class="hljs-built_in">make_shared</span>&lt;rotate_y&gt;(box1, <span class="hljs-number">15</span>);
<span class="line"></span>    box1 = <span class="hljs-built_in">make_shared</span>&lt;translate&gt;(box1, <span class="hljs-built_in">vec3</span>(<span class="hljs-number">265</span>,<span class="hljs-number">0</span>,<span class="hljs-number">295</span>));
<span class="line"></span>    world.<span class="hljs-built_in">add</span>(box1);
<span class="line"></span>
<span class="line"></span>    <span class="hljs-comment">// Box 2</span>
<span class="line"></span>    shared_ptr&lt;hittable&gt; box2 = <span class="hljs-built_in">box</span>(<span class="hljs-built_in">point3</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>), <span class="hljs-built_in">point3</span>(<span class="hljs-number">165</span>,<span class="hljs-number">165</span>,<span class="hljs-number">165</span>), white);
<span class="line"></span>    box2 = <span class="hljs-built_in">make_shared</span>&lt;rotate_y&gt;(box2, <span class="hljs-number">-18</span>);
<span class="line"></span>    box2 = <span class="hljs-built_in">make_shared</span>&lt;translate&gt;(box2, <span class="hljs-built_in">vec3</span>(<span class="hljs-number">130</span>,<span class="hljs-number">0</span>,<span class="hljs-number">65</span>));
<span class="line"></span>    world.<span class="hljs-built_in">add</span>(box2);
<span class="line"></span>
<span class="line"></span>    camera cam;
<span class="line"></span>
<span class="line"></span>    cam.aspect_ratio      = <span class="hljs-number">1.0</span>;
<span class="line"></span>    cam.image_width       = <span class="hljs-number">600</span>;
<span class="line"></span>    cam.samples_per_pixel = <span class="hljs-number">64</span>;
<span class="line"></span>    cam.max_depth         = <span class="hljs-number">50</span>;
<span class="line"></span>    cam.background        = <span class="hljs-built_in">color</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>);
<span class="line"></span>
<span class="line"></span>    cam.vfov     = <span class="hljs-number">40</span>;
<span class="line"></span>    cam.lookfrom = <span class="hljs-built_in">point3</span>(<span class="hljs-number">278</span>, <span class="hljs-number">278</span>, <span class="hljs-number">-800</span>);
<span class="line"></span>    cam.lookat   = <span class="hljs-built_in">point3</span>(<span class="hljs-number">278</span>, <span class="hljs-number">278</span>, <span class="hljs-number">0</span>);
<span class="line"></span>    cam.vup      = <span class="hljs-built_in">vec3</span>(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>);
<span class="line"></span>
<span class="line"></span>    cam.defocus_angle = <span class="hljs-number">0</span>;
<span class="line"></span>
<span class="line"></span>    cam.<span class="hljs-built_in">render</span>(world);
<span class="line"></span>}</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_estpi-3">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;5:</b> <kbd>[main.cc]</kbd> Stratifying the samples inside pixels</div></center>
<pre class="listing tilde"><code><span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">camera</span> {
<span class="line"></span>  <span class="hljs-keyword">public</span>:
<span class="line"></span>    ...
<span class="line"></span>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">render</span><span class="hljs-params">(<span class="hljs-type">const</span> hittable&amp; world)</span> </span>{
<span class="line"></span>        <span class="hljs-built_in">initialize</span>();
<span class="line"></span>
<span class="line"></span>        std::cout &lt;&lt; <span class="hljs-string">"P3\n"</span> &lt;&lt; image_width &lt;&lt; <span class="hljs-string">' '</span> &lt;&lt; image_height &lt;&lt; <span class="hljs-string">"\n255\n"</span>;
<span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; image_height; j++) {
<span class="line"></span>            std::clog &lt;&lt; <span class="hljs-string">"\rScanlines remaining: "</span> &lt;&lt; (image_height - j) &lt;&lt; <span class="hljs-string">' '</span> &lt;&lt; std::flush;
<span class="line"></span>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; image_width; i++) {
<span class="line"></span>                <span class="hljs-function">color <span class="hljs-title">pixel_color</span><span class="hljs-params">(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>)</span></span>;<div class=" highlight"><span class="line"></span>                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> s_j = <span class="hljs-number">0</span>; s_j &lt; sqrt_spp; s_j++) {
<span class="line"></span>                    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> s_i = <span class="hljs-number">0</span>; s_i &lt; sqrt_spp; s_i++) {
<span class="line"></span>                        ray r = <span class="hljs-built_in">get_ray</span>(i, j, s_i, s_j);
<span class="line"></span>                        pixel_color += <span class="hljs-built_in">ray_color</span>(r, max_depth, world);
<span class="line"></span>                    }
<span class="line"></span>                }</div><span class="line"></span>                <span class="hljs-built_in">write_color</span>(std::cout, pixel_samples_scale * pixel_color);
<span class="line"></span>            }
<span class="line"></span>        }
<span class="line"></span>
<span class="line"></span>        std::clog &lt;&lt; <span class="hljs-string">"\rDone.                 \n"</span>;
<span class="line"></span>    }
<span class="line"></span>    ...
<span class="line"></span>  <span class="hljs-keyword">private</span>:
<span class="line"></span>    <span class="hljs-type">int</span>    image_height;         <span class="hljs-comment">// Rendered image height</span>
<span class="line"></span>    <span class="hljs-type">double</span> pixel_samples_scale;  <span class="hljs-comment">// Color scale factor for a sum of pixel samples</span><div class=" highlight"><span class="line"></span>    <span class="hljs-type">int</span>    sqrt_spp;             <span class="hljs-comment">// Square root of number of samples per pixel</span>
<span class="line"></span>    <span class="hljs-type">double</span> recip_sqrt_spp;       <span class="hljs-comment">// 1 / sqrt_spp</span></div><span class="line"></span>    point3 center;               <span class="hljs-comment">// Camera center</span>
<span class="line"></span>    ...
<span class="line"></span>
<span class="line"></span>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">initialize</span><span class="hljs-params">()</span> </span>{
<span class="line"></span>        image_height = <span class="hljs-built_in">int</span>(image_width / aspect_ratio);
<span class="line"></span>        image_height = (image_height &lt; <span class="hljs-number">1</span>) ? <span class="hljs-number">1</span> : image_height;
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>        sqrt_spp = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">sqrt</span>(samples_per_pixel));
<span class="line"></span>        pixel_samples_scale = <span class="hljs-number">1.0</span> / (sqrt_spp * sqrt_spp);
<span class="line"></span>        recip_sqrt_spp = <span class="hljs-number">1.0</span> / sqrt_spp;</div><span class="line"></span>
<span class="line"></span>        center = lookfrom;
<span class="line"></span>        ...
<span class="line"></span>    }
<span class="line"></span>    ...
<span class="line"></span>    <span class="hljs-function">ray <span class="hljs-title">get_ray</span><span class="hljs-params">(<span class="hljs-type">int</span> i, <span class="hljs-type">int</span> j, <span class="hljs-type">int</span> s_i, <span class="hljs-type">int</span> s_j)</span> <span class="hljs-type">const</span> </span>{<div class=" highlight"><span class="line"></span>        <span class="hljs-comment">// Construct a camera ray originating from the defocus disk and directed at a randomly</span>
<span class="line"></span>        <span class="hljs-comment">// sampled point around the pixel location i, j for stratified sample square s_i, s_j.</span>
<span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">auto</span> offset = <span class="hljs-built_in">sample_square_stratified</span>(s_i, s_j);</div><span class="line"></span>        <span class="hljs-keyword">auto</span> pixel_sample = pixel00_loc
<span class="line"></span>                          + ((i + offset.<span class="hljs-built_in">x</span>()) * pixel_delta_u)
<span class="line"></span>                          + ((j + offset.<span class="hljs-built_in">y</span>()) * pixel_delta_v);
<span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">auto</span> ray_origin = (defocus_angle &lt;= <span class="hljs-number">0</span>) ? center : <span class="hljs-built_in">defocus_disk_sample</span>();
<span class="line"></span>        <span class="hljs-keyword">auto</span> ray_direction = pixel_sample - ray_origin;
<span class="line"></span>        <span class="hljs-keyword">auto</span> ray_time = <span class="hljs-built_in">random_double</span>();
<span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">ray</span>(ray_origin, ray_direction, ray_time);
<span class="line"></span>    }
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>    <span class="hljs-function">vec3 <span class="hljs-title">sample_square_stratified</span><span class="hljs-params">(<span class="hljs-type">int</span> s_i, <span class="hljs-type">int</span> s_j)</span> <span class="hljs-type">const</span> </span>{
<span class="line"></span>        <span class="hljs-comment">// Returns the vector to a random point in the square sub-pixel specified by grid</span>
<span class="line"></span>        <span class="hljs-comment">// indices s_i and s_j, for an idealized unit square pixel [-.5,-.5] to [+.5,+.5].</span>
<span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">auto</span> px = ((s_i + <span class="hljs-built_in">random_double</span>()) * recip_sqrt_spp) - <span class="hljs-number">0.5</span>;
<span class="line"></span>        <span class="hljs-keyword">auto</span> py = ((s_j + <span class="hljs-built_in">random_double</span>()) * recip_sqrt_spp) - <span class="hljs-number">0.5</span>;
<span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">vec3</span>(px, py, <span class="hljs-number">0</span>);
<span class="line"></span>    }</div><span class="line"></span>
<span class="line"></span>    <span class="hljs-function">vec3 <span class="hljs-title">sample_square</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>{
<span class="line"></span>        ...
<span class="line"></span>    }
<span class="line"></span>
<span class="line"></span>    ...
<span class="line"></span>};</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_render-estpi-3">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;6:</b> <kbd>[camera.h]</kbd> Stratifying the samples inside pixels (render)</div></center>
<p>


</p><div class="together">
If we compare the results from without stratification:

<p></p><p>

  </p><center><div class="image" style=""><a href="./input_files/img-3.01-cornell-no-strat.png" target="_blank"><img class="markdeep pixel" src="./input_files/img-3.01-cornell-no-strat.png"></a><center><span class="imagecaption"><span class="num">Image 1:</span> Cornell box, no stratification
  </span></center></div></center>

<p></p><p>

</p></div>

<p></p><p>

</p><div class="together">
To after, with stratification:

<p></p><p>

  </p><center><div class="image" style=""><a href="./input_files/img-3.02-cornell-strat.png" target="_blank"><img class="markdeep pixel" src="./input_files/img-3.02-cornell-strat.png"></a><center><span class="imagecaption"><span class="num">Image 2:</span> Cornell box, with stratification
  </span></center></div></center>

<p></p><p>

You should, if you squint, be able to see sharper contrast at the edges of planes and at the edges
of boxes. The effect will be more pronounced at locations that have a higher frequency of change.
High frequency change can also be thought of as high information density. For our cornell box scene,
all of our materials are matte, with a soft area light overhead, so the only locations of high
information density are at the edges of objects. The effect will be more obvious with textures and
reflective materials.

</p><p>

If you are ever doing single-reflection or shadowing or some strictly 2D problem, you definitely
want to stratify.

</p><p>

</p></div>

<p></p>
<a class="target" name="onedimensionalmontecarlointegration">&nbsp;</a><a class="target" name="onedimensionalmontecarlointegration">&nbsp;</a><a class="target" name="toc3">&nbsp;</a><h1>One Dimensional Monte Carlo Integration</h1>
<p>

Our Buffon Needle example is a way of calculating <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-52" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-53"><span class="mi" id="MathJax-Span-54"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-11">\pi</script> by solving for the ratio of the area of the
circle and the area of the circumscribed square:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;area&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;c&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;c&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;l&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;area&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;s&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;q&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;u&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-55" style="width: 7.544em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.201em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1006.2em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-56"><span class="mfrac" id="MathJax-Span-57"><span style="display: inline-block; position: relative; width: 4.186em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1003.77em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -1.857em;"><span class="mrow" id="MathJax-Span-58"><span class="mi" id="MathJax-Span-59"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mo" id="MathJax-Span-60"></span><span class="mo" id="MathJax-Span-61"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="texatom" id="MathJax-Span-62"><span class="mrow" id="MathJax-Span-63"><span class="mi" id="MathJax-Span-64"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span></span><span class="mi" id="MathJax-Span-65"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span class="mi" id="MathJax-Span-66"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mi" id="MathJax-Span-67"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span></span><span class="mi" id="MathJax-Span-68"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span></span><span class="mi" id="MathJax-Span-69"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span></span></span><span class="mo" id="MathJax-Span-70"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1004.08em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -2.012em;"><span class="mrow" id="MathJax-Span-71"><span class="mi" id="MathJax-Span-72"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mo" id="MathJax-Span-73"></span><span class="mo" id="MathJax-Span-74"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="texatom" id="MathJax-Span-75"><span class="mrow" id="MathJax-Span-76"><span class="mi" id="MathJax-Span-77"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mi" id="MathJax-Span-78"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">q</span></span><span class="mi" id="MathJax-Span-79"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">u</span></span><span class="mi" id="MathJax-Span-80"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mi" id="MathJax-Span-81"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mi" id="MathJax-Span-82"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span></span></span><span class="mo" id="MathJax-Span-83"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1004.19em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.186em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mo" id="MathJax-Span-84" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-85" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mi" id="MathJax-Span-86"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-87"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">4</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.52em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.519em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mrow><mi>area</mi><mo>⁡</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">c</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">c</mi><mi class="MJX-tex-mathit" mathvariant="italic">l</mi><mi class="MJX-tex-mathit" mathvariant="italic">e</mi></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>area</mi><mo>⁡</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">s</mi><mi class="MJX-tex-mathit" mathvariant="italic">q</mi><mi class="MJX-tex-mathit" mathvariant="italic">u</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">e</mi></mrow><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><mfrac><mi>π</mi><mn>4</mn></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-12"> \frac{\operatorname{area}(\mathit{circle})}{\operatorname{area}(\mathit{square})}
       = \frac{\pi}{4}
    </script>

</p><p>

We picked a bunch of random points in the circumscribed square and counted the fraction of them that
were also in the unit circle. This fraction was an estimate that tended toward <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-88" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(-0.307em, 1000.62em, 1.759em, -999.997em); top: -0.979em; left: 0em;"><span class="mrow" id="MathJax-Span-89"><span class="mfrac" id="MathJax-Span-90"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.139em, 1000.31em, 2.172em, -999.997em); top: -2.425em; left: 50%; margin-left: -0.152em;"><span class="mi" id="MathJax-Span-91" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.31em, 2.172em, -999.997em); top: -1.392em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-92" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">4</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.42em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.416em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.984em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.809em; border-left: 0px solid; width: 0px; height: 2.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mi>π</mi><mn>4</mn></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-13">\frac{\pi}{4}</script> as
more points were added. If we didn't know the area of a circle, we could still solve for it using
the above ratio. We know that the ratio of areas of the unit circle and the circumscribed square is
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-93" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(-0.307em, 1000.62em, 1.759em, -999.997em); top: -0.979em; left: 0em;"><span class="mrow" id="MathJax-Span-94"><span class="mfrac" id="MathJax-Span-95"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.139em, 1000.31em, 2.172em, -999.997em); top: -2.425em; left: 50%; margin-left: -0.152em;"><span class="mi" id="MathJax-Span-96" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.31em, 2.172em, -999.997em); top: -1.392em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-97" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">4</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.42em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.416em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.984em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.809em; border-left: 0px solid; width: 0px; height: 2.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mi>π</mi><mn>4</mn></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-14">\frac{\pi}{4}</script>, and we know that the area of a circumscribed square is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-98" style="width: 1.294em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.139em, 1001.04em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-99"><span class="mn" id="MathJax-Span-100"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">4</span></span><span class="msubsup" id="MathJax-Span-101"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-102"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.218em; left: 0.261em;"><span class="mn" id="MathJax-Span-103" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>4</mn><msup><mi>r</mi><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-15">4r^2</script>, so we could then use
those two quantities to get the area of a circle:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;area&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;c&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;c&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;l&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;area&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;s&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;q&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;u&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-104" style="width: 7.544em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.201em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1006.2em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-105"><span class="mfrac" id="MathJax-Span-106"><span style="display: inline-block; position: relative; width: 4.186em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1003.77em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -1.857em;"><span class="mrow" id="MathJax-Span-107"><span class="mi" id="MathJax-Span-108"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mo" id="MathJax-Span-109"></span><span class="mo" id="MathJax-Span-110"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="texatom" id="MathJax-Span-111"><span class="mrow" id="MathJax-Span-112"><span class="mi" id="MathJax-Span-113"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span></span><span class="mi" id="MathJax-Span-114"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span class="mi" id="MathJax-Span-115"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mi" id="MathJax-Span-116"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span></span><span class="mi" id="MathJax-Span-117"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span></span><span class="mi" id="MathJax-Span-118"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span></span></span><span class="mo" id="MathJax-Span-119"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1004.08em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -2.012em;"><span class="mrow" id="MathJax-Span-120"><span class="mi" id="MathJax-Span-121"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mo" id="MathJax-Span-122"></span><span class="mo" id="MathJax-Span-123"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="texatom" id="MathJax-Span-124"><span class="mrow" id="MathJax-Span-125"><span class="mi" id="MathJax-Span-126"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mi" id="MathJax-Span-127"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">q</span></span><span class="mi" id="MathJax-Span-128"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">u</span></span><span class="mi" id="MathJax-Span-129"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mi" id="MathJax-Span-130"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mi" id="MathJax-Span-131"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span></span></span><span class="mo" id="MathJax-Span-132"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1004.19em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.186em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mo" id="MathJax-Span-133" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-134" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mi" id="MathJax-Span-135"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-136"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">4</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.52em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.519em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mrow><mi>area</mi><mo>⁡</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">c</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">c</mi><mi class="MJX-tex-mathit" mathvariant="italic">l</mi><mi class="MJX-tex-mathit" mathvariant="italic">e</mi></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>area</mi><mo>⁡</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">s</mi><mi class="MJX-tex-mathit" mathvariant="italic">q</mi><mi class="MJX-tex-mathit" mathvariant="italic">u</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">e</mi></mrow><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><mfrac><mi>π</mi><mn>4</mn></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-16"> \frac{\operatorname{area}(\mathit{circle})}{\operatorname{area}(\mathit{square})}
       = \frac{\pi}{4}
    </script>

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;area&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;c&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;c&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;l&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-137" style="width: 7.131em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.891em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1005.89em, 3.463em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-138"><span class="mfrac" id="MathJax-Span-139"><span style="display: inline-block; position: relative; width: 3.877em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1003.77em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -1.857em;"><span class="mrow" id="MathJax-Span-140"><span class="mi" id="MathJax-Span-141"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mo" id="MathJax-Span-142"></span><span class="mo" id="MathJax-Span-143"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="texatom" id="MathJax-Span-144"><span class="mrow" id="MathJax-Span-145"><span class="mi" id="MathJax-Span-146"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span></span><span class="mi" id="MathJax-Span-147"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span class="mi" id="MathJax-Span-148"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mi" id="MathJax-Span-149"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span></span><span class="mi" id="MathJax-Span-150"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span></span><span class="mi" id="MathJax-Span-151"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span></span></span><span class="mo" id="MathJax-Span-152"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.191em, 1001.6em, 2.585em, -999.997em); top: -1.392em; left: 50%; margin-left: -0.772em;"><span class="mrow" id="MathJax-Span-153"><span class="mo" id="MathJax-Span-154"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-155"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-156"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="msubsup" id="MathJax-Span-157"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mo" id="MathJax-Span-158"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.167em; left: 0.261em;"><span class="mn" id="MathJax-Span-159" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1003.88em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.877em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mo" id="MathJax-Span-160" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-161" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mi" id="MathJax-Span-162"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-163"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">4</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.52em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.519em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.309em; border-left: 0px solid; width: 0px; height: 3.128em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mrow><mi>area</mi><mo>⁡</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">c</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">c</mi><mi class="MJX-tex-mathit" mathvariant="italic">l</mi><mi class="MJX-tex-mathit" mathvariant="italic">e</mi></mrow><mo stretchy="false">)</mo></mrow><mrow><mo stretchy="false">(</mo><mn>2</mn><mi>r</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></mfrac><mo>=</mo><mfrac><mi>π</mi><mn>4</mn></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-17"> \frac{\operatorname{area}(\mathit{circle})}{(2r)^2} = \frac{\pi}{4} </script>

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;area&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;c&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;c&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;l&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mfrac&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-164" style="width: 8.06em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.666em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1006.67em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-165"><span class="mi" id="MathJax-Span-166"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mo" id="MathJax-Span-167"></span><span class="mo" id="MathJax-Span-168"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="texatom" id="MathJax-Span-169"><span class="mrow" id="MathJax-Span-170"><span class="mi" id="MathJax-Span-171"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span></span><span class="mi" id="MathJax-Span-172"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span class="mi" id="MathJax-Span-173"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mi" id="MathJax-Span-174"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span></span><span class="mi" id="MathJax-Span-175"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span></span><span class="mi" id="MathJax-Span-176"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span></span></span><span class="mo" id="MathJax-Span-177"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-178" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-179" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mi" id="MathJax-Span-180"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-181"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">4</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.52em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.519em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mn" id="MathJax-Span-182"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">4</span></span><span class="msubsup" id="MathJax-Span-183"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-184"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.27em; left: 0.261em;"><span class="mn" id="MathJax-Span-185" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>area</mi><mo>⁡</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">c</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">c</mi><mi class="MJX-tex-mathit" mathvariant="italic">l</mi><mi class="MJX-tex-mathit" mathvariant="italic">e</mi></mrow><mo stretchy="false">)</mo><mo>=</mo><mfrac><mi>π</mi><mn>4</mn></mfrac><mn>4</mn><msup><mi>r</mi><mn>2</mn></msup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-18"> \operatorname{area}(\mathit{circle}) = \frac{\pi}{4} 4r^2 </script>

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;area&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;c&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;c&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;l&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-186" style="width: 7.131em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.891em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.139em, 1005.89em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-187"><span class="mi" id="MathJax-Span-188"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mo" id="MathJax-Span-189"></span><span class="mo" id="MathJax-Span-190"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="texatom" id="MathJax-Span-191"><span class="mrow" id="MathJax-Span-192"><span class="mi" id="MathJax-Span-193"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span></span><span class="mi" id="MathJax-Span-194"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span class="mi" id="MathJax-Span-195"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mi" id="MathJax-Span-196"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span></span><span class="mi" id="MathJax-Span-197"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span></span><span class="mi" id="MathJax-Span-198"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span></span></span><span class="mo" id="MathJax-Span-199"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-200" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-201" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span class="msubsup" id="MathJax-Span-202"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-203"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.27em; left: 0.261em;"><span class="mn" id="MathJax-Span-204" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>area</mi><mo>⁡</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">c</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">c</mi><mi class="MJX-tex-mathit" mathvariant="italic">l</mi><mi class="MJX-tex-mathit" mathvariant="italic">e</mi></mrow><mo stretchy="false">)</mo><mo>=</mo><mi>π</mi><msup><mi>r</mi><mn>2</mn></msup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-19"> \operatorname{area}(\mathit{circle}) = \pi r^2 </script>

</p><p>

We choose a circle with radius <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-205" style="width: 2.224em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.81em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1001.81em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-206"><span class="mi" id="MathJax-Span-207"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-208" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-209" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-20">r = 1</script> and get:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;area&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;c&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;c&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;l&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-210" style="width: 6.408em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.271em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1005.27em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-211"><span class="mi" id="MathJax-Span-212"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mo" id="MathJax-Span-213"></span><span class="mo" id="MathJax-Span-214"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="texatom" id="MathJax-Span-215"><span class="mrow" id="MathJax-Span-216"><span class="mi" id="MathJax-Span-217"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span></span><span class="mi" id="MathJax-Span-218"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span class="mi" id="MathJax-Span-219"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mi" id="MathJax-Span-220"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span></span><span class="mi" id="MathJax-Span-221"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span></span><span class="mi" id="MathJax-Span-222"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span></span></span><span class="mo" id="MathJax-Span-223"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-224" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-225" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>area</mi><mo>⁡</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">c</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">c</mi><mi class="MJX-tex-mathit" mathvariant="italic">l</mi><mi class="MJX-tex-mathit" mathvariant="italic">e</mi></mrow><mo stretchy="false">)</mo><mo>=</mo><mi>π</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-21"> \operatorname{area}(\mathit{circle}) = \pi </script>

</p><p>

</p><div class="together">
Our work above is equally valid as a means to solve for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-226" style="width: 0.829em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.67em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-227"><span class="mi" id="MathJax-Span-228"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mi" id="MathJax-Span-229"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-22">pi</script> as it is a means to solve for the area
of a circle:

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"rtweekend.h"</span></span>
<span class="line"></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iomanip&gt;</span></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;math.h&gt;</span></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span>
<span class="line"></span>
<span class="line"></span><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
<span class="line"></span>    <span class="hljs-type">int</span> N = <span class="hljs-number">100000</span>;
<span class="line"></span>    <span class="hljs-type">int</span> inside_circle = <span class="hljs-number">0</span>;
<span class="line"></span>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; N; i++) {
<span class="line"></span>        <span class="hljs-keyword">auto</span> x = <span class="hljs-built_in">random_double</span>(<span class="hljs-number">-1</span>,<span class="hljs-number">1</span>);
<span class="line"></span>        <span class="hljs-keyword">auto</span> y = <span class="hljs-built_in">random_double</span>(<span class="hljs-number">-1</span>,<span class="hljs-number">1</span>);
<span class="line"></span>        <span class="hljs-keyword">if</span> (x*x + y*y &lt; <span class="hljs-number">1</span>)
<span class="line"></span>            inside_circle++;
<span class="line"></span>    }
<span class="line"></span>    std::cout &lt;&lt; std::fixed &lt;&lt; std::<span class="hljs-built_in">setprecision</span>(<span class="hljs-number">12</span>);
<span class="line"></span>    std::cout &lt;&lt; <span class="hljs-string">"Estimated area of unit circle = "</span> &lt;&lt; (<span class="hljs-number">4.0</span> * inside_circle) / N &lt;&lt; <span class="hljs-string">'\n'</span>;
<span class="line"></span>}</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_estunitcircle">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;7:</b> <kbd>[pi.cc]</kbd> Estimating area of unit circle</div></center>
<p>


</p></div>

<p></p>
<a class="target" name="expectedvalue">&nbsp;</a><a class="target" name="onedimensionalmontecarlointegration/expectedvalue">&nbsp;</a><a class="target" name="toc3.1">&nbsp;</a><h2>Expected Value</h2>
<p>

Let's take a step back and think about our Monte Carlo algorithm a little bit more generally.

</p><p>

If we assume that we have all of the following:

</p><p>

</p><ol start="1">
<li class="number">A list of values <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-230" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.62em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-231"><span class="mi" id="MathJax-Span-232"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">X</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-23">X</script> that contains members <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-233" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.054em, 1000.62em, 1.501em, -999.997em); top: -0.979em; left: 0em;"><span class="mrow" id="MathJax-Span-234"><span class="msubsup" id="MathJax-Span-235"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-236"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mi" id="MathJax-Span-237" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.984em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-24">x_i</script>:

<p></p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-238" style="width: 9.197em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.596em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1007.6em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-239"><span class="mi" id="MathJax-Span-240"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">X</span></span><span class="mo" id="MathJax-Span-241" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mo" id="MathJax-Span-242" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-243"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-244"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mn" id="MathJax-Span-245" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-246"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-247" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-248"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mn" id="MathJax-Span-249" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-250"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mo" id="MathJax-Span-251" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span></span><span class="mo" id="MathJax-Span-252" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span></span><span class="mo" id="MathJax-Span-253" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span></span><span class="mo" id="MathJax-Span-254" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-255" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.604em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-256"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="texatom" id="MathJax-Span-257"><span class="mrow" id="MathJax-Span-258"><span class="mi" id="MathJax-Span-259" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">N</span></span><span class="mo" id="MathJax-Span-260" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mn" id="MathJax-Span-261" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-262"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>X</mi><mo>=</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>,</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-25"> X = (x_0, x_1, ..., x_{N-1})  </script>

</p><p>

</p></li>
<li class="number">A continuous function <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-263" style="width: 1.501em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.24em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-264"><span class="mi" id="MathJax-Span-265"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-266"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-267"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-268"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-26">f(x)</script> that takes members from the list:

<p></p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-269" style="width: 3.825em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.153em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1003.15em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-270"><span class="msubsup" id="MathJax-Span-271"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-272"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">y</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mi" id="MathJax-Span-273" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-274" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-275" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-276"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-277"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-278"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mi" id="MathJax-Span-279" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-280"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-27"> y_i = f(x_i) </script>

</p><p>

</p></li>
<li class="number">A function <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-281" style="width: 1.965em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.604em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.6em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-282"><span class="mi" id="MathJax-Span-283"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">F</span></span><span class="mo" id="MathJax-Span-284"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-285"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">X</span></span><span class="mo" id="MathJax-Span-286"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-28">F(X)</script> that takes the list <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-287" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.62em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-288"><span class="mi" id="MathJax-Span-289"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">X</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-29">X</script> as input and produces the list <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-290" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.62em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-291"><span class="mi" id="MathJax-Span-292"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">Y</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Y</mi></math></span></span><script type="math/tex" id="MathJax-Element-30">Y</script> as output:

<p></p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-293" style="width: 4.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.308em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1003.31em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-294"><span class="mi" id="MathJax-Span-295"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">Y</span></span><span class="mo" id="MathJax-Span-296" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-297" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">F</span></span><span class="mo" id="MathJax-Span-298"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-299"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">X</span></span><span class="mo" id="MathJax-Span-300"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>Y</mi><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-31"> Y = F(X) </script>

</p><p>

</p></li>
<li class="number">Where output list <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-301" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.62em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-302"><span class="mi" id="MathJax-Span-303"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">Y</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Y</mi></math></span></span><script type="math/tex" id="MathJax-Element-32">Y</script> has members <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-304" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.054em, 1000.62em, 1.501em, -999.997em); top: -0.979em; left: 0em;"><span class="mrow" id="MathJax-Span-305"><span class="msubsup" id="MathJax-Span-306"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-307"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">y</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mi" id="MathJax-Span-308" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.984em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>y</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-33">y_i</script>:

<p></p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-309" style="width: 20.715em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.1em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1017.1em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-310"><span class="mi" id="MathJax-Span-311"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">Y</span></span><span class="mo" id="MathJax-Span-312" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mo" id="MathJax-Span-313" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-314"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-315"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">y</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mn" id="MathJax-Span-316" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-317"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-318" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-319"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">y</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mn" id="MathJax-Span-320" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-321"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mo" id="MathJax-Span-322" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span></span><span class="mo" id="MathJax-Span-323" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span></span><span class="mo" id="MathJax-Span-324" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span></span><span class="mo" id="MathJax-Span-325" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-326" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.604em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-327"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">y</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="texatom" id="MathJax-Span-328"><span class="mrow" id="MathJax-Span-329"><span class="mi" id="MathJax-Span-330" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">N</span></span><span class="mo" id="MathJax-Span-331" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mn" id="MathJax-Span-332" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-333"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-334" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mo" id="MathJax-Span-335" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-336"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-337"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-338"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-339"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mn" id="MathJax-Span-340" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-341"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-342"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-343" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-344"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-345"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-346"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mn" id="MathJax-Span-347" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-348"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-349"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mo" id="MathJax-Span-350" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span></span><span class="mo" id="MathJax-Span-351" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span></span><span class="mo" id="MathJax-Span-352" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span></span><span class="mo" id="MathJax-Span-353" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-354" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-355"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-356"><span style="display: inline-block; position: relative; width: 1.604em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-357"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="texatom" id="MathJax-Span-358"><span class="mrow" id="MathJax-Span-359"><span class="mi" id="MathJax-Span-360" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">N</span></span><span class="mo" id="MathJax-Span-361" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mn" id="MathJax-Span-362" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-363"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-364"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>Y</mi><mo>=</mo><mo stretchy="false">(</mo><msub><mi>y</mi><mn>0</mn></msub><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo>,</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-34"> Y = (y_0, y_1, ..., y_{N-1}) = (f(x_0), f(x_1), ..., f(x_{N-1})) </script></p></li></ol>

<p></p><p>

If we assume all of the above, then we could solve for the arithmetic mean—the average—of the list
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-365" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.62em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-366"><span class="mi" id="MathJax-Span-367"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">Y</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Y</mi></math></span></span><script type="math/tex" id="MathJax-Element-35">Y</script> with the following:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;average&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mfrac&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-368" style="width: 12.813em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.591em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.467em, 1010.59em, 3.67em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-369"><span class="mi" id="MathJax-Span-370"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">v</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">g</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span><span class="mo" id="MathJax-Span-371"></span><span class="mo" id="MathJax-Span-372"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-373"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">Y</span></span><span class="mo" id="MathJax-Span-374"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-375" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-376" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">E</span></span><span class="mo" id="MathJax-Span-377"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">[</span></span><span class="mi" id="MathJax-Span-378"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">Y</span></span><span class="mo" id="MathJax-Span-379"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">]</span></span><span class="mo" id="MathJax-Span-380" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-381" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-382"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.62em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.307em;"><span class="mi" id="MathJax-Span-383"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">N</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.73em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.726em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="munderover" id="MathJax-Span-384" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.139em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.78em, 2.637em, -999.997em); top: -2.218em; left: 0.209em;"><span class="mo" id="MathJax-Span-385" style="vertical-align: -0.049em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∑</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.88em, 2.275em, -999.997em); top: -0.876em; left: 0.158em;"><span class="texatom" id="MathJax-Span-386"><span class="mrow" id="MathJax-Span-387"><span class="mi" id="MathJax-Span-388" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span class="mo" id="MathJax-Span-389" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-390" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.036em, 1001.14em, 2.172em, -999.997em); top: -2.838em; left: 0em;"><span class="texatom" id="MathJax-Span-391"><span class="mrow" id="MathJax-Span-392"><span class="mi" id="MathJax-Span-393" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">N</span></span><span class="mo" id="MathJax-Span-394" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mn" id="MathJax-Span-395" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-396" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-397"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">y</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mi" id="MathJax-Span-398" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.628em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>average</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>Y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>E</mi><mo stretchy="false">[</mo><mi>Y</mi><mo stretchy="false">]</mo><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>y</mi><mi>i</mi></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-36"> \operatorname{average}(Y) = E[Y] = \frac{1}{N} \sum_{i=0}^{N-1} y_i </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mfrac&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-399" style="width: 5.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.651em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.467em, 1004.65em, 3.67em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-400"><span class="mo" id="MathJax-Span-401"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-402" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-403"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.62em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.307em;"><span class="mi" id="MathJax-Span-404"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">N</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.73em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.726em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="munderover" id="MathJax-Span-405" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.139em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.78em, 2.637em, -999.997em); top: -2.218em; left: 0.209em;"><span class="mo" id="MathJax-Span-406" style="vertical-align: -0.049em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∑</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.88em, 2.275em, -999.997em); top: -0.876em; left: 0.158em;"><span class="texatom" id="MathJax-Span-407"><span class="mrow" id="MathJax-Span-408"><span class="mi" id="MathJax-Span-409" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span class="mo" id="MathJax-Span-410" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-411" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.036em, 1001.14em, 2.172em, -999.997em); top: -2.838em; left: 0em;"><span class="texatom" id="MathJax-Span-412"><span class="mrow" id="MathJax-Span-413"><span class="mi" id="MathJax-Span-414" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">N</span></span><span class="mo" id="MathJax-Span-415" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mn" id="MathJax-Span-416" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mi" id="MathJax-Span-417" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-418"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-419"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-420"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mi" id="MathJax-Span-421" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-422"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.628em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>−</mo><mn>1</mn></mrow></munderover><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-37"> = \frac{1}{N} \sum_{i=0}^{N-1} f(x_i) </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-423" style="width: 4.29em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.515em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1003.51em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-424"><span class="mo" id="MathJax-Span-425"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-426" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">E</span></span><span class="mo" id="MathJax-Span-427"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">[</span></span><span class="mi" id="MathJax-Span-428"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">F</span></span><span class="mo" id="MathJax-Span-429"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-430"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">X</span></span><span class="mo" id="MathJax-Span-431"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-432"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>=</mo><mi>E</mi><mo stretchy="false">[</mo><mi>F</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-38"> = E[F(X)] </script>

</p><p>

Where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-433" style="width: 2.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.655em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.65em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-434"><span class="mi" id="MathJax-Span-435"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">E</span></span><span class="mo" id="MathJax-Span-436"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">[</span></span><span class="mi" id="MathJax-Span-437"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">Y</span></span><span class="mo" id="MathJax-Span-438"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>E</mi><mo stretchy="false">[</mo><mi>Y</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-39">E[Y]</script> is referred to as the <em class="underscore">expected value of</em> <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-439" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.62em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-440"><span class="mi" id="MathJax-Span-441"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">Y</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Y</mi></math></span></span><script type="math/tex" id="MathJax-Element-40">Y</script>. If the values of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-442" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.054em, 1000.62em, 1.501em, -999.997em); top: -0.979em; left: 0em;"><span class="mrow" id="MathJax-Span-443"><span class="msubsup" id="MathJax-Span-444"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-445"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mi" id="MathJax-Span-446" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.984em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-41">x_i</script> are chosen
randomly from a continuous interval <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-447" style="width: 2.069em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.707em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1001.71em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-448"><span class="mo" id="MathJax-Span-449"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">[</span></span><span class="mi" id="MathJax-Span-450"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mo" id="MathJax-Span-451"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-452" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span></span><span class="mo" id="MathJax-Span-453"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-42">[a,b]</script> such that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-454" style="width: 4.341em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.567em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1003.57em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-455"><span class="mi" id="MathJax-Span-456"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mo" id="MathJax-Span-457" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">≤</span></span><span class="msubsup" id="MathJax-Span-458" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-459"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mi" id="MathJax-Span-460" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-461" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">≤</span></span><span class="mi" id="MathJax-Span-462" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo>≤</mo><msub><mi>x</mi><mi>i</mi></msub><mo>≤</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-43"> a \leq x_i \leq b </script> for all values of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-463" style="width: 0.261em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.209em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.21em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-464"><span class="mi" id="MathJax-Span-465"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-44">i</script>,
then <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-466" style="width: 3.257em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.689em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1002.69em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-467"><span class="mi" id="MathJax-Span-468"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">E</span></span><span class="mo" id="MathJax-Span-469"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">[</span></span><span class="mi" id="MathJax-Span-470"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">F</span></span><span class="mo" id="MathJax-Span-471"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-472"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">X</span></span><span class="mo" id="MathJax-Span-473"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-474"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>E</mi><mo stretchy="false">[</mo><mi>F</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-45">E[F(X)]</script> will approximate the average of the continuous function <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_Error" id="MathJax-Element-46-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><msup><mi>x</mi><mo>′</mo></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-46">f(x')</script> over the the same
interval <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_Error" id="MathJax-Element-47-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo>≤</mo><msup><mi>x</mi><mo>′</mo></msup><mo>≤</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-47"> a \leq x' \leq b </script>.

</p><p>

    <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Error" id="MathJax-Element-48-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mstyle mathsize=&quot;0.85em&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mstyle mathsize=&quot;1em&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mstyle&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>E</mi><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><msup><mi>x</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>a</mi><mo>≤</mo><msup><mi>x</mi><mo>′</mo></msup><mo>≤</mo><mi>b</mi><mo stretchy="false">]</mo><mo>≈</mo><mi>E</mi><mo stretchy="false">[</mo><mi>F</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>X</mi><mo>=</mo><mo fence="false" stretchy="false">{</mo><mstyle mathsize="0.85em"><msub><mi>x</mi><mi>i</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>a</mi><mo>≤</mo><msub><mi>x</mi><mi>i</mi></msub><mo>≤</mo><mi>b</mi><mstyle mathsize="1em"><mo fence="false" stretchy="false">}</mo><mo stretchy="false">]</mo></mstyle></mstyle></math></span></span><script type="math/tex; mode=display" id="MathJax-Element-48"> E[f(x') | a \leq x' \leq b] \approx E[F(X) | X =
        \{\small x_i | a \leq x_i \leq b \normalsize \} ] </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mstyle mathsize=&quot;0.85em&quot;&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mstyle mathsize=&quot;1em&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mstyle&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-498" style="width: 12.658em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.436em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1010.44em, 2.74em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-499"><span class="mo" id="MathJax-Span-500"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">≈</span></span><span class="mi" id="MathJax-Span-501" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">E</span></span><span class="mo" id="MathJax-Span-502"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">[</span></span><span class="mi" id="MathJax-Span-503"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">Y</span></span><span class="mo" id="MathJax-Span-504" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mo" id="MathJax-Span-505" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">{</span></span><span class="mstyle" id="MathJax-Span-506"><span class="mrow" id="MathJax-Span-507"><span class="msubsup" id="MathJax-Span-508"><span style="display: inline-block; position: relative; width: 0.571em; height: 0px;"><span style="position: absolute; clip: rect(1.242em, 1000.36em, 2.379em, -999.997em); top: -2.064em; left: 0em;"><span class="mi" id="MathJax-Span-509" style="font-size: 85%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">y</span></span><span style="display: inline-block; width: 0px; height: 2.069em;"></span></span><span style="position: absolute; top: -1.547em; left: 0.364em;"><span class="mi" id="MathJax-Span-510" style="font-size: 60.1%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.759em;"></span></span></span></span><span class="mo" id="MathJax-Span-511" style="font-size: 85%; padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-512" style="font-size: 85%; padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-513" style="font-size: 85%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-514"><span style="display: inline-block; position: relative; width: 0.571em; height: 0px;"><span style="position: absolute; clip: rect(1.242em, 1000.36em, 2.379em, -999.997em); top: -2.064em; left: 0em;"><span class="mi" id="MathJax-Span-515" style="font-size: 85%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.069em;"></span></span><span style="position: absolute; top: -1.547em; left: 0.364em;"><span class="mi" id="MathJax-Span-516" style="font-size: 60.1%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.759em;"></span></span></span></span><span class="mo" id="MathJax-Span-517" style="font-size: 85%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="texatom" id="MathJax-Span-518"><span class="mrow" id="MathJax-Span-519"><span class="mo" id="MathJax-Span-520" style="font-size: 85%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">|</span></span></span></span><span class="mi" id="MathJax-Span-521" style="font-size: 85%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mo" id="MathJax-Span-522" style="font-size: 85%; padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">≤</span></span><span class="msubsup" id="MathJax-Span-523" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.571em; height: 0px;"><span style="position: absolute; clip: rect(1.242em, 1000.36em, 2.379em, -999.997em); top: -2.064em; left: 0em;"><span class="mi" id="MathJax-Span-524" style="font-size: 85%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.069em;"></span></span><span style="position: absolute; top: -1.547em; left: 0.364em;"><span class="mi" id="MathJax-Span-525" style="font-size: 60.1%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.759em;"></span></span></span></span><span class="mo" id="MathJax-Span-526" style="font-size: 85%; padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">≤</span></span><span class="mi" id="MathJax-Span-527" style="font-size: 85%; padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span></span><span class="mstyle" id="MathJax-Span-528"><span class="mrow" id="MathJax-Span-529"><span class="mo" id="MathJax-Span-530"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">}</span></span><span class="mo" id="MathJax-Span-531"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">]</span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>≈</mo><mi>E</mi><mo stretchy="false">[</mo><mi>Y</mi><mo>=</mo><mo fence="false" stretchy="false">{</mo><mstyle mathsize="0.85em"><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>a</mi><mo>≤</mo><msub><mi>x</mi><mi>i</mi></msub><mo>≤</mo><mi>b</mi><mstyle mathsize="1em"><mo fence="false" stretchy="false">}</mo><mo stretchy="false">]</mo></mstyle></mstyle></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-49"> \approx E[Y = \{\small y_i = f(x_i) | a \leq x_i \leq b \normalsize \} ] </script>

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mfrac&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-532" style="width: 5.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.651em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.467em, 1004.65em, 3.67em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-533"><span class="mo" id="MathJax-Span-534"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">≈</span></span><span class="mfrac" id="MathJax-Span-535" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-536"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.62em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.307em;"><span class="mi" id="MathJax-Span-537"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">N</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.73em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.726em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="munderover" id="MathJax-Span-538" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.139em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.78em, 2.637em, -999.997em); top: -2.218em; left: 0.209em;"><span class="mo" id="MathJax-Span-539" style="vertical-align: -0.049em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∑</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.88em, 2.275em, -999.997em); top: -0.876em; left: 0.158em;"><span class="texatom" id="MathJax-Span-540"><span class="mrow" id="MathJax-Span-541"><span class="mi" id="MathJax-Span-542" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span class="mo" id="MathJax-Span-543" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-544" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.036em, 1001.14em, 2.172em, -999.997em); top: -2.838em; left: 0em;"><span class="texatom" id="MathJax-Span-545"><span class="mrow" id="MathJax-Span-546"><span class="mi" id="MathJax-Span-547" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">N</span></span><span class="mo" id="MathJax-Span-548" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mn" id="MathJax-Span-549" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mi" id="MathJax-Span-550" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-551"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-552"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-553"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mi" id="MathJax-Span-554" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-555"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.628em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>≈</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>−</mo><mn>1</mn></mrow></munderover><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-50"> \approx \frac{1}{N} \sum_{i=0}^{N-1} f(x_i) </script>

</p><p>

If we take the number of samples <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-556" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.62em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-557"><span class="mi" id="MathJax-Span-558"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">N</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-51">N</script> and take the limit as <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-559" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.62em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-560"><span class="mi" id="MathJax-Span-561"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">N</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-52">N</script> goes to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x221E;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-562" style="width: 0.932em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.78em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-563"><span class="mi" id="MathJax-Span-564"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∞</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">∞</mi></math></span></span><script type="math/tex" id="MathJax-Element-53">\infty</script>, then we get the
following:

</p><p>

    <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Error" id="MathJax-Element-54-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;lim&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x221E;&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mfrac&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>E</mi><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><msup><mi>x</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>a</mi><mo>≤</mo><msup><mi>x</mi><mo>′</mo></msup><mo>≤</mo><mi>b</mi><mo stretchy="false">]</mo><mo>=</mo><munder><mo movablelimits="true" form="prefix">lim</mo><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo stretchy="false">→</mo><mi mathvariant="normal">∞</mi></mrow></munder><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>−</mo><mn>1</mn></mrow></munderover><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex; mode=display" id="MathJax-Element-54"> E[f(x') | a \leq x' \leq b]  = \lim_{N \to \infty} \frac{1}{N} \sum_{i=0}^{N-1} f(x_i) </script>

</p><p>

Within the continuous interval <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-574" style="width: 2.069em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.707em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1001.71em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-575"><span class="mo" id="MathJax-Span-576"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">[</span></span><span class="mi" id="MathJax-Span-577"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mo" id="MathJax-Span-578"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-579" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span></span><span class="mo" id="MathJax-Span-580"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-55">[a,b]</script>, the expected value of continuous function <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_Error" id="MathJax-Element-56-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><msup><mi>x</mi><mo>′</mo></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-56">f(x')</script> can be
perfectly represented by summing an infinite number of random points within the interval. As this
number of points approaches <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x221E;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-588" style="width: 0.932em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.78em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-589"><span class="mi" id="MathJax-Span-590"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∞</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">∞</mi></math></span></span><script type="math/tex" id="MathJax-Element-57">\infty</script> the average of the outputs tends to the exact answer. This is a
Monte Carlo algorithm.

</p><p>

Sampling random points isn't our only way to solve for the expected value over an interval. We can
also choose where we place our sampling points. If we had <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-591" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.62em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-592"><span class="mi" id="MathJax-Span-593"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">N</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-58">N</script> samples over an interval <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-594" style="width: 2.069em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.707em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1001.71em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-595"><span class="mo" id="MathJax-Span-596"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">[</span></span><span class="mi" id="MathJax-Span-597"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mo" id="MathJax-Span-598"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-599" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span></span><span class="mo" id="MathJax-Span-600"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-59">[a,b]</script> then
we could choose to equally space points throughout:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-601" style="width: 5.22em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.29em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1004.29em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-602"><span class="msubsup" id="MathJax-Span-603"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-604"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mi" id="MathJax-Span-605" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-606" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-607" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mo" id="MathJax-Span-608" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">+</span></span><span class="mi" id="MathJax-Span-609" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span class="mi" id="MathJax-Span-610"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">Δ</span></span><span class="mi" id="MathJax-Span-611"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mi>a</mi><mo>+</mo><mi>i</mi><mi mathvariant="normal">Δ</mi><mi>x</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-60"> x_i = a + i \Delta x </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-612" style="width: 5.065em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.186em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1004.19em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-613"><span class="mi" id="MathJax-Span-614"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">Δ</span></span><span class="mi" id="MathJax-Span-615"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-616" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-617" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.862em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.346em, 1001.76em, 2.637em, -999.997em); top: -2.942em; left: 50%; margin-left: -0.876em;"><span class="mrow" id="MathJax-Span-618"><span class="mi" id="MathJax-Span-619"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span></span><span class="mo" id="MathJax-Span-620" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mi" id="MathJax-Span-621" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.62em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.307em;"><span class="mi" id="MathJax-Span-622"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">N</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1001.86em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.862em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi mathvariant="normal">Δ</mi><mi>x</mi><mo>=</mo><mfrac><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow><mi>N</mi></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-61"> \Delta x = \frac{b - a}{N} </script>

</p><p>

Then solving for their expected value:

</p><p>

    <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Error" id="MathJax-Element-62-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mfrac&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mstyle scriptlevel=&quot;0&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>E</mi><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><msup><mi>x</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>a</mi><mo>≤</mo><msup><mi>x</mi><mo>′</mo></msup><mo>≤</mo><mi>b</mi><mo stretchy="false">]</mo><mo>≈</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>−</mo><mn>1</mn></mrow></munderover><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><msub><mstyle scriptlevel="0"><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">|</mo></mrow></mstyle><mrow class="MJX-TeXAtom-ORD"><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mi>a</mi><mo>+</mo><mi>i</mi><mi mathvariant="normal">Δ</mi><mi>x</mi></mrow></msub></math></span></span><script type="math/tex; mode=display" id="MathJax-Element-62"> E[f(x') | a \leq x' \leq b] \approx \frac{1}{N} \sum_{i=0}^{N-1} f(x_i)
        \Big|_{x_i = a + i \Delta x} </script>
    <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Error" id="MathJax-Element-63-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mstyle scriptlevel=&quot;0&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>E</mi><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><msup><mi>x</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>a</mi><mo>≤</mo><msup><mi>x</mi><mo>′</mo></msup><mo>≤</mo><mi>b</mi><mo stretchy="false">]</mo><mo>≈</mo><mfrac><mrow><mi mathvariant="normal">Δ</mi><mi>x</mi></mrow><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow></mfrac><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>−</mo><mn>1</mn></mrow></munderover><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><msub><mstyle scriptlevel="0"><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">|</mo></mrow></mstyle><mrow class="MJX-TeXAtom-ORD"><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mi>a</mi><mo>+</mo><mi>i</mi><mi mathvariant="normal">Δ</mi><mi>x</mi></mrow></msub></math></span></span><script type="math/tex; mode=display" id="MathJax-Element-63"> E[f(x') | a \leq x' \leq b] \approx \frac{\Delta x}{b - a} \sum_{i=0}^{N-1} f(x_i)
        \Big|_{x_i = a + i \Delta x} </script>
    <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Error" id="MathJax-Element-64-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;msub&gt;&lt;mstyle scriptlevel=&quot;0&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>E</mi><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><msup><mi>x</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>a</mi><mo>≤</mo><msup><mi>x</mi><mo>′</mo></msup><mo>≤</mo><mi>b</mi><mo stretchy="false">]</mo><mo>≈</mo><mfrac><mn>1</mn><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow></mfrac><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>−</mo><mn>1</mn></mrow></munderover><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mi mathvariant="normal">Δ</mi><mi>x</mi><msub><mstyle scriptlevel="0"><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">|</mo></mrow></mstyle><mrow class="MJX-TeXAtom-ORD"><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mi>a</mi><mo>+</mo><mi>i</mi><mi mathvariant="normal">Δ</mi><mi>x</mi></mrow></msub></math></span></span><script type="math/tex; mode=display" id="MathJax-Element-64"> E[f(x') | a \leq x' \leq b] \approx \frac{1}{b - a} \sum_{i=0}^{N-1} f(x_i) \Delta x
        \Big|_{x_i = a + i \Delta x} </script>

</p><p>

Take the limit as <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-650" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.62em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-651"><span class="mi" id="MathJax-Span-652"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">N</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-65">N</script> approaches <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x221E;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-653" style="width: 0.932em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.78em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-654"><span class="mi" id="MathJax-Span-655"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∞</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">∞</mi></math></span></span><script type="math/tex" id="MathJax-Element-66">\infty</script>

</p><p>

    <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Error" id="MathJax-Element-67-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;lim&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x221E;&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;msub&gt;&lt;mstyle scriptlevel=&quot;0&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>E</mi><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><msup><mi>x</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>a</mi><mo>≤</mo><msup><mi>x</mi><mo>′</mo></msup><mo>≤</mo><mi>b</mi><mo stretchy="false">]</mo><mo>=</mo><munder><mo movablelimits="true" form="prefix">lim</mo><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo stretchy="false">→</mo><mi mathvariant="normal">∞</mi></mrow></munder><mfrac><mn>1</mn><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow></mfrac><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>−</mo><mn>1</mn></mrow></munderover><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mi mathvariant="normal">Δ</mi><mi>x</mi><msub><mstyle scriptlevel="0"><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">|</mo></mrow></mstyle><mrow class="MJX-TeXAtom-ORD"><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mi>a</mi><mo>+</mo><mi>i</mi><mi mathvariant="normal">Δ</mi><mi>x</mi></mrow></msub></math></span></span><script type="math/tex; mode=display" id="MathJax-Element-67"> E[f(x') | a \leq x' \leq b] = \lim_{N \to \infty} \frac{1}{b - a} \sum_{i=0}^{N-1}
        f(x_i) \Delta x \Big|_{x_i = a + i \Delta x} </script>

</p><p>

This is, of course, just a regular integral:

</p><p>

    <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Error" id="MathJax-Element-68-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>E</mi><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><msup><mi>x</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>a</mi><mo>≤</mo><msup><mi>x</mi><mo>′</mo></msup><mo>≤</mo><mi>b</mi><mo stretchy="false">]</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow></mfrac><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>b</mi></mrow></msubsup><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>d</mi><mi>x</mi></math></span></span><script type="math/tex; mode=display" id="MathJax-Element-68"> E[f(x') | a \leq x' \leq b] = \frac{1}{b - a} \int_{a}^{b} f(x) dx </script>

</p><p>

If you recall your introductory calculus class, the integral of a function is the area under the
curve over that interval:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-69-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;area&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-674" style="width: 10.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.732em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.087em, 1008.73em, 2.998em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-675"><span class="mi" id="MathJax-Span-676"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mo" id="MathJax-Span-677"></span><span class="mo" id="MathJax-Span-678"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-679"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-680"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-681"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-682"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-683"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-684" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mo" id="MathJax-Span-685"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-686" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span></span><span class="mo" id="MathJax-Span-687"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-688" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="msubsup" id="MathJax-Span-689" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.637em, -999.997em); top: -2.218em; left: 0em;"><span class="mo" id="MathJax-Span-690" style="vertical-align: -0.049em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∫</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -2.322em; left: 0.364em;"><span class="texatom" id="MathJax-Span-691"><span class="mrow" id="MathJax-Span-692"><span class="mi" id="MathJax-Span-693" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.31em, 2.172em, -999.997em); top: -1.444em; left: 0.364em;"><span class="texatom" id="MathJax-Span-694"><span class="mrow" id="MathJax-Span-695"><span class="mi" id="MathJax-Span-696" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mi" id="MathJax-Span-697" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-698"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-699"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-700"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mi" id="MathJax-Span-701"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-702"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.747em; border-left: 0px solid; width: 0px; height: 2.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>area</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>,</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>b</mi></mrow></msubsup><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>d</mi><mi>x</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-69"> \operatorname{area}(f(x), a, b) = \int_{a}^{b} f(x) dx</script>

</p><p>

Therefore, the average over an interval is intrinsically linked with the area under the curve in
that interval.

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-70-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;area&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-703" style="width: 17.41em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.362em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1014.36em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-704"><span class="mi" id="MathJax-Span-705"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">E</span></span><span class="mo" id="MathJax-Span-706"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">[</span></span><span class="mi" id="MathJax-Span-707"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-708"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-709"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-710"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="texatom" id="MathJax-Span-711"><span class="mrow" id="MathJax-Span-712"><span class="mo" id="MathJax-Span-713"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">|</span></span></span></span><span class="mi" id="MathJax-Span-714"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mo" id="MathJax-Span-715" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">≤</span></span><span class="mi" id="MathJax-Span-716" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-717" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">≤</span></span><span class="mi" id="MathJax-Span-718" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span></span><span class="mo" id="MathJax-Span-719"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">]</span></span><span class="mo" id="MathJax-Span-720" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-721" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.862em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-722"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.346em, 1001.76em, 2.637em, -999.997em); top: -1.495em; left: 50%; margin-left: -0.876em;"><span class="mrow" id="MathJax-Span-723"><span class="mi" id="MathJax-Span-724"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span></span><span class="mo" id="MathJax-Span-725" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mi" id="MathJax-Span-726" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1001.86em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.862em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mo" id="MathJax-Span-727" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mi" id="MathJax-Span-728" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mo" id="MathJax-Span-729"></span><span class="mo" id="MathJax-Span-730"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-731"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-732"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-733"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-734"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-735"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-736" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mo" id="MathJax-Span-737"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-738" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span></span><span class="mo" id="MathJax-Span-739"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>E</mi><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>a</mi><mo>≤</mo><mi>x</mi><mo>≤</mo><mi>b</mi><mo stretchy="false">]</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow></mfrac><mo>⋅</mo><mi>area</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>,</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-70">  E[f(x) | a \leq x \leq b] = \frac{1}{b - a} \cdot \operatorname{area}(f(x), a, b) </script>

</p><p>

Both the integral of a function and a Monte Carlo sampling of that function can be used to solve for
the average over a specific interval. While integration solves for the average with the sum of
infinitely many infinitesimally small slices of the interval, a Monte Carlo algorithm will
approximate the same average by solving the sum of ever increasing random sample points within the
interval. Counting the number of points that fall inside of an object isn't the only way to measure
its average or area. Integration is also a common mathematical tool for this purpose. If a closed
form exists for a problem, integration is frequently the most natural and clean way to formulate
things.

</p><p>

I think a couple of examples will help.

</p>
<a class="target" name="integratingx%C2%B2">&nbsp;</a><a class="target" name="onedimensionalmontecarlointegration/integratingx%C2%B2">&nbsp;</a><a class="target" name="toc3.2">&nbsp;</a><h2>Integrating x²</h2>
<p>

Let’s look at a classic integral:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-71-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-740" style="width: 4.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.877em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.087em, 1003.88em, 2.998em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-741"><span class="mi" id="MathJax-Span-742"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">I</span></span><span class="mo" id="MathJax-Span-743" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="msubsup" id="MathJax-Span-744" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.637em, -999.997em); top: -2.218em; left: 0em;"><span class="mo" id="MathJax-Span-745" style="vertical-align: -0.049em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∫</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -2.322em; left: 0.364em;"><span class="texatom" id="MathJax-Span-746"><span class="mrow" id="MathJax-Span-747"><span class="mn" id="MathJax-Span-748" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -1.444em; left: 0.364em;"><span class="texatom" id="MathJax-Span-749"><span class="mrow" id="MathJax-Span-750"><span class="mn" id="MathJax-Span-751" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-752" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-753"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.27em; left: 0.416em;"><span class="mn" id="MathJax-Span-754" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mi" id="MathJax-Span-755"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-756"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.747em; border-left: 0px solid; width: 0px; height: 2.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>I</mi><mo>=</mo><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msubsup><msup><mi>x</mi><mn>2</mn></msup><mi>d</mi><mi>x</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-71"> I = \int_{0}^{2} x^2 dx </script>

</p><p>

We could solve this using integration:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-72-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mfrac&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msup&gt;&lt;msubsup&gt;&lt;mstyle scriptlevel=&quot;0&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-757" style="width: 4.135em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.412em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1003.41em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-758"><span class="mi" id="MathJax-Span-759"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">I</span></span><span class="mo" id="MathJax-Span-760" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-761" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-762"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-763"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">3</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.52em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.519em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-764"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-765"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.27em; left: 0.416em;"><span class="mn" id="MathJax-Span-766" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">3</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-767"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.16em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mstyle" id="MathJax-Span-768"><span class="mrow" id="MathJax-Span-769"><span class="texatom" id="MathJax-Span-770"><span class="mrow" id="MathJax-Span-771"><span class="mo" id="MathJax-Span-772"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">|</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -2.373em; left: 0.158em;"><span class="texatom" id="MathJax-Span-773"><span class="mrow" id="MathJax-Span-774"><span class="mn" id="MathJax-Span-775" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -1.495em; left: 0.158em;"><span class="texatom" id="MathJax-Span-776"><span class="mrow" id="MathJax-Span-777"><span class="mn" id="MathJax-Span-778" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>I</mi><mo>=</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><msup><mi>x</mi><mn>3</mn></msup><msubsup><mstyle scriptlevel="0"><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">|</mo></mrow></mstyle><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msubsup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-72"> I = \frac{1}{3} x^3 \Big|_{0}^{2} </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-73-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-779" style="width: 6.356em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.22em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1005.22em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-780"><span class="mi" id="MathJax-Span-781"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">I</span></span><span class="mo" id="MathJax-Span-782" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-783" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-784"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-785"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">3</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.52em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.519em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mo" id="MathJax-Span-786"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-787"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mn" id="MathJax-Span-788"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.373em; left: 0.416em;"><span class="mn" id="MathJax-Span-789" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">3</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-790" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="msubsup" id="MathJax-Span-791" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mn" id="MathJax-Span-792"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.373em; left: 0.416em;"><span class="mn" id="MathJax-Span-793" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">3</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-794"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>I</mi><mo>=</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mo stretchy="false">(</mo><msup><mn>2</mn><mn>3</mn></msup><mo>−</mo><msup><mn>0</mn><mn>3</mn></msup><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-73"> I = \frac{1}{3} (2^3 - 0^3) </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-74-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-795" style="width: 2.585em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.12em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1002.12em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-796"><span class="mi" id="MathJax-Span-797"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">I</span></span><span class="mo" id="MathJax-Span-798" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-799" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-800"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">8</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-801"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">3</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.52em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.519em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>I</mi><mo>=</mo><mfrac><mn>8</mn><mn>3</mn></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-74"> I = \frac{8}{3} </script>

</p><p>

Or, we could solve the integral using a Monte Carlo approach. In computer sciency notation, we might
write this as:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-75-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;area&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-802" style="width: 6.821em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.633em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.139em, 1005.63em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-803"><span class="mi" id="MathJax-Span-804"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">I</span></span><span class="mo" id="MathJax-Span-805" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-806" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mo" id="MathJax-Span-807"></span><span class="mo" id="MathJax-Span-808"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-809"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-810"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.27em; left: 0.416em;"><span class="mn" id="MathJax-Span-811" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-812"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mn" id="MathJax-Span-813" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span class="mo" id="MathJax-Span-814"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mn" id="MathJax-Span-815" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mo" id="MathJax-Span-816"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>I</mi><mo>=</mo><mi>area</mi><mo>⁡</mo><mo stretchy="false">(</mo><msup><mi>x</mi><mn>2</mn></msup><mo>,</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-75"> I = \operatorname{area}( x^2, 0, 2 ) </script>

</p><p>

We could also write it as:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-76-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;area&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-817" style="width: 17.41em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.362em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1014.36em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-818"><span class="mi" id="MathJax-Span-819"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">E</span></span><span class="mo" id="MathJax-Span-820"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">[</span></span><span class="mi" id="MathJax-Span-821"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-822"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-823"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-824"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="texatom" id="MathJax-Span-825"><span class="mrow" id="MathJax-Span-826"><span class="mo" id="MathJax-Span-827"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">|</span></span></span></span><span class="mi" id="MathJax-Span-828"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mo" id="MathJax-Span-829" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">≤</span></span><span class="mi" id="MathJax-Span-830" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-831" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">≤</span></span><span class="mi" id="MathJax-Span-832" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span></span><span class="mo" id="MathJax-Span-833"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">]</span></span><span class="mo" id="MathJax-Span-834" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-835" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.862em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-836"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.346em, 1001.76em, 2.637em, -999.997em); top: -1.495em; left: 50%; margin-left: -0.876em;"><span class="mrow" id="MathJax-Span-837"><span class="mi" id="MathJax-Span-838"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span></span><span class="mo" id="MathJax-Span-839" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mi" id="MathJax-Span-840" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1001.86em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.862em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mo" id="MathJax-Span-841" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mi" id="MathJax-Span-842" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mo" id="MathJax-Span-843"></span><span class="mo" id="MathJax-Span-844"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-845"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-846"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-847"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-848"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-849"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-850" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mo" id="MathJax-Span-851"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-852" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span></span><span class="mo" id="MathJax-Span-853"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>E</mi><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>a</mi><mo>≤</mo><mi>x</mi><mo>≤</mo><mi>b</mi><mo stretchy="false">]</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow></mfrac><mo>⋅</mo><mi>area</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>,</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-76">  E[f(x) | a \leq x \leq b] = \frac{1}{b - a} \cdot \operatorname{area}(f(x), a, b) </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;average&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;area&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-854" style="width: 16.532em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.639em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1013.64em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-855"><span class="mi" id="MathJax-Span-856"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">v</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">g</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span><span class="mo" id="MathJax-Span-857"></span><span class="mo" id="MathJax-Span-858"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-859"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-860"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.27em; left: 0.416em;"><span class="mn" id="MathJax-Span-861" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-862"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mn" id="MathJax-Span-863" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span class="mo" id="MathJax-Span-864"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mn" id="MathJax-Span-865" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mo" id="MathJax-Span-866"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-867" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-868" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-869"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.346em, 1001.81em, 2.637em, -999.997em); top: -1.495em; left: 50%; margin-left: -0.876em;"><span class="mrow" id="MathJax-Span-870"><span class="mn" id="MathJax-Span-871"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mo" id="MathJax-Span-872" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mn" id="MathJax-Span-873" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1001.91em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.914em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mo" id="MathJax-Span-874" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mi" id="MathJax-Span-875" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mo" id="MathJax-Span-876"></span><span class="mo" id="MathJax-Span-877"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-878"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-879"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.27em; left: 0.416em;"><span class="mn" id="MathJax-Span-880" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-881"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mn" id="MathJax-Span-882" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span class="mo" id="MathJax-Span-883"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mn" id="MathJax-Span-884" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mo" id="MathJax-Span-885"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>average</mi><mo>⁡</mo><mo stretchy="false">(</mo><msup><mi>x</mi><mn>2</mn></msup><mo>,</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mo>−</mo><mn>0</mn></mrow></mfrac><mo>⋅</mo><mi>area</mi><mo>⁡</mo><mo stretchy="false">(</mo><msup><mi>x</mi><mn>2</mn></msup><mo>,</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-77"> \operatorname{average}(x^2, 0, 2) = \frac{1}{2 - 0} \cdot \operatorname{area}( x^2, 0, 2 ) </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;average&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-886" style="width: 11.624em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.61em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1009.61em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-887"><span class="mi" id="MathJax-Span-888"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">v</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">g</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span><span class="mo" id="MathJax-Span-889"></span><span class="mo" id="MathJax-Span-890"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-891"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-892"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.27em; left: 0.416em;"><span class="mn" id="MathJax-Span-893" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-894"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mn" id="MathJax-Span-895" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span class="mo" id="MathJax-Span-896"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mn" id="MathJax-Span-897" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mo" id="MathJax-Span-898"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-899" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-900" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-901"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.346em, 1001.81em, 2.637em, -999.997em); top: -1.495em; left: 50%; margin-left: -0.876em;"><span class="mrow" id="MathJax-Span-902"><span class="mn" id="MathJax-Span-903"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mo" id="MathJax-Span-904" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mn" id="MathJax-Span-905" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1001.91em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.914em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mo" id="MathJax-Span-906" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mi" id="MathJax-Span-907" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">I</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>average</mi><mo>⁡</mo><mo stretchy="false">(</mo><msup><mi>x</mi><mn>2</mn></msup><mo>,</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mo>−</mo><mn>0</mn></mrow></mfrac><mo>⋅</mo><mi>I</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-78"> \operatorname{average}(x^2, 0, 2) = \frac{1}{2 - 0} \cdot I </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-79-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;average&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-908" style="width: 9.558em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.905em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.139em, 1007.9em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-909"><span class="mi" id="MathJax-Span-910"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">I</span></span><span class="mo" id="MathJax-Span-911" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-912" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mo" id="MathJax-Span-913" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mi" id="MathJax-Span-914" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">v</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">g</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span><span class="mo" id="MathJax-Span-915"></span><span class="mo" id="MathJax-Span-916"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-917"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-918"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.27em; left: 0.416em;"><span class="mn" id="MathJax-Span-919" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-920"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mn" id="MathJax-Span-921" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span class="mo" id="MathJax-Span-922"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mn" id="MathJax-Span-923" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mo" id="MathJax-Span-924"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>I</mi><mo>=</mo><mn>2</mn><mo>⋅</mo><mi>average</mi><mo>⁡</mo><mo stretchy="false">(</mo><msup><mi>x</mi><mn>2</mn></msup><mo>,</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-79"> I = 2 \cdot \operatorname{average}(x^2, 0, 2) </script>

</p><p>

</p><div class="together">
The Monte Carlo approach:

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"rtweekend.h"</span></span>
<span class="line"></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iomanip&gt;</span></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;math.h&gt;</span></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span>
<span class="line"></span>
<span class="line"></span><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
<span class="line"></span>    <span class="hljs-type">int</span> a = <span class="hljs-number">0</span>;
<span class="line"></span>    <span class="hljs-type">int</span> b = <span class="hljs-number">2</span>;
<span class="line"></span>    <span class="hljs-type">int</span> N = <span class="hljs-number">1000000</span>;
<span class="line"></span>    <span class="hljs-keyword">auto</span> sum = <span class="hljs-number">0.0</span>;
<span class="line"></span>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; N; i++) {
<span class="line"></span>        <span class="hljs-keyword">auto</span> x = <span class="hljs-built_in">random_double</span>(a, b);
<span class="line"></span>        sum += x*x;
<span class="line"></span>    }
<span class="line"></span>    std::cout &lt;&lt; std::fixed &lt;&lt; std::<span class="hljs-built_in">setprecision</span>(<span class="hljs-number">12</span>);
<span class="line"></span>    std::cout &lt;&lt; <span class="hljs-string">"I = "</span> &lt;&lt; (b - a) * (sum / N) &lt;&lt; <span class="hljs-string">'\n'</span>;
<span class="line"></span>}</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_integ-xsq-1">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;8:</b> <kbd>[integrate_x_sq.cc]</kbd> Integrating x<sup>2</sup></div></center>
<p>


</p></div>

<p></p><p>

</p><div class="together">
This, as expected, produces approximately the exact answer we get with integration, <em class="underscore">i.e.</em> <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-80-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-925" style="width: 2.947em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.43em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1002.43em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-926"><span class="mi" id="MathJax-Span-927"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">I</span></span><span class="mo" id="MathJax-Span-928" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-929" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">8</span></span><span class="texatom" id="MathJax-Span-930"><span class="mrow" id="MathJax-Span-931"><span class="mo" id="MathJax-Span-932"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="mn" id="MathJax-Span-933"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">3</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi><mo>=</mo><mn>8</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>3</mn></math></span></span><script type="math/tex" id="MathJax-Element-80">I =
8/3</script>. You could rightly point to this example and say that the integration is actually a lot less
work than the Monte Carlo. That might be true in the case where the function is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-81-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-934" style="width: 3.773em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.102em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.191em, 1003.1em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-935"><span class="mi" id="MathJax-Span-936"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-937"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-938"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-939"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-940" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="msubsup" id="MathJax-Span-941" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-942"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.218em; left: 0.416em;"><span class="mn" id="MathJax-Span-943" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>x</mi><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-81">f(x) = x^2</script>, but
there exist many functions where it might be simpler to solve for the Monte Carlo than for the
integration, like <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-82-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-944" style="width: 5.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.651em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.191em, 1004.65em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-945"><span class="mi" id="MathJax-Span-946"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-947"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-948"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-949"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-950" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-951" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mi" id="MathJax-Span-952"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span class="msubsup" id="MathJax-Span-953"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-954"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.218em; left: 0.416em;"><span class="mn" id="MathJax-Span-955" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">5</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-956"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-957"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-958"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>s</mi><mi>i</mi><msup><mi>n</mi><mn>5</mn></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-82">f(x) = sin^5(x)</script>.

<p></p><pre class="listing tilde"><code><span class="line"></span>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; N; i++) {
<span class="line"></span>        <span class="hljs-keyword">auto</span> x = <span class="hljs-built_in">random_double</span>(a, b);
<span class="line"></span>        sum += <span class="hljs-built_in">pow</span>(<span class="hljs-built_in">sin</span>(x), <span class="hljs-number">5.0</span>);
<span class="line"></span>    }</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_integ-sin5">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;9:</b> Integrating sin<sup>5</sup></div></center>
<p>


</p></div>

<p></p><p>

</p><div class="together">
We could also use the Monte Carlo algorithm for functions where an analytical integration does not
exist, like <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-83-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;ln&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-959" style="width: 6.666em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.478em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1005.48em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-960"><span class="mi" id="MathJax-Span-961"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-962"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-963"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-964"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-965" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-966" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mo" id="MathJax-Span-967"></span><span class="mo" id="MathJax-Span-968"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-969"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mo" id="MathJax-Span-970"></span><span class="mo" id="MathJax-Span-971"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-972"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-973"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-974"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>ln</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-83">f(x) = \ln(\sin(x))</script>.

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; N; i++) {
<span class="line"></span>    <span class="hljs-keyword">auto</span> x = <span class="hljs-built_in">random_double</span>(a, b);
<span class="line"></span>    sum += <span class="hljs-built_in">log</span>(<span class="hljs-built_in">sin</span>(x));
<span class="line"></span>}</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_integ-ln-sin">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;10:</b> Integrating ln(sin)</div></center>
<p>


</p></div>

<p></p><p>

In graphics, we often have functions that we can write down explicitly but that have a complicated
analytic integration, or, just as often, we have functions that <em class="underscore">can</em> be evaluated but that <em class="underscore">can't</em>
be written down explicitly, and we will frequently find ourselves with a function that can <em class="underscore">only</em> be
evaluated probabilistically. The function <code>ray_color</code> from the first two books is an example of a
function that can only be determined probabilistically. We can’t know what color can be seen from
any given place in all directions, but we can statistically estimate which color can be seen from
one particular place, for a single particular direction.

</p>
<a class="target" name="densityfunctions">&nbsp;</a><a class="target" name="onedimensionalmontecarlointegration/densityfunctions">&nbsp;</a><a class="target" name="toc3.3">&nbsp;</a><h2>Density Functions</h2>
<p>

The <code>ray_color</code> function that we wrote in the first two books, while elegant in its simplicity, has
a fairly <em class="underscore">major</em> problem. Small light sources create too much noise. This is because our uniform
sampling doesn’t sample these light sources often enough. Light sources are only sampled if a ray
scatters toward them, but this can be unlikely for a small light, or a light that is far away. If
the background color is black, then the only real sources of light in the scene are from the lights
that are actually placed about the scene. There might be two rays that intersect at nearby points on
a surface, one that is randomly reflected toward the light and one that is not. The ray that is
reflected toward the light will appear a very bright color. The ray that is reflected to somewhere
else will appear a very dark color. The two intensities should really be somewhere in the middle. We
could lessen this problem if we steered both of these rays toward the light, but this would cause
the scene to be inaccurately bright.

</p><p>

For any given ray, we usually trace from the camera, through the scene, and terminate at a light.
But imagine if we traced this same ray from the light source, through the scene, and terminated at
the camera. This ray would start with a bright intensity and would lose energy with each successive
bounce around the scene. It would ultimately arrive at the camera, having been dimmed and colored by
its reflections off various surfaces. Now, imagine if this ray was forced to bounce toward the
camera as soon as it could. It would appear inaccurately bright because it hadn't been dimmed by
successive bounces. This is analogous to sending more random samples toward the light. It would go a
long way toward solving our problem of having a bright pixel next to a dark pixel, but it would then
just make <em class="underscore">all</em> of our pixels bright.

</p><p>

We can remove this inaccuracy by downweighting those samples to adjust for the over-sampling. How do
we do this adjustment? Well, we'll first need to understand the concept of a <em class="underscore">probability density
function</em>. But to understand the concept of a <em class="underscore">probability density function</em>, we'll first need to
know what a <em class="underscore">density function</em> is.

</p><p>

A <em class="underscore">density function</em> is just the continuous version of a histogram. Here’s an example of a histogram
from the histogram Wikipedia page:

</p><p>

  </p><center><div class="image" style=""><a href="./input_files/fig-3.03-histogram.jpg" target="_blank"><img class="markdeep" src="./input_files/fig-3.03-histogram.jpg"></a><center><span class="imagecaption"><a class="target" name="figure_histogram">&nbsp;</a><b style="font-style:normal;">Figure&nbsp;3:</b> Histogram example</span></center></div></center>

<p></p><p>

If we had more items in our data source, the number of bins would stay the same, but each bin would
have a higher frequency of each item. If we divided the data into more bins, we'd have more bins,
but each bin would have a lower frequency of each item. If we took the number of bins and raised it
to infinity, we'd have an infinite number of zero-frequency bins. To solve for this, we'll replace
our histogram, which is a <em class="underscore">discrete function</em>, with a <em class="underscore">discrete density function</em>. A <em class="underscore">discrete
density function</em> differs from a <em class="underscore">discrete function</em> in that it normalizes the y-axis to a fraction
or percentage of the total, <em class="underscore">i.e</em> its density, instead of a total count for each bin. Converting
from a <em class="underscore">discrete function</em> to a <em class="underscore">discrete density function</em> is trivial:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-84-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtext&gt;Density of Bin i&lt;/mtext&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mtext&gt;Number of items in Bin i&lt;/mtext&gt;&lt;mtext&gt;Number of items total&lt;/mtext&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-975" style="width: 18.184em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.034em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1015.03em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-976"><span class="mtext" id="MathJax-Span-977"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">D</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">y</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;"> </span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;"> </span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">B</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;"> </span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span class="mo" id="MathJax-Span-978" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-979" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 8.422em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1008.32em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -4.13em;"><span class="mtext" id="MathJax-Span-980"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">N</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">u</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">m</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;"> </span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;"> </span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">m</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;"> </span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;"> </span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">B</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;"> </span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1007.34em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -3.665em;"><span class="mtext" id="MathJax-Span-981"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">N</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">u</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">m</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;"> </span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;"> </span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">m</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;"> </span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1008.42em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 8.422em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>Density of Bin i</mtext><mo>=</mo><mfrac><mtext>Number of items in Bin i</mtext><mtext>Number of items total</mtext></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-84"> \text{Density of Bin i} = \frac{\text{Number of items in Bin i}}
                                      {\text{Number of items total}} </script>

</p><p>

Once we have a <em class="underscore">discrete density function</em>, we can then convert it into a <em class="underscore">density function</em> by
changing our discrete values into continuous values.

</p><p>

    <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Error" id="MathJax-Element-85-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtext&gt;Bin Density&lt;/mtext&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mtext&gt;Fraction of trees between height&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;and&amp;#xA0;&lt;/mtext&gt;&lt;msup&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>Bin Density</mtext><mo>=</mo><mfrac><mrow><mo stretchy="false">(</mo><mtext>Fraction of trees between height&nbsp;</mtext><mi>H</mi><mtext>&nbsp;and&nbsp;</mtext><msup><mi>H</mi><mo>′</mo></msup><mo stretchy="false">)</mo></mrow><mrow><mo stretchy="false">(</mo><mi>H</mi><mo>−</mo><msup><mi>H</mi><mo>′</mo></msup><mo stretchy="false">)</mo></mrow></mfrac></math></span></span><script type="math/tex; mode=display" id="MathJax-Element-85"> \text{Bin Density} = \frac{(\text{Fraction of trees between height }H\text{ and }H’)}
                            {(H-H’)} </script>

</p><p>

So a <em class="underscore">density function</em> is a continuous histogram where all of the values are normalized against a
total. If we had a specific tree we wanted to know the height of, we could create a <em class="underscore">probability
function</em> that would tell us how likely it is for our tree to fall within a specific bin.

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-86-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtext&gt;Probability of Bin i&lt;/mtext&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mtext&gt;Number of items in Bin i&lt;/mtext&gt;&lt;mtext&gt;Number of items total&lt;/mtext&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-995" style="width: 19.579em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.17em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1016.17em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-996"><span class="mtext" id="MathJax-Span-997"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">y</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;"> </span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;"> </span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">B</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;"> </span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span class="mo" id="MathJax-Span-998" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-999" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 8.422em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1008.32em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -4.13em;"><span class="mtext" id="MathJax-Span-1000"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">N</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">u</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">m</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;"> </span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;"> </span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">m</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;"> </span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;"> </span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">B</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;"> </span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1007.34em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -3.665em;"><span class="mtext" id="MathJax-Span-1001"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">N</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">u</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">m</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;"> </span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;"> </span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">m</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;"> </span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1008.42em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 8.422em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>Probability of Bin i</mtext><mo>=</mo><mfrac><mtext>Number of items in Bin i</mtext><mtext>Number of items total</mtext></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-86"> \text{Probability of Bin i} = \frac{\text{Number of items in Bin i}}
                                          {\text{Number of items total}} </script>

</p><p>

If we combined our <em class="underscore">probability function</em> and our (continuous) <em class="underscore">density function</em>, we could
interpret that as a statistical predictor of a tree’s height:

</p><p>

    <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Error" id="MathJax-Element-87-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtext&gt;Probability a random tree is between&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;and&amp;#xA0;&lt;/mtext&gt;&lt;msup&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mtext&gt;Bin Density&lt;/mtext&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>Probability a random tree is between&nbsp;</mtext><mi>H</mi><mtext>&nbsp;and&nbsp;</mtext><msup><mi>H</mi><mo>′</mo></msup><mo>=</mo><mtext>Bin Density</mtext><mo>⋅</mo><mo stretchy="false">(</mo><mi>H</mi><mo>−</mo><msup><mi>H</mi><mo>′</mo></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex; mode=display" id="MathJax-Element-87"> \text{Probability a random tree is between } H \text{ and } H’ =
        \text{Bin Density}\cdot(H-H’)</script>

</p><p>

Indeed, with this continuous probability function, we can now say the likelihood that any given tree
has a height that places it within any arbitrary span of multiple bins. This is a <em class="underscore">probability
density function</em> (henceforth <em class="underscore">PDF</em>). In short, a PDF is a continuous function that can be
integrated over to determine how likely a result is over an integral.

</p>
<a class="target" name="constructingapdf">&nbsp;</a><a class="target" name="onedimensionalmontecarlointegration/constructingapdf">&nbsp;</a><a class="target" name="toc3.4">&nbsp;</a><h2>Constructing a PDF</h2>
<p>

Let’s make a PDF and play around with it to build up an intuition. We'll use the following function:

</p><p>

  </p><center><div class="image" style=""><a href="./input_files/fig-3.04-linear-pdf.jpg" target="_blank"><img class="markdeep" src="./input_files/fig-3.04-linear-pdf.jpg"></a><center><span class="imagecaption"><a class="target" name="figure_linear-pdf">&nbsp;</a><b style="font-style:normal;">Figure&nbsp;4:</b> A linear PDF</span></center></div></center>

<p></p><p>

What does this function do? Well, we know that a PDF is just a continuous function that defines the
likelihood of an arbitrary range of values. This function <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-88-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1010" style="width: 1.501em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.24em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1011"><span class="mi" id="MathJax-Span-1012"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-1013"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1014"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1015"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-88">p(r)</script> is constrained between <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-89-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1016" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1017"><span class="mn" id="MathJax-Span-1018"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-89">0</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-90-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1019" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1020"><span class="mn" id="MathJax-Span-1021"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-90">2</script>
and linearly increases along that interval. So, if we used this function as a PDF to generate a
random number then the <em class="underscore">probability</em> of getting a number near zero would be less than the
probability of getting a number near two.

</p><p>

The PDF <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-91-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1022" style="width: 1.501em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.24em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1023"><span class="mi" id="MathJax-Span-1024"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-1025"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1026"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1027"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-91">p(r)</script> is a linear function that starts with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-92-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1028" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1029"><span class="mn" id="MathJax-Span-1030"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-92">0</script> at <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-93-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1031" style="width: 2.224em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.81em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1001.81em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1032"><span class="mi" id="MathJax-Span-1033"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1034" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-1035" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-93">r=0</script> and monotonically increases to its
highest point at <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-94-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1036" style="width: 1.707em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.397em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.4em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1037"><span class="mi" id="MathJax-Span-1038"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-1039"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-1040"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mo" id="MathJax-Span-1041"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-94">p(2)</script> for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-95-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1042" style="width: 2.224em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.81em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1001.81em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1043"><span class="mi" id="MathJax-Span-1044"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1045" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-1046" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo>=</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-95">r=2</script>. What is the value of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-96-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1047" style="width: 1.707em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.397em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.4em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1048"><span class="mi" id="MathJax-Span-1049"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-1050"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-1051"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mo" id="MathJax-Span-1052"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-96">p(2)</script>? What is the value of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-97-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1053" style="width: 1.501em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.24em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1054"><span class="mi" id="MathJax-Span-1055"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-1056"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1057"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1058"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-97">p(r)</script>? Maybe
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-98-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1059" style="width: 1.707em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.397em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.4em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1060"><span class="mi" id="MathJax-Span-1061"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-1062"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-1063"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mo" id="MathJax-Span-1064"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-98">p(2)</script> is 2? The PDF increases linearly from 0 to 2, so guessing that the value of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-99-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1065" style="width: 1.707em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.397em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.4em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1066"><span class="mi" id="MathJax-Span-1067"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-1068"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-1069"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mo" id="MathJax-Span-1070"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-99">p(2)</script> is 2 seems
reasonable. At least it looks like it can't be 0.

</p><p>

Remember that the PDF is a probability function. We are constraining the PDF so that it lies in the
range [0,2]. The PDF represents the continuous density function for a probabilistic list. If we know
that everything in that list is contained within 0 and 2, we can say that the probability of getting
a value between 0 and 2 is 100%. Therefore, the area under the curve must sum to 1:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-100-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;area&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1071" style="width: 7.596em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.253em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1006.25em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1072"><span class="mi" id="MathJax-Span-1073"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mo" id="MathJax-Span-1074"></span><span class="mo" id="MathJax-Span-1075"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1076"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-1077"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1078"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1079"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-1080"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mn" id="MathJax-Span-1081" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span class="mo" id="MathJax-Span-1082"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mn" id="MathJax-Span-1083" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mo" id="MathJax-Span-1084"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-1085" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-1086" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>area</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>,</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-100"> \operatorname{area}(p(r), 0, 2) = 1 </script>

</p><p>

All linear functions can be represented as a constant term multiplied by a variable.

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-101-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1087" style="width: 4.651em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.825em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1003.83em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1088"><span class="mi" id="MathJax-Span-1089"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-1090"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1091"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1092"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-1093" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-1094" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span></span><span class="mo" id="MathJax-Span-1095" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mi" id="MathJax-Span-1096" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>p</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mi>C</mi><mo>⋅</mo><mi>r</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-101"> p(r) = C \cdot r </script>

</p><p>

We need to solve for the value of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-102-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1097" style="width: 0.726em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.571em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.57em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1098"><span class="mi" id="MathJax-Span-1099"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-102">C</script>. We can use integration to work backwards.

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-103-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;area&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1100" style="width: 7.596em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.253em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1006.25em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1101"><span class="mn" id="MathJax-Span-1102"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-1103" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-1104" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mo" id="MathJax-Span-1105"></span><span class="mo" id="MathJax-Span-1106"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1107"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-1108"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1109"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1110"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-1111"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mn" id="MathJax-Span-1112" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span class="mo" id="MathJax-Span-1113"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mn" id="MathJax-Span-1114" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mo" id="MathJax-Span-1115"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mn>1</mn><mo>=</mo><mi>area</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>,</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-103"> 1 = \operatorname{area}(p(r), 0, 2) </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-104-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1116" style="width: 4.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.877em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.087em, 1003.88em, 2.998em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1117"><span class="mo" id="MathJax-Span-1118"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="msubsup" id="MathJax-Span-1119" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.637em, -999.997em); top: -2.218em; left: 0em;"><span class="mo" id="MathJax-Span-1120" style="vertical-align: -0.049em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∫</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -2.322em; left: 0.364em;"><span class="texatom" id="MathJax-Span-1121"><span class="mrow" id="MathJax-Span-1122"><span class="mn" id="MathJax-Span-1123" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -1.444em; left: 0.364em;"><span class="texatom" id="MathJax-Span-1124"><span class="mrow" id="MathJax-Span-1125"><span class="mn" id="MathJax-Span-1126" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mi" id="MathJax-Span-1127" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span></span><span class="mo" id="MathJax-Span-1128" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mi" id="MathJax-Span-1129" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mi" id="MathJax-Span-1130"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-1131"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.747em; border-left: 0px solid; width: 0px; height: 2.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>=</mo><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msubsup><mi>C</mi><mo>⋅</mo><mi>r</mi><mi>d</mi><mi>r</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-104"> = \int_{0}^{2} C \cdot r dr </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-105-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1132" style="width: 4.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.877em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.087em, 1003.88em, 2.998em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1133"><span class="mo" id="MathJax-Span-1134"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-1135" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span></span><span class="mo" id="MathJax-Span-1136" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="msubsup" id="MathJax-Span-1137" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.637em, -999.997em); top: -2.218em; left: 0em;"><span class="mo" id="MathJax-Span-1138" style="vertical-align: -0.049em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∫</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -2.322em; left: 0.364em;"><span class="texatom" id="MathJax-Span-1139"><span class="mrow" id="MathJax-Span-1140"><span class="mn" id="MathJax-Span-1141" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -1.444em; left: 0.364em;"><span class="texatom" id="MathJax-Span-1142"><span class="mrow" id="MathJax-Span-1143"><span class="mn" id="MathJax-Span-1144" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mi" id="MathJax-Span-1145" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mi" id="MathJax-Span-1146"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-1147"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.747em; border-left: 0px solid; width: 0px; height: 2.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>=</mo><mi>C</mi><mo>⋅</mo><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msubsup><mi>r</mi><mi>d</mi><mi>r</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-105"> = C \cdot \int_{0}^{2} r dr </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-106-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mfrac&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;msubsup&gt;&lt;mstyle scriptlevel=&quot;0&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1148" style="width: 4.341em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.567em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.519em, 1003.57em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1149"><span class="mo" id="MathJax-Span-1150"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-1151" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span></span><span class="mo" id="MathJax-Span-1152" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mfrac" id="MathJax-Span-1153" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(2.895em, 1000.62em, 4.341em, -999.997em); top: -4.646em; left: 50%; margin-left: -0.307em;"><span class="msubsup" id="MathJax-Span-1154"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-1155"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.218em; left: 0.261em;"><span class="mn" id="MathJax-Span-1156" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-1157"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.78em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.777em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1158"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.16em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mstyle" id="MathJax-Span-1159"><span class="mrow" id="MathJax-Span-1160"><span class="texatom" id="MathJax-Span-1161"><span class="mrow" id="MathJax-Span-1162"><span class="mo" id="MathJax-Span-1163"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">|</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -2.373em; left: 0.158em;"><span class="texatom" id="MathJax-Span-1164"><span class="mrow" id="MathJax-Span-1165"><span class="mn" id="MathJax-Span-1166" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -1.495em; left: 0.158em;"><span class="texatom" id="MathJax-Span-1167"><span class="mrow" id="MathJax-Span-1168"><span class="mn" id="MathJax-Span-1169" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.253em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>=</mo><mi>C</mi><mo>⋅</mo><mfrac><msup><mi>r</mi><mn>2</mn></msup><mn>2</mn></mfrac><msubsup><mstyle scriptlevel="0"><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">|</mo></mrow></mstyle><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msubsup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-106"> = C \cdot \frac{r^2}{2} \Big|_{0}^{2} </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-107-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1170" style="width: 5.839em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.806em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.364em, 1004.81em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1171"><span class="mo" id="MathJax-Span-1172"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-1173" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span></span><span class="mo" id="MathJax-Span-1174"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mfrac" id="MathJax-Span-1175"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(2.74em, 1000.78em, 4.341em, -999.997em); top: -4.646em; left: 50%; margin-left: -0.411em;"><span class="msubsup" id="MathJax-Span-1176"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mn" id="MathJax-Span-1177"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.373em; left: 0.416em;"><span class="mn" id="MathJax-Span-1178" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-1179"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.93em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.932em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mo" id="MathJax-Span-1180" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mfrac" id="MathJax-Span-1181" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-1182"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-1183"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.52em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.519em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mo" id="MathJax-Span-1184"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.441em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>=</mo><mi>C</mi><mo stretchy="false">(</mo><mfrac><msup><mn>2</mn><mn>2</mn></msup><mn>2</mn></mfrac><mo>−</mo><mfrac><mn>0</mn><mn>2</mn></mfrac><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-107"> = C ( \frac{2^2}{2} - \frac{0}{2} ) </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-108-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1185" style="width: 2.895em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.379em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1002.38em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1186"><span class="mi" id="MathJax-Span-1187"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span></span><span class="mo" id="MathJax-Span-1188" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-1189" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-1190"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-1191"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.52em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.519em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>C</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-108"> C = \frac{1}{2} </script>

</p><p>

That gives us the PDF of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-109-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1192" style="width: 3.98em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.257em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1003.26em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1193"><span class="mi" id="MathJax-Span-1194"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-1195"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1196"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1197"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-1198" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-1199" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="texatom" id="MathJax-Span-1200"><span class="mrow" id="MathJax-Span-1201"><span class="mo" id="MathJax-Span-1202"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="mn" id="MathJax-Span-1203"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-109">p(r) = r/2</script>. Just as with histograms we can sum up (integrate) the region
to figure out the probability that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-110-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1204" style="width: 0.313em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.261em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1205"><span class="mi" id="MathJax-Span-1206"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-110">r</script> is in some interval <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-111-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1207" style="width: 2.998em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.482em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1002.48em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1208"><span class="mo" id="MathJax-Span-1209"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">[</span></span><span class="msubsup" id="MathJax-Span-1210"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-1211"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mn" id="MathJax-Span-1212" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-1213"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-1214" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-1215"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mn" id="MathJax-Span-1216" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-1217"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><msub><mi>x</mi><mn>0</mn></msub><mo>,</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-111">[x_0,x_1]</script>:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-112-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;Probability&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;area&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1218" style="width: 18.443em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.24em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1015.24em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1219"><span class="mi" id="MathJax-Span-1220"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">y</span></span><span class="mo" id="MathJax-Span-1221"></span><span class="mo" id="MathJax-Span-1222"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1223"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="texatom" id="MathJax-Span-1224"><span class="mrow" id="MathJax-Span-1225"><span class="mo" id="MathJax-Span-1226"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">|</span></span></span></span><span class="msubsup" id="MathJax-Span-1227"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-1228"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mn" id="MathJax-Span-1229" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-1230" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">≤</span></span><span class="mi" id="MathJax-Span-1231" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1232" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">≤</span></span><span class="msubsup" id="MathJax-Span-1233" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-1234"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mn" id="MathJax-Span-1235" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-1236"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-1237" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-1238" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mo" id="MathJax-Span-1239"></span><span class="mo" id="MathJax-Span-1240"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1241"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-1242"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1243"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1244"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-1245"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-1246" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-1247"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mn" id="MathJax-Span-1248" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-1249"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-1250" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-1251"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mn" id="MathJax-Span-1252" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-1253"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>Probability</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>x</mi><mn>0</mn></msub><mo>≤</mo><mi>r</mi><mo>≤</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mi>area</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>,</mo><msub><mi>x</mi><mn>0</mn></msub><mo>,</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-112"> \operatorname{Probability} (r | x_0 \leq r \leq x_1 )
       = \operatorname{area}(p(r), x_0, x_1)
    </script>

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-113-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;Probability&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mfrac&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1254" style="width: 14.93em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.348em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1012.35em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1255"><span class="mi" id="MathJax-Span-1256"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">y</span></span><span class="mo" id="MathJax-Span-1257"></span><span class="mo" id="MathJax-Span-1258"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1259"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="texatom" id="MathJax-Span-1260"><span class="mrow" id="MathJax-Span-1261"><span class="mo" id="MathJax-Span-1262"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">|</span></span></span></span><span class="msubsup" id="MathJax-Span-1263"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-1264"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mn" id="MathJax-Span-1265" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-1266" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">≤</span></span><span class="mi" id="MathJax-Span-1267" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1268" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">≤</span></span><span class="msubsup" id="MathJax-Span-1269" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-1270"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mn" id="MathJax-Span-1271" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-1272"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-1273" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="msubsup" id="MathJax-Span-1274" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.637em, -999.997em); top: -2.218em; left: 0em;"><span class="mo" id="MathJax-Span-1275" style="vertical-align: -0.049em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∫</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1000.62em, 4.393em, -999.997em); top: -4.595em; left: 0.364em;"><span class="texatom" id="MathJax-Span-1276"><span class="mrow" id="MathJax-Span-1277"><span class="msubsup" id="MathJax-Span-1278"><span style="display: inline-block; position: relative; width: 0.571em; height: 0px;"><span style="position: absolute; clip: rect(1.139em, 1000.31em, 2.172em, -999.997em); top: -1.857em; left: 0em;"><span class="mi" id="MathJax-Span-1279" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; top: -1.444em; left: 0.313em;"><span class="mn" id="MathJax-Span-1280" style="font-size: 50%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.604em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1000.62em, 4.393em, -999.997em); top: -3.561em; left: 0.364em;"><span class="texatom" id="MathJax-Span-1281"><span class="mrow" id="MathJax-Span-1282"><span class="msubsup" id="MathJax-Span-1283"><span style="display: inline-block; position: relative; width: 0.571em; height: 0px;"><span style="position: absolute; clip: rect(1.139em, 1000.31em, 2.172em, -999.997em); top: -1.857em; left: 0em;"><span class="mi" id="MathJax-Span-1284" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; top: -1.444em; left: 0.313em;"><span class="mn" id="MathJax-Span-1285" style="font-size: 50%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span style="display: inline-block; width: 0px; height: 1.604em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-1286" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.101em;"><span class="mi" id="MathJax-Span-1287"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-1288"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.52em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.519em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mi" id="MathJax-Span-1289"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-1290"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>Probability</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>x</mi><mn>0</mn></msub><mo>≤</mo><mi>r</mi><mo>≤</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>=</mo><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>x</mi><mn>0</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>x</mi><mn>1</mn></msub></mrow></msubsup><mfrac><mi>r</mi><mn>2</mn></mfrac><mi>d</mi><mi>r</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-113"> \operatorname{Probability} (r | x_0 \leq r \leq x_1 ) = \int_{x_0}^{x_1}  \frac{r}{2} dr </script>

</p><p>

To confirm your understanding, you should integrate over the region <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-114-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1291" style="width: 2.224em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.81em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1001.81em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1292"><span class="mi" id="MathJax-Span-1293"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1294" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-1295" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-114">r=0</script> to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-115-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1296" style="width: 2.224em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.81em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1001.81em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1297"><span class="mi" id="MathJax-Span-1298"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1299" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-1300" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo>=</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-115">r=2</script>, you should get a
probability of 1.

</p><p>

After spending enough time with PDFs you might start referring to a PDF as the probability that a
variable <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-116-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1301" style="width: 0.313em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.261em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1302"><span class="mi" id="MathJax-Span-1303"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-116">r</script> is value <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-117-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1304" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1305"><span class="mi" id="MathJax-Span-1306"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-117">x</script>, <em class="underscore">i.e.</em> <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-118-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1307" style="width: 3.308em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.74em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1002.74em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1308"><span class="mi" id="MathJax-Span-1309"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-1310"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1311"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1312" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-1313" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-1314"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>r</mi><mo>=</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-118">p(r=x)</script>. Don't do this. For a continuous function, the
probability that a variable is a specific value is always zero. A PDF can only tell you the
probability that a variable will fall within a given interval. If the interval you're checking
against is a single value, then the PDF will always return a zero probability because its “bin” is
infinitely thin (has zero width). Here's a simple mathematical proof of this fact:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-119-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;Probability&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1315" style="width: 12.038em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.92em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.087em, 1009.92em, 2.998em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1316"><span class="mi" id="MathJax-Span-1317"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">y</span></span><span class="mo" id="MathJax-Span-1318"></span><span class="mo" id="MathJax-Span-1319"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1320"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1321" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-1322" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-1323"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-1324" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="msubsup" id="MathJax-Span-1325" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.637em, -999.997em); top: -2.218em; left: 0em;"><span class="mo" id="MathJax-Span-1326" style="vertical-align: -0.049em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∫</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -2.322em; left: 0.364em;"><span class="texatom" id="MathJax-Span-1327"><span class="mrow" id="MathJax-Span-1328"><span class="mi" id="MathJax-Span-1329" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -1.444em; left: 0.364em;"><span class="texatom" id="MathJax-Span-1330"><span class="mrow" id="MathJax-Span-1331"><span class="mi" id="MathJax-Span-1332" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mi" id="MathJax-Span-1333" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-1334"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1335"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1336"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mi" id="MathJax-Span-1337"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-1338"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.747em; border-left: 0px solid; width: 0px; height: 2.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>Probability</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>r</mi><mo>=</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow></msubsup><mi>p</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mi>d</mi><mi>r</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-119"> \operatorname{Probability} (r = x) = \int_{x}^{x}  p(r) dr </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-120-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msubsup&gt;&lt;mstyle scriptlevel=&quot;0&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1339" style="width: 3.205em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.637em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.036em, 1002.64em, 2.947em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1340"><span class="mo" id="MathJax-Span-1341"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-1342" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span class="mo" id="MathJax-Span-1343"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1344"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1345"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="msubsup" id="MathJax-Span-1346"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.16em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mstyle" id="MathJax-Span-1347"><span class="mrow" id="MathJax-Span-1348"><span class="texatom" id="MathJax-Span-1349"><span class="mrow" id="MathJax-Span-1350"><span class="mo" id="MathJax-Span-1351"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">|</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -2.373em; left: 0.158em;"><span class="texatom" id="MathJax-Span-1352"><span class="mrow" id="MathJax-Span-1353"><span class="mi" id="MathJax-Span-1354" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -1.495em; left: 0.158em;"><span class="texatom" id="MathJax-Span-1355"><span class="mrow" id="MathJax-Span-1356"><span class="mi" id="MathJax-Span-1357" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.684em; border-left: 0px solid; width: 0px; height: 2.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>=</mo><mi>P</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><msubsup><mstyle scriptlevel="0"><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">|</mo></mrow></mstyle><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow></msubsup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-120"> = P(r) \Big|_{x}^{x} </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-121-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1358" style="width: 5.684em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.703em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1004.7em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1359"><span class="mo" id="MathJax-Span-1360"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-1361" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span class="mo" id="MathJax-Span-1362"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1363"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-1364"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-1365" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mi" id="MathJax-Span-1366" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span class="mo" id="MathJax-Span-1367"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1368"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-1369"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>=</mo><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>−</mo><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-121"> = P(x) - P(x) </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-122-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1370" style="width: 1.501em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1001.24em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1371"><span class="mo" id="MathJax-Span-1372"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-1373" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>=</mo><mn>0</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-122"> = 0 </script>

</p><p>

Finding the probability of a region surrounding x may not be zero:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-123-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;Probability&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;area&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1374" style="width: 26.397em; display: inline-block;"><span style="display: inline-block; position: relative; width: 21.8em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1021.8em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1375"><span class="mi" id="MathJax-Span-1376"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">y</span></span><span class="mo" id="MathJax-Span-1377"></span><span class="mo" id="MathJax-Span-1378"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1379"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="texatom" id="MathJax-Span-1380"><span class="mrow" id="MathJax-Span-1381"><span class="mo" id="MathJax-Span-1382"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">|</span></span></span></span><span class="mi" id="MathJax-Span-1383"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-1384" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mi" id="MathJax-Span-1385" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">Δ</span></span><span class="mi" id="MathJax-Span-1386"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-1387" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">&lt;</span></span><span class="mi" id="MathJax-Span-1388" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1389" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">&lt;</span></span><span class="mi" id="MathJax-Span-1390" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-1391" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">+</span></span><span class="mi" id="MathJax-Span-1392" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">Δ</span></span><span class="mi" id="MathJax-Span-1393"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-1394"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-1395" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-1396" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mo" id="MathJax-Span-1397"></span><span class="mo" id="MathJax-Span-1398"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1399"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-1400"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1401"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1402"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-1403"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-1404" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-1405" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mi" id="MathJax-Span-1406" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">Δ</span></span><span class="mi" id="MathJax-Span-1407"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-1408"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-1409" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-1410" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">+</span></span><span class="mi" id="MathJax-Span-1411" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">Δ</span></span><span class="mi" id="MathJax-Span-1412"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-1413"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>Probability</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo>−</mo><mi mathvariant="normal">Δ</mi><mi>x</mi><mo>&lt;</mo><mi>r</mi><mo>&lt;</mo><mi>x</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>area</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>,</mo><mi>x</mi><mo>−</mo><mi mathvariant="normal">Δ</mi><mi>x</mi><mo>,</mo><mi>x</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>x</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-123"> \operatorname{Probability} (r | x - \Delta x < r < x + \Delta x ) =
         \operatorname{area}(p(r), x - \Delta x, x + \Delta x) </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-124-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1414" style="width: 10.54em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.68em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1008.68em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1415"><span class="mo" id="MathJax-Span-1416"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-1417" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span class="mo" id="MathJax-Span-1418"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1419"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-1420" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">+</span></span><span class="mi" id="MathJax-Span-1421" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">Δ</span></span><span class="mi" id="MathJax-Span-1422"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-1423"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-1424" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mi" id="MathJax-Span-1425" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span class="mo" id="MathJax-Span-1426"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1427"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-1428" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mi" id="MathJax-Span-1429" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">Δ</span></span><span class="mi" id="MathJax-Span-1430"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-1431"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>=</mo><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>x</mi><mo stretchy="false">)</mo><mo>−</mo><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mi mathvariant="normal">Δ</mi><mi>x</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-124"> = P(x + \Delta x) - P(x - \Delta x) </script>

</p>
<a class="target" name="choosingoursamples">&nbsp;</a><a class="target" name="onedimensionalmontecarlointegration/choosingoursamples">&nbsp;</a><a class="target" name="toc3.5">&nbsp;</a><h2>Choosing our Samples</h2>
<p>

If we have a PDF for the function that we care about, then we have the probability that the function
will return a value within an arbitrary interval. We can use this to determine where we should
sample. Remember that this started as a quest to determine the best way to sample a scene so that we
wouldn't get very bright pixels next to very dark pixels. If we have a PDF for the scene, then we
can probabilistically steer our samples toward the light without making the image inaccurately
bright. We already said that if we steer our samples toward the light then we <em class="underscore">will</em> make the image
inaccurately bright. We need to figure out how to steer our samples without introducing this
inaccuracy, this will be explained a little bit later, but for now we'll focus on generating samples
if we have a PDF. How do we generate a random number with a PDF? For that we will need some more
machinery. Don’t worry — this doesn’t go on forever!

</p><p>

</p><div class="together">
Our random number generator <code>random_double()</code> produces a random double between 0 and 1. The number
generator is uniform between 0 and 1, so any number between 0 and 1 has equal likelihood. If our PDF
is uniform over a domain, say <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-125-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1432" style="width: 2.637em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.172em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1002.17em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1433"><span class="mo" id="MathJax-Span-1434"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">[</span></span><span class="mn" id="MathJax-Span-1435"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span class="mo" id="MathJax-Span-1436"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mn" id="MathJax-Span-1437" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span class="mo" id="MathJax-Span-1438"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>10</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-125">[0,10]</script>, then we can trivially produce perfect samples for this
uniform PDF with

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-number">10.0</span> * random_double()</code></pre><p>

</p></div>

<p></p><p>

That's an easy case, but the vast majority of cases that we're going to care about are nonuniform.
We need to figure out a way to convert a uniform random number generator into a nonuniform random
number generator, where the distribution is defined by the PDF. We'll just <em class="underscore">assume</em> that there
exists a function <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-126-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1439" style="width: 1.501em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.24em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1440"><span class="mi" id="MathJax-Span-1441"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-1442"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1443"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mo" id="MathJax-Span-1444"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-126">f(d)</script> that takes uniform input and produces a nonuniform distribution weighted by
PDF. We just need to figure out a way to solve for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-127-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1445" style="width: 1.501em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.24em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1446"><span class="mi" id="MathJax-Span-1447"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-1448"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1449"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mo" id="MathJax-Span-1450"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-127">f(d)</script>.

</p><p>

For the PDF given above, where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-128-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1451" style="width: 3.567em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.947em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.984em, 1002.95em, 3.05em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1452"><span class="mi" id="MathJax-Span-1453"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-1454"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1455"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1456"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-1457" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-1458" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.139em, 1000.21em, 2.172em, -999.997em); top: -2.425em; left: 50%; margin-left: -0.101em;"><span class="mi" id="MathJax-Span-1459" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.31em, 2.172em, -999.997em); top: -1.392em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-1460" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.42em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.416em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.809em; border-left: 0px solid; width: 0px; height: 2.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mi>r</mi><mn>2</mn></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-128">p(r) = \frac{r}{2}</script>, the probability of a random sample is higher
toward 2 than it is toward 0. There is a greater probability of getting a number between 1.8 and 2.0
than between 0.0 and 0.2. If we put aside our mathematics hat for a second and put on our computer
science hat, maybe we can figure out a smart way of partitioning the PDF. We know that there is a
higher probability near 2 than near 0, but what is the value that splits the probability in half?
What is the value that a random number has a 50% chance of being higher than and a 50% chance of
being lower than? What is the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-129-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1461" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1462"><span class="mi" id="MathJax-Span-1463"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-129">x</script> that solves:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-130-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mn&gt;50&lt;/mn&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0025;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mfrac&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mfrac&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1464" style="width: 10.023em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.267em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1008.27em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1465"><span class="mn" id="MathJax-Span-1466"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">5</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span class="mi" id="MathJax-Span-1467"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">%</span></span><span class="mo" id="MathJax-Span-1468" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="msubsup" id="MathJax-Span-1469" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.637em, -999.997em); top: -2.218em; left: 0em;"><span class="mo" id="MathJax-Span-1470" style="vertical-align: -0.049em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∫</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -2.322em; left: 0.364em;"><span class="texatom" id="MathJax-Span-1471"><span class="mrow" id="MathJax-Span-1472"><span class="mi" id="MathJax-Span-1473" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -1.444em; left: 0.364em;"><span class="texatom" id="MathJax-Span-1474"><span class="mrow" id="MathJax-Span-1475"><span class="mn" id="MathJax-Span-1476" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-1477" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.101em;"><span class="mi" id="MathJax-Span-1478"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-1479"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.52em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.519em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mi" id="MathJax-Span-1480"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-1481"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1482" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="msubsup" id="MathJax-Span-1483" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.637em, -999.997em); top: -2.218em; left: 0em;"><span class="mo" id="MathJax-Span-1484" style="vertical-align: -0.049em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∫</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -2.322em; left: 0.364em;"><span class="texatom" id="MathJax-Span-1485"><span class="mrow" id="MathJax-Span-1486"><span class="mn" id="MathJax-Span-1487" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -1.444em; left: 0.364em;"><span class="texatom" id="MathJax-Span-1488"><span class="mrow" id="MathJax-Span-1489"><span class="mi" id="MathJax-Span-1490" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-1491" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.101em;"><span class="mi" id="MathJax-Span-1492"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-1493"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.52em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.519em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mi" id="MathJax-Span-1494"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-1495"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mn>50</mn><mi mathvariant="normal">%</mi><mo>=</mo><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow></msubsup><mfrac><mi>r</mi><mn>2</mn></mfrac><mi>d</mi><mi>r</mi><mo>=</mo><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msubsup><mfrac><mi>r</mi><mn>2</mn></mfrac><mi>d</mi><mi>r</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-130"> 50\% = \int_{0}^{x}  \frac{r}{2} dr  = \int_{x}^{2}  \frac{r}{2} dr </script>

</p><p>

Solving gives us:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-131-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mn&gt;0.5&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mfrac&gt;&lt;msubsup&gt;&lt;mstyle scriptlevel=&quot;0&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1496" style="width: 4.393em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.618em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.519em, 1003.62em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1497"><span class="mn" id="MathJax-Span-1498"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">5</span></span><span class="mo" id="MathJax-Span-1499" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-1500" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(2.895em, 1000.62em, 4.341em, -999.997em); top: -4.646em; left: 50%; margin-left: -0.307em;"><span class="msubsup" id="MathJax-Span-1501"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-1502"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.218em; left: 0.261em;"><span class="mn" id="MathJax-Span-1503" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-1504"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">4</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.78em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.777em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1505"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.16em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mstyle" id="MathJax-Span-1506"><span class="mrow" id="MathJax-Span-1507"><span class="texatom" id="MathJax-Span-1508"><span class="mrow" id="MathJax-Span-1509"><span class="mo" id="MathJax-Span-1510"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">|</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -2.373em; left: 0.158em;"><span class="texatom" id="MathJax-Span-1511"><span class="mrow" id="MathJax-Span-1512"><span class="mi" id="MathJax-Span-1513" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -1.495em; left: 0.158em;"><span class="texatom" id="MathJax-Span-1514"><span class="mrow" id="MathJax-Span-1515"><span class="mn" id="MathJax-Span-1516" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.253em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mn>0.5</mn><mo>=</mo><mfrac><msup><mi>r</mi><mn>2</mn></msup><mn>4</mn></mfrac><msubsup><mstyle scriptlevel="0"><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">|</mo></mrow></mstyle><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow></msubsup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-131"> 0.5 = \frac{r^2}{4} \Big|_{0}^{x} </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-132-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mn&gt;0.5&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1517" style="width: 3.98em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.257em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.519em, 1003.26em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1518"><span class="mn" id="MathJax-Span-1519"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">5</span></span><span class="mo" id="MathJax-Span-1520" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-1521" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(2.895em, 1000.78em, 4.341em, -999.997em); top: -4.646em; left: 50%; margin-left: -0.411em;"><span class="msubsup" id="MathJax-Span-1522"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-1523"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.218em; left: 0.416em;"><span class="mn" id="MathJax-Span-1524" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-1525"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">4</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.93em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.932em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.253em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mn>0.5</mn><mo>=</mo><mfrac><msup><mi>x</mi><mn>2</mn></msup><mn>4</mn></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-132"> 0.5 = \frac{x^2}{4} </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-133-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1526" style="width: 2.792em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.275em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.139em, 1002.27em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1527"><span class="msubsup" id="MathJax-Span-1528"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-1529"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.27em; left: 0.416em;"><span class="mn" id="MathJax-Span-1530" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-1531" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-1532" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>x</mi><mn>2</mn></msup><mo>=</mo><mn>2</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-133"> x^2 = 2</script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-134-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msqrt&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msqrt&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1533" style="width: 3.257em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.689em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.087em, 1002.69em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1534"><span class="mi" id="MathJax-Span-1535"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-1536" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="msqrt" id="MathJax-Span-1537" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.191em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0.777em;"><span class="mrow" id="MathJax-Span-1538"><span class="mn" id="MathJax-Span-1539"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.984em, 1000.42em, 1.294em, -999.997em); top: -2.167em; left: 0.777em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 0.416em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span><span style="position: absolute; clip: rect(3.05em, 1000.78em, 4.341em, -999.997em); top: -4.181em; left: 0em;"><span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">√</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.628em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>x</mi><mo>=</mo><msqrt><mn>2</mn></msqrt></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-134"> x = \sqrt{2}</script>

</p><p>

As a crude approximation we could create a function <code>f(d)</code> that takes as input <code>double d =
random_double()</code>. If <code>d</code> is less than (or equal to) 0.5, it produces a uniform number in
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-135-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msqrt&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msqrt&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1540" style="width: 3.102em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.534em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.139em, 1002.53em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1541"><span class="mo" id="MathJax-Span-1542"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">[</span></span><span class="mn" id="MathJax-Span-1543"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span class="mo" id="MathJax-Span-1544"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msqrt" id="MathJax-Span-1545" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.191em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0.777em;"><span class="mrow" id="MathJax-Span-1546"><span class="mn" id="MathJax-Span-1547"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.984em, 1000.42em, 1.294em, -999.997em); top: -2.064em; left: 0.777em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 0.416em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span><span style="position: absolute; clip: rect(3.05em, 1000.78em, 4.341em, -999.997em); top: -4.13em; left: 0em;"><span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">√</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1548"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><msqrt><mn>2</mn></msqrt><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-135">[0,\sqrt{2}]</script>, if <code>d</code> is greater than 0.5, it produces a uniform number in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-136-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msqrt&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msqrt&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1549" style="width: 3.102em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.534em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.139em, 1002.53em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1550"><span class="mo" id="MathJax-Span-1551"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">[</span></span><span class="msqrt" id="MathJax-Span-1552"><span style="display: inline-block; position: relative; width: 1.191em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0.777em;"><span class="mrow" id="MathJax-Span-1553"><span class="mn" id="MathJax-Span-1554"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.984em, 1000.42em, 1.294em, -999.997em); top: -2.064em; left: 0.777em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 0.416em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span><span style="position: absolute; clip: rect(3.05em, 1000.78em, 4.341em, -999.997em); top: -4.13em; left: 0em;"><span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">√</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1555"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mn" id="MathJax-Span-1556" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mo" id="MathJax-Span-1557"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><msqrt><mn>2</mn></msqrt><mo>,</mo><mn>2</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-136">[\sqrt{2}, 2]</script>.

</p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">f</span><span class="hljs-params">(<span class="hljs-type">double</span> d)</span>
<span class="line"></span></span>{
<span class="line"></span>    <span class="hljs-keyword">if</span> (d &lt;= <span class="hljs-number">0.5</span>)
<span class="line"></span>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">sqrt</span>(<span class="hljs-number">2.0</span>) * <span class="hljs-built_in">random_double</span>();
<span class="line"></span>    <span class="hljs-keyword">else</span>
<span class="line"></span>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">sqrt</span>(<span class="hljs-number">2.0</span>) + (<span class="hljs-number">2</span> - <span class="hljs-built_in">sqrt</span>(<span class="hljs-number">2.0</span>)) * <span class="hljs-built_in">random_double</span>();
<span class="line"></span>}</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_crude-approx">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;11:</b> A crude, first-order approximation to nonuniform PDF</div></center>
<p>


</p><div class="together">
While our initial random number generator was uniform from 0 to 1:

<p></p><p>

   </p><center><div class="image" style=""><a href="./input_files/fig-3.05-uniform-dist.jpg" target="_blank"><img class="markdeep" src="./input_files/fig-3.05-uniform-dist.jpg"></a><center><span class="imagecaption"><a class="target" name="figure_uniform-dist">&nbsp;</a><b style="font-style:normal;">Figure&nbsp;5:</b> A uniform distribution</span></center></div></center>

<p></p><p>

</p></div>

<p></p><p>

</p><div class="together">
Our, new, crude approximation for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-137-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1558" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(-0.307em, 1000.62em, 1.759em, -999.997em); top: -0.979em; left: 0em;"><span class="mrow" id="MathJax-Span-1559"><span class="mfrac" id="MathJax-Span-1560"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.139em, 1000.21em, 2.172em, -999.997em); top: -2.425em; left: 50%; margin-left: -0.101em;"><span class="mi" id="MathJax-Span-1561" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.31em, 2.172em, -999.997em); top: -1.392em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-1562" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.42em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.416em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.984em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.809em; border-left: 0px solid; width: 0px; height: 2.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mi>r</mi><mn>2</mn></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-137">\frac{r}{2}</script> is nonuniform (but only just):

<p></p><p>

    </p><center><div class="image" style=""><a href="./input_files/fig-3.06-nonuniform-dist.jpg" target="_blank"><img class="markdeep" src="./input_files/fig-3.06-nonuniform-dist.jpg"></a><center><span class="imagecaption"><a class="target" name="figure_approx-f">&nbsp;</a><b style="font-style:normal;">Figure&nbsp;6:</b> A nonuniform distribution for r/2</span></center></div></center>

<p></p><p>

</p></div>

<p></p><p>

We had the analytical solution to the integration above, so we could very easily solve for the 50%
value. But we could also solve for this 50% value experimentally. There will be functions that we
either can't or don't want to solve for the integration. In these cases, we can get an experimental
result close to the real value. Let's take the function:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-138-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1563" style="width: 7.337em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.046em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.674em, 1006.05em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1564"><span class="mi" id="MathJax-Span-1565"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-1566"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1567"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-1568"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-1569" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="msubsup" id="MathJax-Span-1570" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.294em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-1571"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -4.543em; left: 0.364em;"><span class="texatom" id="MathJax-Span-1572"><span class="mrow" id="MathJax-Span-1573"><span class="mfrac" id="MathJax-Span-1574"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.036em, 1000.52em, 1.862em, -999.997em); top: -2.012em; left: 50%; margin-left: -0.256em;"><span class="mrow" id="MathJax-Span-1575"><span class="mo" id="MathJax-Span-1576" style="font-size: 50%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mi" id="MathJax-Span-1577" style="font-size: 50%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span><span style="display: inline-block; width: 0px; height: 1.604em;"></span></span><span style="position: absolute; clip: rect(1.036em, 1000.42em, 1.862em, -999.997em); top: -1.237em; left: 50%; margin-left: -0.204em;"><span class="mrow" id="MathJax-Span-1578"><span class="mn" id="MathJax-Span-1579" style="font-size: 50%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-1580" style="font-size: 50%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 1.604em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.62em, 1.242em, -999.997em); top: -1.237em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.622em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-1581"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mi" id="MathJax-Span-1582"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span class="msubsup" id="MathJax-Span-1583"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-1584"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.27em; left: 0.416em;"><span class="mn" id="MathJax-Span-1585" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-1586"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1587"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-1588"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 2.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mfrac><mrow><mo>−</mo><mi>x</mi></mrow><mrow><mn>2</mn><mi>π</mi></mrow></mfrac></mrow></msup><mi>s</mi><mi>i</mi><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-138"> p(x) = e^{\frac{-x}{2 \pi}} sin^2(x) </script>

</p><p>

</p><div class="together">
Which looks a little something like this:

<p></p><p>

    </p><center><div class="image" style=""><a href="./input_files/fig-3.07-exp-sin2.jpg" target="_blank"><img class="markdeep" src="./input_files/fig-3.07-exp-sin2.jpg"></a><center><span class="imagecaption"><a class="target" name="figure_exp-sin2">&nbsp;</a><b style="font-style:normal;">Figure&nbsp;7:</b> A function that we don't want to solve analytically
    </span></center></div></center>

<p></p><p>

</p></div>

<p></p><p>

</p><div class="together">
At this point you should be familiar with how to experimentally solve for the area under a curve.
We'll take our existing code and modify it slightly to get an estimate for the 50% value. We want to
solve for the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-139-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1589" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1590"><span class="mi" id="MathJax-Span-1591"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-139">x</script> value that gives us half of the total area under the curve. As we go along and
solve for the rolling sum over N samples, we're also going to store each individual sample alongside
its <code>p(x)</code> value. After we solve for the total sum, we'll sort our samples and add them up until we
have an area that is half of the total. From <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-140-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1592" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1593"><span class="mn" id="MathJax-Span-1594"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-140">0</script> to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-141-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1595" style="width: 1.036em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.83em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1596"><span class="mn" id="MathJax-Span-1597"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-1598"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-141">2\pi</script> for example:

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"rtweekend.h"</span></span>
<span class="line"></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;algorithm&gt;</span></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iomanip&gt;</span></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;math.h&gt;</span></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cmath&gt;</span></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span>
<span class="line"></span>
<span class="line"></span><span class="hljs-keyword">struct</span> <span class="hljs-title class_">sample</span> {
<span class="line"></span>    <span class="hljs-type">double</span> x;
<span class="line"></span>    <span class="hljs-type">double</span> p_x;
<span class="line"></span>};
<span class="line"></span>
<span class="line"></span><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">compare_by_x</span><span class="hljs-params">(<span class="hljs-type">const</span> sample&amp; a, <span class="hljs-type">const</span> sample&amp; b)</span> </span>{
<span class="line"></span>    <span class="hljs-keyword">return</span> a.x &lt; b.x;
<span class="line"></span>}
<span class="line"></span>
<span class="line"></span><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
<span class="line"></span>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> N = <span class="hljs-number">10000</span>;
<span class="line"></span>    <span class="hljs-type">double</span> sum = <span class="hljs-number">0.0</span>;
<span class="line"></span>
<span class="line"></span>    <span class="hljs-comment">// iterate through all of our samples</span>
<span class="line"></span>    std::vector&lt;sample&gt; samples;
<span class="line"></span>    <span class="hljs-keyword">for</span> (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; N; i++) {
<span class="line"></span>        <span class="hljs-comment">// Get the area under the curve</span>
<span class="line"></span>        <span class="hljs-keyword">auto</span> x = <span class="hljs-built_in">random_double</span>(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>*pi);
<span class="line"></span>        <span class="hljs-keyword">auto</span> sin_x = <span class="hljs-built_in">sin</span>(x);
<span class="line"></span>        <span class="hljs-keyword">auto</span> p_x = <span class="hljs-built_in">exp</span>(-x / (<span class="hljs-number">2</span>*pi)) * sin_x * sin_x;
<span class="line"></span>        sum += p_x;
<span class="line"></span>        <span class="hljs-comment">// store this sample</span>
<span class="line"></span>        sample this_sample = {x, p_x};
<span class="line"></span>        samples.<span class="hljs-built_in">push_back</span>(this_sample);
<span class="line"></span>    }
<span class="line"></span>
<span class="line"></span>    <span class="hljs-comment">// Sort the samples by x</span>
<span class="line"></span>    std::<span class="hljs-built_in">sort</span>(samples.<span class="hljs-built_in">begin</span>(), samples.<span class="hljs-built_in">end</span>(), compare_by_x);
<span class="line"></span>
<span class="line"></span>    <span class="hljs-comment">// Find out the sample at which we have half of our area</span>
<span class="line"></span>    <span class="hljs-type">double</span> half_sum = sum / <span class="hljs-number">2.0</span>;
<span class="line"></span>    <span class="hljs-type">double</span> halfway_point = <span class="hljs-number">0.0</span>;
<span class="line"></span>    <span class="hljs-type">double</span> accum = <span class="hljs-number">0.0</span>;
<span class="line"></span>    <span class="hljs-keyword">for</span> (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; N; i++){
<span class="line"></span>        accum += samples[i].p_x;
<span class="line"></span>        <span class="hljs-keyword">if</span> (accum &gt;= half_sum) {
<span class="line"></span>            halfway_point = samples[i].x;
<span class="line"></span>            <span class="hljs-keyword">break</span>;
<span class="line"></span>        }
<span class="line"></span>    }
<span class="line"></span>
<span class="line"></span>    std::cout &lt;&lt; std::fixed &lt;&lt; std::<span class="hljs-built_in">setprecision</span>(<span class="hljs-number">12</span>);
<span class="line"></span>    std::cout &lt;&lt; <span class="hljs-string">"Average = "</span> &lt;&lt; sum / N &lt;&lt; <span class="hljs-string">'\n'</span>;
<span class="line"></span>    std::cout &lt;&lt; <span class="hljs-string">"Area under curve = "</span> &lt;&lt; <span class="hljs-number">2</span> * pi * sum / N &lt;&lt; <span class="hljs-string">'\n'</span>;
<span class="line"></span>    std::cout &lt;&lt; <span class="hljs-string">"Halfway = "</span> &lt;&lt; halfway_point &lt;&lt; <span class="hljs-string">'\n'</span>;
<span class="line"></span>}</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_est-halfway">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;12:</b> <kbd>[estimate_halfway.cc]</kbd> Estimating the 50% point of a function</div></center>
<p>


</p></div>

<p></p><p>

</p><div class="together">
This code snippet isn't too different from what we had before. We're still solving for the sum over
an interval (0 to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-142-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1599" style="width: 1.036em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.83em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1600"><span class="mn" id="MathJax-Span-1601"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-1602"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-142">2\pi</script>). Only this time, we're also storing and sorting all of our samples by
their input and output. We use this to determine the point at which they subtotal half of the sum
across the entire interval. Once we know that our first <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-143-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1603" style="width: 0.261em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.209em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.21em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1604"><span class="mi" id="MathJax-Span-1605"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">j</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-143">j</script> samples sum up to half of the total sum,
we know that the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-144-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mtext&gt;th&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1606" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.88em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1607"><span class="mi" id="MathJax-Span-1608"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">j</span></span><span class="mtext" id="MathJax-Span-1609"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">h</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mtext>th</mtext></math></span></span><script type="math/tex" id="MathJax-Element-144">j\text{th}</script> <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-145-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1610" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1611"><span class="mi" id="MathJax-Span-1612"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-145">x</script> roughly corresponds to our halfway point:

<p></p><pre class="listing tilde"><code><span class="line"></span>Average = 0.314686555791
<span class="line"></span>Area under curve = 1.977233943713
<span class="line"></span>Halfway = 2.016002314977</code></pre><p>

</p></div>

<p></p><p>

If you solve for the integral from <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-146-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1613" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1614"><span class="mn" id="MathJax-Span-1615"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-146">0</script> to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-147-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2.016&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1616" style="width: 2.275em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.862em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.86em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1617"><span class="mn" id="MathJax-Span-1618"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">6</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2.016</mn></math></span></span><script type="math/tex" id="MathJax-Element-147">2.016</script> and from <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-148-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2.016&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1619" style="width: 2.275em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.862em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.86em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1620"><span class="mn" id="MathJax-Span-1621"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">6</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2.016</mn></math></span></span><script type="math/tex" id="MathJax-Element-148">2.016</script> to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-149-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1622" style="width: 1.036em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.83em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1623"><span class="mn" id="MathJax-Span-1624"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-1625"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-149">2\pi</script> you should get almost
exactly the same result for both.

</p><p>

We have a method of solving for the halfway point that splits a PDF in half. If we wanted to, we
could use this to create a nested binary partition of the PDF:

</p><p>

</p><ol start="1">
  <li class="number">Solve for halfway point of a PDF
</li>
  <li class="number">Recurse into lower half, repeat step 1
</li>
  <li class="number">Recurse into upper half, repeat step 1</li></ol>

<p></p><p>

Stopping at a reasonable depth, say 6–10. As you can imagine, this could be quite computationally
expensive. The computational bottleneck for the code above is probably sorting the samples. A naive
sorting algorithm can have an algorithmic complexity of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-150-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;n&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1626" style="width: 2.327em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.139em, 1001.91em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1627"><span class="texatom" id="MathJax-Span-1628"><span class="mrow" id="MathJax-Span-1629"><span class="mi" id="MathJax-Span-1630"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">O</span></span></span></span><span class="mo" id="MathJax-Span-1631"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="texatom" id="MathJax-Span-1632"><span class="mrow" id="MathJax-Span-1633"><span class="msubsup" id="MathJax-Span-1634"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-1635"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.218em; left: 0.416em;"><span class="mn" id="MathJax-Span-1636" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1637"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">O</mi></mrow><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi mathvariant="bold">n</mi><mn mathvariant="bold">2</mn></msup></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-150">\mathcal{O}(\mathbf{n^2})</script> time, which is
tremendously expensive. Fortunately, the sorting algorithm included in the standard library is
usually much closer to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-151-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;n&lt;/mi&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1638" style="width: 4.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.36em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1003.36em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1639"><span class="texatom" id="MathJax-Span-1640"><span class="mrow" id="MathJax-Span-1641"><span class="mi" id="MathJax-Span-1642"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">O</span></span></span></span><span class="mo" id="MathJax-Span-1643"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="texatom" id="MathJax-Span-1644"><span class="mrow" id="MathJax-Span-1645"><span class="mi" id="MathJax-Span-1646"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mi" id="MathJax-Span-1647" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">g</span></span><span class="mo" id="MathJax-Span-1648"></span><span class="texatom" id="MathJax-Span-1649" style="padding-left: 0.158em;"><span class="mrow" id="MathJax-Span-1650"></span></span><span class="mi" id="MathJax-Span-1651"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span></span></span><span class="mo" id="MathJax-Span-1652"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">O</mi></mrow><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">n</mi><mi>log</mi><mo>⁡</mo><mrow class="MJX-TeXAtom-ORD"></mrow><mi mathvariant="bold">n</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-151">\mathcal{O}(\mathbf{n\log{}n})</script> time, but this can still be quite expensive,
especially for millions or billions of samples. But this will produce decent nonuniform
distributions of nonuniform numbers. This divide and conquer method of producing nonuniform
distributions is used somewhat commonly in practice, although there are much more efficient means of
doing so than a simple binary partition. If you have an arbitrary function that you wish to use as
the PDF for a distribution, you'll want to research the <em class="underscore">Metropolis-Hastings Algorithm</em>.

</p>
<a class="target" name="approximatingdistributions">&nbsp;</a><a class="target" name="onedimensionalmontecarlointegration/approximatingdistributions">&nbsp;</a><a class="target" name="toc3.6">&nbsp;</a><h2>Approximating Distributions</h2>
<p>

This was a lot of math and work to build up a couple of notions. Let's return to our initial PDF.
For the intervals without an explicit probability, we assume the PDF to be zero. So for our example
from the beginning of the chapter, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-152-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1653" style="width: 3.308em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.74em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1002.74em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1654"><span class="mi" id="MathJax-Span-1655"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-1656"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1657"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1658"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-1659" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-1660" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-152">p(r) = 0</script>, for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-153-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2209;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1661" style="width: 3.773em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.102em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1003.1em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1662"><span class="mi" id="MathJax-Span-1663"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1664" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∉</span></span><span class="mo" id="MathJax-Span-1665" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">[</span></span><span class="mn" id="MathJax-Span-1666"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span class="mo" id="MathJax-Span-1667"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mn" id="MathJax-Span-1668" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mo" id="MathJax-Span-1669"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo>∉</mo><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-153">r \notin [0,2]</script>. We can rewrite our <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-154-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1670" style="width: 1.501em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.24em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1671"><span class="mi" id="MathJax-Span-1672"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-1673"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1674"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1675"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-154">p(r)</script> in
piecewise fashion:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-155-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;mtable columnalign=&quot;left left&quot; rowspacing=&quot;.2em&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;false&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo fence=&quot;true&quot; stretchy=&quot;true&quot; symmetric=&quot;true&quot;&gt;&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1676" style="width: 9.713em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.009em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(-0.204em, 1008.01em, 4.238em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1677"><span class="mi" id="MathJax-Span-1678"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-1679"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1680"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1681"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-1682" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mrow" id="MathJax-Span-1683" style="padding-left: 0.261em;"><span class="mo" id="MathJax-Span-1684"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">{</span></span><span class="mtable" id="MathJax-Span-1685"><span style="display: inline-block; position: relative; width: 4.961em; height: 0px; margin-right: 0.158em; margin-left: 0.158em;"><span style="position: absolute; clip: rect(2.637em, 1000.67em, 7.079em, -999.997em); top: -5.111em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -3.716em; left: 0em;"><span class="mtd" id="MathJax-Span-1686"><span class="mrow" id="MathJax-Span-1687"><span class="mn" id="MathJax-Span-1688"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(2.689em, 1000.67em, 4.755em, -999.997em); top: -3.975em; left: 0em;"><span class="mtd" id="MathJax-Span-1694"><span class="mrow" id="MathJax-Span-1695"><span class="mfrac" id="MathJax-Span-1696"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.139em, 1000.21em, 2.172em, -999.997em); top: -2.425em; left: 50%; margin-left: -0.101em;"><span class="mi" id="MathJax-Span-1697" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.31em, 2.172em, -999.997em); top: -1.392em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-1698" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.42em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.416em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -0.617em; left: 0em;"><span class="mtd" id="MathJax-Span-1706"><span class="mrow" id="MathJax-Span-1707"><span class="mn" id="MathJax-Span-1708"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.116em;"></span></span><span style="position: absolute; clip: rect(2.637em, 1003.31em, 7.079em, -999.997em); top: -5.111em; left: 1.655em;"><span style="display: inline-block; position: relative; width: 3.308em; height: 0px;"><span style="position: absolute; clip: rect(1.346em, 1001.81em, 2.637em, -999.997em); top: -3.768em; left: 0em;"><span class="mtd" id="MathJax-Span-1689"><span class="mrow" id="MathJax-Span-1690"><span class="mi" id="MathJax-Span-1691"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1692" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">&lt;</span></span><span class="mn" id="MathJax-Span-1693" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(1.346em, 1003.31em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mtd" id="MathJax-Span-1699"><span class="mrow" id="MathJax-Span-1700"><span class="mn" id="MathJax-Span-1701"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span class="mo" id="MathJax-Span-1702" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">≤</span></span><span class="mi" id="MathJax-Span-1703" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1704" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">≤</span></span><span class="mn" id="MathJax-Span-1705" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(1.346em, 1001.81em, 2.637em, -999.997em); top: -0.669em; left: 0em;"><span class="mtd" id="MathJax-Span-1709"><span class="mrow" id="MathJax-Span-1710"><span class="mn" id="MathJax-Span-1711"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mo" id="MathJax-Span-1712" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">&lt;</span></span><span class="mi" id="MathJax-Span-1713" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.116em;"></span></span></span></span><span class="mo" id="MathJax-Span-1714"></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.247em; border-left: 0px solid; width: 0px; height: 5.128em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>p</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo>{</mo><mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mtr><mtd><mn>0</mn></mtd><mtd><mi>r</mi><mo>&lt;</mo><mn>0</mn></mtd></mtr><mtr><mtd><mfrac><mi>r</mi><mn>2</mn></mfrac></mtd><mtd><mn>0</mn><mo>≤</mo><mi>r</mi><mo>≤</mo><mn>2</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>2</mn><mo>&lt;</mo><mi>r</mi></mtd></mtr></mtable><mo fence="true" stretchy="true" symmetric="true"></mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-155"> p(r)=\begin{cases}
            0           & r < 0           \\
            \frac{r}{2} & 0 \leq r \leq 2 \\
            0           & 2 < r           \\
       \end{cases}
    </script>

</p><p>

If you consider what we were trying to do in the previous section, a lot of math revolved around the
<em class="underscore">accumulated</em> area (or <em class="underscore">accumulated</em> probability) from zero. In the case of the function

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-156-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1715" style="width: 7.182em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.943em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.674em, 1005.94em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1716"><span class="mi" id="MathJax-Span-1717"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-1718"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1719"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-1720"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-1721" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="msubsup" id="MathJax-Span-1722" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.294em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-1723"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -4.543em; left: 0.364em;"><span class="texatom" id="MathJax-Span-1724"><span class="mrow" id="MathJax-Span-1725"><span class="mfrac" id="MathJax-Span-1726"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.036em, 1000.52em, 1.862em, -999.997em); top: -2.012em; left: 50%; margin-left: -0.256em;"><span class="mrow" id="MathJax-Span-1727"><span class="mo" id="MathJax-Span-1728" style="font-size: 50%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mi" id="MathJax-Span-1729" style="font-size: 50%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span><span style="display: inline-block; width: 0px; height: 1.604em;"></span></span><span style="position: absolute; clip: rect(1.036em, 1000.42em, 1.862em, -999.997em); top: -1.237em; left: 50%; margin-left: -0.204em;"><span class="mrow" id="MathJax-Span-1730"><span class="mn" id="MathJax-Span-1731" style="font-size: 50%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-1732" style="font-size: 50%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 1.604em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.62em, 1.242em, -999.997em); top: -1.237em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.622em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-1733"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mi" id="MathJax-Span-1734"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span class="msubsup" id="MathJax-Span-1735"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-1736"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.27em; left: 0.416em;"><span class="mn" id="MathJax-Span-1737" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-1738"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1739"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-1740"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 2.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mfrac><mrow><mo>−</mo><mi>x</mi></mrow><mrow><mn>2</mn><mi>π</mi></mrow></mfrac></mrow></msup><mi>s</mi><mi>i</mi><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-156"> f(x) = e^{\frac{-x}{2 \pi}} sin^2(x)  </script>

</p><p>

we cared about the accumulated probability from <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-157-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1741" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1742"><span class="mn" id="MathJax-Span-1743"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-157">0</script> to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-158-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1744" style="width: 1.036em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.83em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1745"><span class="mn" id="MathJax-Span-1746"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-1747"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-158">2\pi</script> (100%) and the accumulated probability
from <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-159-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1748" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1749"><span class="mn" id="MathJax-Span-1750"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-159">0</script> to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-160-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2.016&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1751" style="width: 2.275em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.862em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.86em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1752"><span class="mn" id="MathJax-Span-1753"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">6</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2.016</mn></math></span></span><script type="math/tex" id="MathJax-Element-160">2.016</script> (50%). We can generalize this to an important term, the <em class="underscore">Cumulative Distribution
Function</em> <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-161-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1754" style="width: 1.759em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.45em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1755"><span class="mi" id="MathJax-Span-1756"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span class="mo" id="MathJax-Span-1757"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1758"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-1759"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-161">P(x)</script> is defined as:

</p><p>

    <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Error" id="MathJax-Element-162-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x221E;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow></msubsup><mi>p</mi><mo stretchy="false">(</mo><msup><mi>x</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mi>d</mi><msup><mi>x</mi><mo>′</mo></msup></math></span></span><script type="math/tex; mode=display" id="MathJax-Element-162"> P(x) =  \int_{-\infty}^{x}  p(x') dx' </script>

</p><p>

Or,

</p><p>

    <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Error" id="MathJax-Element-163-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;area&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x221E;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>area</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">(</mo><msup><mi>x</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mo>,</mo><mo>−</mo><mi mathvariant="normal">∞</mi><mo>,</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex; mode=display" id="MathJax-Element-163"> P(x) = \operatorname{area}(p(x'), -\infty, x) </script>

</p><p>

Which is the amount of <em class="underscore">cumulative</em> probability from <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-164-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x221E;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1796" style="width: 1.655em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.346em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.35em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1797"><span class="mo" id="MathJax-Span-1798"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mi" id="MathJax-Span-1799"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∞</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>−</mo><mi mathvariant="normal">∞</mi></math></span></span><script type="math/tex" id="MathJax-Element-164">-\infty</script>. We rewrote the integral in terms of
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_Error" id="MathJax-Element-165-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-165">x'</script> instead of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-166-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1805" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1806"><span class="mi" id="MathJax-Span-1807"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-166">x</script> because of calculus rules, if you're not sure what it means, don't worry about
it, you can just treat it like it's the same. If we take the integration outlined above, we get the
piecewise <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-167-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1808" style="width: 1.604em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.294em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.29em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1809"><span class="mi" id="MathJax-Span-1810"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span class="mo" id="MathJax-Span-1811"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1812"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1813"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-167">P(r)</script>:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-168-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;mtable columnalign=&quot;left left&quot; rowspacing=&quot;.2em&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;false&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo fence=&quot;true&quot; stretchy=&quot;true&quot; symmetric=&quot;true&quot;&gt;&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1814" style="width: 9.972em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.215em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(-0.307em, 1008.22em, 4.341em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1815"><span class="mi" id="MathJax-Span-1816"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span class="mo" id="MathJax-Span-1817"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1818"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1819"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-1820" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mrow" id="MathJax-Span-1821" style="padding-left: 0.261em;"><span class="mo" id="MathJax-Span-1822"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">{</span></span><span class="mtable" id="MathJax-Span-1823"><span style="display: inline-block; position: relative; width: 5.116em; height: 0px; margin-right: 0.158em; margin-left: 0.158em;"><span style="position: absolute; clip: rect(2.74em, 1000.83em, 7.389em, -999.997em); top: -5.318em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -3.82em; left: 0em;"><span class="mtd" id="MathJax-Span-1824"><span class="mrow" id="MathJax-Span-1825"><span class="mn" id="MathJax-Span-1826"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(2.482em, 1000.83em, 4.755em, -999.997em); top: -3.871em; left: 0em;"><span class="mtd" id="MathJax-Span-1832"><span class="mrow" id="MathJax-Span-1833"><span class="mfrac" id="MathJax-Span-1834"><span style="display: inline-block; position: relative; width: 0.571em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(3.05em, 1000.47em, 4.29em, -999.997em); top: -4.543em; left: 50%; margin-left: -0.256em;"><span class="msubsup" id="MathJax-Span-1835"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(1.139em, 1000.21em, 2.172em, -999.997em); top: -1.857em; left: 0em;"><span class="mi" id="MathJax-Span-1836" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; top: -1.96em; left: 0.209em;"><span class="mn" id="MathJax-Span-1837" style="font-size: 50%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.604em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.31em, 2.172em, -999.997em); top: -1.392em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-1838" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">4</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.57em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.571em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -0.514em; left: 0em;"><span class="mtd" id="MathJax-Span-1846"><span class="mrow" id="MathJax-Span-1847"><span class="mn" id="MathJax-Span-1848"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.323em;"></span></span><span style="position: absolute; clip: rect(2.74em, 1003.31em, 7.389em, -999.997em); top: -5.318em; left: 1.81em;"><span style="display: inline-block; position: relative; width: 3.308em; height: 0px;"><span style="position: absolute; clip: rect(1.346em, 1001.81em, 2.637em, -999.997em); top: -3.871em; left: 0em;"><span class="mtd" id="MathJax-Span-1827"><span class="mrow" id="MathJax-Span-1828"><span class="mi" id="MathJax-Span-1829"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1830" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">&lt;</span></span><span class="mn" id="MathJax-Span-1831" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(1.346em, 1003.31em, 2.637em, -999.997em); top: -2.167em; left: 0em;"><span class="mtd" id="MathJax-Span-1839"><span class="mrow" id="MathJax-Span-1840"><span class="mn" id="MathJax-Span-1841"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span class="mo" id="MathJax-Span-1842" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">≤</span></span><span class="mi" id="MathJax-Span-1843" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1844" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">≤</span></span><span class="mn" id="MathJax-Span-1845" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(1.346em, 1001.81em, 2.637em, -999.997em); top: -0.566em; left: 0em;"><span class="mtd" id="MathJax-Span-1849"><span class="mrow" id="MathJax-Span-1850"><span class="mn" id="MathJax-Span-1851"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mo" id="MathJax-Span-1852" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">&lt;</span></span><span class="mi" id="MathJax-Span-1853" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.323em;"></span></span></span></span><span class="mo" id="MathJax-Span-1854"></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.372em; border-left: 0px solid; width: 0px; height: 5.378em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo>{</mo><mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mtr><mtd><mn>0</mn></mtd><mtd><mi>r</mi><mo>&lt;</mo><mn>0</mn></mtd></mtr><mtr><mtd><mfrac><msup><mi>r</mi><mn>2</mn></msup><mn>4</mn></mfrac></mtd><mtd><mn>0</mn><mo>≤</mo><mi>r</mi><mo>≤</mo><mn>2</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd><mn>2</mn><mo>&lt;</mo><mi>r</mi></mtd></mtr></mtable><mo fence="true" stretchy="true" symmetric="true"></mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-168"> P(r)=\begin{cases}
           0             & r < 0           \\
           \frac{r^2}{4} & 0 \leq r \leq 2 \\
           1             & 2 < r           \\
       \end{cases}
    </script>

</p><p>

The <em class="underscore">Probability Density Function</em> (PDF) is the probability function that explains how likely an
interval of numbers is to be chosen. The <em class="underscore">Cumulative Distribution Function</em> (CDF) is the
distribution function that explains how likely all numbers smaller than its input is to be chosen.
To go from the PDF to the CDF, you need to integrate from <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-169-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x221E;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1855" style="width: 1.655em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.346em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.35em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1856"><span class="mo" id="MathJax-Span-1857"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mi" id="MathJax-Span-1858"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∞</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>−</mo><mi mathvariant="normal">∞</mi></math></span></span><script type="math/tex" id="MathJax-Element-169">-\infty</script> to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-170-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1859" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1860"><span class="mi" id="MathJax-Span-1861"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-170">x</script>, but to go from the CDF
to the PDF, all you need to do is take the derivative:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-171-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1862" style="width: 6.149em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.065em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1005.07em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1863"><span class="mi" id="MathJax-Span-1864"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-1865"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1866"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-1867"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-1868" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-1869" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mi" id="MathJax-Span-1870"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.83em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.411em;"><span class="mrow" id="MathJax-Span-1871"><span class="mi" id="MathJax-Span-1872"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-1873"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.93em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.932em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mi" id="MathJax-Span-1874"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span class="mo" id="MathJax-Span-1875"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1876"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-1877"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mi>d</mi><mrow><mi>d</mi><mi>x</mi></mrow></mfrac><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-171"> p(x) = \frac{d}{dx}P(x) </script>

</p><p>

If we evaluate the CDF, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-172-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1878" style="width: 1.604em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.294em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.29em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1879"><span class="mi" id="MathJax-Span-1880"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span class="mo" id="MathJax-Span-1881"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1882"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1883"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-172">P(r)</script>, at <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-173-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1884" style="width: 2.947em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.43em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1002.43em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1885"><span class="mi" id="MathJax-Span-1886"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-1887" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-1888" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo>=</mo><mn>1.0</mn></math></span></span><script type="math/tex" id="MathJax-Element-173">r = 1.0</script>, we get:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-174-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1889" style="width: 4.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.877em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1003.88em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1890"><span class="mi" id="MathJax-Span-1891"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span class="mo" id="MathJax-Span-1892"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-1893"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span class="mo" id="MathJax-Span-1894"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-1895" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-1896" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-1897"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-1898"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">4</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.52em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.519em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo stretchy="false">(</mo><mn>1.0</mn><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mn>4</mn></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-174"> P(1.0) = \frac{1}{4} </script>

</p><p>

This says <em class="underscore">a random variable plucked from our PDF has a 25% chance of being 1 or lower</em>. We want a
function <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-175-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1899" style="width: 1.501em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.24em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1900"><span class="mi" id="MathJax-Span-1901"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-1902"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1903"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mo" id="MathJax-Span-1904"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-175">f(d)</script> that takes a uniform distribution between 0 and 1 (<em class="underscore">i.e</em> <code>f(random_double())</code>), and
returns a random value according to a distribution that has the CDF <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-176-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1905" style="width: 4.135em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.412em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.777em, 1003.41em, 3.05em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1906"><span class="mi" id="MathJax-Span-1907"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span class="mo" id="MathJax-Span-1908"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1909"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-1910"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-1911" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-1912" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(3.05em, 1000.57em, 4.29em, -999.997em); top: -4.543em; left: 50%; margin-left: -0.307em;"><span class="msubsup" id="MathJax-Span-1913"><span style="display: inline-block; position: relative; width: 0.571em; height: 0px;"><span style="position: absolute; clip: rect(1.139em, 1000.31em, 2.172em, -999.997em); top: -1.857em; left: 0em;"><span class="mi" id="MathJax-Span-1914" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; top: -1.96em; left: 0.313em;"><span class="mn" id="MathJax-Span-1915" style="font-size: 50%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.604em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.31em, 2.172em, -999.997em); top: -1.392em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-1916" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">4</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.67em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.674em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.809em; border-left: 0px solid; width: 0px; height: 2.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><msup><mi>x</mi><mn>2</mn></msup><mn>4</mn></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-176">P(x) = \frac{x^2}{4}</script>. We don’t
know yet know what the function <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-177-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1917" style="width: 1.501em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.24em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1918"><span class="mi" id="MathJax-Span-1919"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-1920"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1921"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mo" id="MathJax-Span-1922"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-177">f(d)</script> is analytically, but we do know that 25% of what it returns
should be less than 1.0, and 75% should be above 1.0. Likewise, we know that 50% of what it returns
should be less than <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-178-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msqrt&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msqrt&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1923" style="width: 1.449em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.191em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(-0.152em, 1001.19em, 1.346em, -999.997em); top: -0.979em; left: 0em;"><span class="mrow" id="MathJax-Span-1924"><span class="msqrt" id="MathJax-Span-1925"><span style="display: inline-block; position: relative; width: 1.191em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0.777em;"><span class="mrow" id="MathJax-Span-1926"><span class="mn" id="MathJax-Span-1927"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.984em, 1000.42em, 1.294em, -999.997em); top: -2.064em; left: 0.777em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 0.416em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span><span style="position: absolute; clip: rect(3.05em, 1000.78em, 4.341em, -999.997em); top: -4.13em; left: 0em;"><span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">√</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.984em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msqrt><mn>2</mn></msqrt></math></span></span><script type="math/tex" id="MathJax-Element-178">\sqrt{2}</script>, and 50% should be above <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-179-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msqrt&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msqrt&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1928" style="width: 1.449em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.191em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(-0.152em, 1001.19em, 1.346em, -999.997em); top: -0.979em; left: 0em;"><span class="mrow" id="MathJax-Span-1929"><span class="msqrt" id="MathJax-Span-1930"><span style="display: inline-block; position: relative; width: 1.191em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0.777em;"><span class="mrow" id="MathJax-Span-1931"><span class="mn" id="MathJax-Span-1932"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.984em, 1000.42em, 1.294em, -999.997em); top: -2.064em; left: 0.777em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 0.416em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span><span style="position: absolute; clip: rect(3.05em, 1000.78em, 4.341em, -999.997em); top: -4.13em; left: 0em;"><span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">√</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.984em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msqrt><mn>2</mn></msqrt></math></span></span><script type="math/tex" id="MathJax-Element-179">\sqrt{2}</script>. If <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-180-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1933" style="width: 1.501em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.24em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1934"><span class="mi" id="MathJax-Span-1935"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-1936"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1937"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mo" id="MathJax-Span-1938"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-180">f(d)</script> monotonically
increases, then we would expect <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-181-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0.25&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1939" style="width: 5.323em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.393em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1004.39em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1940"><span class="mi" id="MathJax-Span-1941"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-1942"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-1943"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">5</span></span><span class="mo" id="MathJax-Span-1944"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-1945" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-1946" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mn>0.25</mn><mo stretchy="false">)</mo><mo>=</mo><mn>1.0</mn></math></span></span><script type="math/tex" id="MathJax-Element-181">f(0.25) = 1.0</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-182-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0.5&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msqrt&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msqrt&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1947" style="width: 5.013em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.135em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.139em, 1004.13em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1948"><span class="mi" id="MathJax-Span-1949"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-1950"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-1951"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">5</span></span><span class="mo" id="MathJax-Span-1952"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-1953" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="msqrt" id="MathJax-Span-1954" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.191em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0.777em;"><span class="mrow" id="MathJax-Span-1955"><span class="mn" id="MathJax-Span-1956"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.984em, 1000.42em, 1.294em, -999.997em); top: -2.064em; left: 0.777em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 0.416em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span><span style="position: absolute; clip: rect(3.05em, 1000.78em, 4.341em, -999.997em); top: -4.13em; left: 0em;"><span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">√</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mn>0.5</mn><mo stretchy="false">)</mo><mo>=</mo><msqrt><mn>2</mn></msqrt></math></span></span><script type="math/tex" id="MathJax-Element-182">f(0.5) = \sqrt{2}</script>. This can be generalized to
figure out <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-183-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1957" style="width: 1.501em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.24em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-1958"><span class="mi" id="MathJax-Span-1959"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-1960"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1961"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mo" id="MathJax-Span-1962"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-183">f(d)</script> for every possible input:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-184-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1963" style="width: 4.6em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.773em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1003.77em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1964"><span class="mi" id="MathJax-Span-1965"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-1966"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1967"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span class="mo" id="MathJax-Span-1968"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-1969"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-1970"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-1971"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-1972" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-1973" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-184"> f(P(x)) = x </script>

</p><p>

Let's take some more samples:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-185-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0.0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1974" style="width: 4.341em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.567em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1003.57em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1975"><span class="mi" id="MathJax-Span-1976"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span class="mo" id="MathJax-Span-1977"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-1978"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span class="mo" id="MathJax-Span-1979"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-1980" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-1981" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo stretchy="false">(</mo><mn>0.0</mn><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-185"> P(0.0) = 0 </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-186-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0.5&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;16&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1982" style="width: 5.22em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.29em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1004.29em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1983"><span class="mi" id="MathJax-Span-1984"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span class="mo" id="MathJax-Span-1985"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-1986"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">5</span></span><span class="mo" id="MathJax-Span-1987"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-1988" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-1989" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-1990"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.83em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.411em;"><span class="mn" id="MathJax-Span-1991"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">6</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.93em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.932em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo stretchy="false">(</mo><mn>0.5</mn><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mn>16</mn></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-186"> P(0.5) = \frac{1}{16} </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-187-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1992" style="width: 4.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.877em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1003.88em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-1993"><span class="mi" id="MathJax-Span-1994"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span class="mo" id="MathJax-Span-1995"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-1996"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span class="mo" id="MathJax-Span-1997"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-1998" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-1999" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-2000"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-2001"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">4</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.52em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.519em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo stretchy="false">(</mo><mn>1.0</mn><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mn>4</mn></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-187"> P(1.0) = \frac{1}{4} </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-188-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1.5&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;mn&gt;16&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2002" style="width: 5.22em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.29em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1004.29em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2003"><span class="mi" id="MathJax-Span-2004"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span class="mo" id="MathJax-Span-2005"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-2006"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">5</span></span><span class="mo" id="MathJax-Span-2007"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2008" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-2009" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-2010"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">9</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.83em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.411em;"><span class="mn" id="MathJax-Span-2011"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">6</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.93em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.932em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo stretchy="false">(</mo><mn>1.5</mn><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>9</mn><mn>16</mn></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-188"> P(1.5) = \frac{9}{16} </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-189-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2012" style="width: 4.341em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.567em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1003.57em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2013"><span class="mi" id="MathJax-Span-2014"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span class="mo" id="MathJax-Span-2015"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-2016"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span class="mo" id="MathJax-Span-2017"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2018" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-2019" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo stretchy="false">(</mo><mn>2.0</mn><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-189"> P(2.0) = 1 </script>

</p><p>

so, the function <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-190-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2020" style="width: 1.036em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.83em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2021"><span class="mi" id="MathJax-Span-2022"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-2023"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mo" id="MathJax-Span-2024"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-190">f()</script> has values

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-191-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0.0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2025" style="width: 8.164em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.717em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1006.72em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2026"><span class="mi" id="MathJax-Span-2027"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-2028"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2029"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span class="mo" id="MathJax-Span-2030"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-2031"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span class="mo" id="MathJax-Span-2032"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2033"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2034" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-2035" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-2036"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-2037"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span class="mo" id="MathJax-Span-2038"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2039" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-2040" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">(</mo><mn>0.0</mn><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-191"> f(P(0.0)) = f(0) = 0 </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-192-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0.5&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;16&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.5&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2041" style="width: 9.765em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.06em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1008.06em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2042"><span class="mi" id="MathJax-Span-2043"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-2044"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2045"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span class="mo" id="MathJax-Span-2046"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-2047"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">5</span></span><span class="mo" id="MathJax-Span-2048"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2049"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2050" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-2051" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-2052"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mfrac" id="MathJax-Span-2053"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-2054"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.83em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.411em;"><span class="mn" id="MathJax-Span-2055"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">6</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.93em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.932em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mo" id="MathJax-Span-2056"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2057" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-2058" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">5</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">(</mo><mn>0.5</mn><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mfrac><mn>1</mn><mn>16</mn></mfrac><mo stretchy="false">)</mo><mo>=</mo><mn>0.5</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-192"> f(P(0.5)) = f(\frac{1}{16}) = 0.5 </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-193-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2059" style="width: 9.248em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.647em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1007.65em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2060"><span class="mi" id="MathJax-Span-2061"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-2062"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2063"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span class="mo" id="MathJax-Span-2064"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-2065"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span class="mo" id="MathJax-Span-2066"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2067"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2068" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-2069" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-2070"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mfrac" id="MathJax-Span-2071"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-2072"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-2073"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">4</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.52em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.519em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mo" id="MathJax-Span-2074"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2075" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-2076" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">(</mo><mn>1.0</mn><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mfrac><mn>1</mn><mn>4</mn></mfrac><mo stretchy="false">)</mo><mo>=</mo><mn>1.0</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-193"> f(P(1.0)) = f(\frac{1}{4}) = 1.0 </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-194-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1.5&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;mn&gt;16&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1.5&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2077" style="width: 9.765em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.06em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1008.06em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2078"><span class="mi" id="MathJax-Span-2079"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-2080"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2081"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span class="mo" id="MathJax-Span-2082"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-2083"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">5</span></span><span class="mo" id="MathJax-Span-2084"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2085"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2086" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-2087" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-2088"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mfrac" id="MathJax-Span-2089"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-2090"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">9</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.83em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.411em;"><span class="mn" id="MathJax-Span-2091"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">6</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.93em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.932em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mo" id="MathJax-Span-2092"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2093" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-2094" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">5</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">(</mo><mn>1.5</mn><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mfrac><mn>9</mn><mn>16</mn></mfrac><mo stretchy="false">)</mo><mo>=</mo><mn>1.5</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-194"> f(P(1.5)) = f(\frac{9}{16}) = 1.5 </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-195-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2095" style="width: 8.887em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.337em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1007.34em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2096"><span class="mi" id="MathJax-Span-2097"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-2098"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2099"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span class="mo" id="MathJax-Span-2100"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-2101"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span class="mo" id="MathJax-Span-2102"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2103"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2104" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-2105" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-2106"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-2107"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-2108"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2109" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-2110" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">(</mo><mn>2.0</mn><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mn>2.0</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-195"> f(P(2.0)) = f(1) = 2.0 </script>

</p><p>

We could use these intermediate values and interpolate between them to approximate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-196-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2111" style="width: 1.501em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.24em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2112"><span class="mi" id="MathJax-Span-2113"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-2114"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2115"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mo" id="MathJax-Span-2116"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-196">f(d)</script>:

</p><p>

    </p><center><div class="image" style=""><a href="./input_files/fig-3.08-approx-f.jpg" target="_blank"><img class="markdeep" src="./input_files/fig-3.08-approx-f.jpg"></a><center><span class="imagecaption"><a class="target" name="figure_approxf">&nbsp;</a><b style="font-style:normal;">Figure&nbsp;8:</b> Approximating the nonuniform f()</span></center></div></center>

<p></p><p>

If you can't solve for the PDF analytically, then you can't solve for the CDF analytically. After
all, the CDF is just the integral of the PDF. However, you can still create a distribution that
approximates the PDF. If you take a bunch of samples from the random function you want the PDF from,
you can approximate the PDF by getting a histogram of the samples and then converting to a PDF.
Alternatively, you can do as we did above and sort all of your samples.

</p><p>

Looking closer at the equality:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-197-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2117" style="width: 4.6em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.773em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1003.77em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2118"><span class="mi" id="MathJax-Span-2119"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-2120"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2121"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span class="mo" id="MathJax-Span-2122"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2123"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-2124"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2125"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2126" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-2127" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-197"> f(P(x)) = x </script>

</p><p>

That just means that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-198-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2128" style="width: 1.036em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.83em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2129"><span class="mi" id="MathJax-Span-2130"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-2131"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mo" id="MathJax-Span-2132"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-198">f()</script> just undoes whatever <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-199-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2133" style="width: 1.294em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.04em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2134"><span class="mi" id="MathJax-Span-2135"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span class="mo" id="MathJax-Span-2136"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mo" id="MathJax-Span-2137"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-199">P()</script> does. So, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-200-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2138" style="width: 1.036em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.83em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2139"><span class="mi" id="MathJax-Span-2140"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-2141"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mo" id="MathJax-Span-2142"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-200">f()</script> is the inverse function:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-201-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2143" style="width: 5.478em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.496em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.139em, 1004.5em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2144"><span class="mi" id="MathJax-Span-2145"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-2146"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2147"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mo" id="MathJax-Span-2148"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2149" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="msubsup" id="MathJax-Span-2150" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.191em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.47em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-2151"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.27em; left: 0.467em;"><span class="texatom" id="MathJax-Span-2152"><span class="mrow" id="MathJax-Span-2153"><span class="mo" id="MathJax-Span-2154" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mn" id="MathJax-Span-2155" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-2156"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2157"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-2158"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-201"> f(d) = P^{-1}(x) </script>

</p><p>

For our purposes, if we have PDF <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-202-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2159" style="width: 1.191em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.98em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2160"><span class="mi" id="MathJax-Span-2161"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-2162"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mo" id="MathJax-Span-2163"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-202">p()</script> and cumulative distribution function <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-203-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2164" style="width: 1.294em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.04em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2165"><span class="mi" id="MathJax-Span-2166"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span class="mo" id="MathJax-Span-2167"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mo" id="MathJax-Span-2168"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-203">P()</script>, we can use this
“inverse function” with a random number to get what we want:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-204-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;o&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x005F;&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;o&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;u&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;b&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2169" style="width: 11.934em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.868em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.139em, 1009.87em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2170"><span class="mi" id="MathJax-Span-2171"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-2172"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2173"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mo" id="MathJax-Span-2174"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2175" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="msubsup" id="MathJax-Span-2176" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.191em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.47em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-2177"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.27em; left: 0.467em;"><span class="texatom" id="MathJax-Span-2178"><span class="mrow" id="MathJax-Span-2179"><span class="mo" id="MathJax-Span-2180" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mn" id="MathJax-Span-2181" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-2182"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="texatom" id="MathJax-Span-2183"><span class="mrow" id="MathJax-Span-2184"><span class="mi" id="MathJax-Span-2185"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mi" id="MathJax-Span-2186"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mi" id="MathJax-Span-2187"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mi" id="MathJax-Span-2188"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-2189"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span class="mi" id="MathJax-Span-2190"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">m</span></span><span class="mi" id="MathJax-Span-2191"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">_</span></span><span class="mi" id="MathJax-Span-2192"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-2193"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span class="mi" id="MathJax-Span-2194"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">u</span></span><span class="mi" id="MathJax-Span-2195"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span></span><span class="mi" id="MathJax-Span-2196"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span></span><span class="mi" id="MathJax-Span-2197"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span></span></span><span class="mo" id="MathJax-Span-2198"></span><span class="mo" id="MathJax-Span-2199"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mo" id="MathJax-Span-2200"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2201"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">_</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi></mrow><mo>⁡</mo><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-204"> f(d) = P^{-1} (\operatorname{random\_double}()) </script>

</p><p>

For our PDF <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-205-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2202" style="width: 3.98em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.257em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1003.26em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2203"><span class="mi" id="MathJax-Span-2204"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-2205"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2206"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-2207"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2208" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-2209" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="texatom" id="MathJax-Span-2210"><span class="mrow" id="MathJax-Span-2211"><span class="mo" id="MathJax-Span-2212"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="mn" id="MathJax-Span-2213"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-205">p(r) = r/2</script>, and corresponding <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-206-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2214" style="width: 1.604em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.294em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.29em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2215"><span class="mi" id="MathJax-Span-2216"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span class="mo" id="MathJax-Span-2217"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2218"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-2219"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-206">P(r)</script>, we need to compute the inverse of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-207-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2220" style="width: 1.604em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.294em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.29em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2221"><span class="mi" id="MathJax-Span-2222"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span class="mo" id="MathJax-Span-2223"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2224"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-2225"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-207">P(r)</script>. If we
have

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-208-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2226" style="width: 2.998em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.482em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.519em, 1002.48em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2227"><span class="mi" id="MathJax-Span-2228"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">y</span></span><span class="mo" id="MathJax-Span-2229" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-2230" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(2.895em, 1000.62em, 4.341em, -999.997em); top: -4.646em; left: 50%; margin-left: -0.307em;"><span class="msubsup" id="MathJax-Span-2231"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-2232"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.218em; left: 0.261em;"><span class="mn" id="MathJax-Span-2233" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-2234"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">4</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.78em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.777em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.253em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>y</mi><mo>=</mo><mfrac><msup><mi>r</mi><mn>2</mn></msup><mn>4</mn></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-208"> y = \frac{r^2}{4} </script>

</p><p>

we get the inverse by solving for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-209-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2235" style="width: 0.313em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.261em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2236"><span class="mi" id="MathJax-Span-2237"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-209">r</script> in terms of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-210-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2238" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2239"><span class="mi" id="MathJax-Span-2240"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">y</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-210">y</script>:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-211-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msqrt&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msqrt&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2241" style="width: 3.618em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.998em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.087em, 1003em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2242"><span class="mi" id="MathJax-Span-2243"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-2244" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="msqrt" id="MathJax-Span-2245" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.604em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.83em, 2.585em, -999.997em); top: -2.218em; left: 0.777em;"><span class="mrow" id="MathJax-Span-2246"><span class="mn" id="MathJax-Span-2247"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">4</span></span><span class="mi" id="MathJax-Span-2248"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">y</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.984em, 1000.83em, 1.294em, -999.997em); top: -2.167em; left: 0.777em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 0.829em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span><span style="position: absolute; clip: rect(3.05em, 1000.78em, 4.341em, -999.997em); top: -4.181em; left: 0em;"><span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">√</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.628em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>r</mi><mo>=</mo><msqrt><mn>4</mn><mi>y</mi></msqrt></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-211"> r = \sqrt{4y} </script>

</p><p>

Which means the inverse of our CDF is defined as

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-212-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msup&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msqrt&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msqrt&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2249" style="width: 5.684em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.703em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.087em, 1004.7em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2250"><span class="msubsup" id="MathJax-Span-2251"><span style="display: inline-block; position: relative; width: 1.191em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.47em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-2252"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.27em; left: 0.467em;"><span class="texatom" id="MathJax-Span-2253"><span class="mrow" id="MathJax-Span-2254"><span class="mo" id="MathJax-Span-2255" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mn" id="MathJax-Span-2256" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-2257"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2258"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-2259"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2260" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="msqrt" id="MathJax-Span-2261" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.604em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.83em, 2.585em, -999.997em); top: -2.218em; left: 0.777em;"><span class="mrow" id="MathJax-Span-2262"><span class="mn" id="MathJax-Span-2263"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">4</span></span><span class="mi" id="MathJax-Span-2264"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">y</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.984em, 1000.83em, 1.294em, -999.997em); top: -2.167em; left: 0.777em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 0.829em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span><span style="position: absolute; clip: rect(3.05em, 1000.78em, 4.341em, -999.997em); top: -4.181em; left: 0em;"><span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">√</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.628em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><msqrt><mn>4</mn><mi>y</mi></msqrt></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-212"> P^{-1}(r) = \sqrt{4y} </script>

</p><p>

Thus our random number generator with density <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-213-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2265" style="width: 1.501em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.24em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2266"><span class="mi" id="MathJax-Span-2267"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-2268"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2269"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-2270"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-213">p(r)</script> can be created with:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-214-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msqrt&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;o&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x005F;&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;o&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;u&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;b&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/msqrt&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2271" style="width: 12.038em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.92em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.087em, 1009.92em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2272"><span class="mi" id="MathJax-Span-2273"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-2274"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2275"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mo" id="MathJax-Span-2276"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2277" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="msqrt" id="MathJax-Span-2278" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 7.596em; height: 0px;"><span style="position: absolute; clip: rect(1.346em, 1006.82em, 2.637em, -999.997em); top: -2.27em; left: 0.777em;"><span class="mrow" id="MathJax-Span-2279"><span class="mn" id="MathJax-Span-2280"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">4</span></span><span class="mo" id="MathJax-Span-2281" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="texatom" id="MathJax-Span-2282" style="padding-left: 0.209em;"><span class="mrow" id="MathJax-Span-2283"><span class="mi" id="MathJax-Span-2284"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mi" id="MathJax-Span-2285"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mi" id="MathJax-Span-2286"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mi" id="MathJax-Span-2287"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-2288"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span class="mi" id="MathJax-Span-2289"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">m</span></span><span class="mi" id="MathJax-Span-2290"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">_</span></span><span class="mi" id="MathJax-Span-2291"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-2292"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span class="mi" id="MathJax-Span-2293"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">u</span></span><span class="mi" id="MathJax-Span-2294"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span></span><span class="mi" id="MathJax-Span-2295"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span></span><span class="mi" id="MathJax-Span-2296"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span></span></span><span class="mo" id="MathJax-Span-2297"></span><span class="mo" id="MathJax-Span-2298"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mo" id="MathJax-Span-2299"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(0.984em, 1006.82em, 1.294em, -999.997em); top: -2.167em; left: 0.777em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 6.821em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span><span style="position: absolute; clip: rect(3.05em, 1000.78em, 4.341em, -999.997em); top: -4.181em; left: 0em;"><span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">√</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.628em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">)</mo><mo>=</mo><msqrt><mn>4</mn><mo>⋅</mo><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">_</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi></mrow><mo>⁡</mo><mo stretchy="false">(</mo><mo stretchy="false">)</mo></msqrt></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-214"> f(d) = \sqrt{4 \cdot \operatorname{random\_double}()} </script>

</p><p>

Note that this ranges from 0 to 2 as we hoped, and if we check our work, we replace
<code>random_double()</code> with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-215-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2300" style="width: 1.346em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.087em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.09em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2301"><span class="mn" id="MathJax-Span-2302"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="texatom" id="MathJax-Span-2303"><span class="mrow" id="MathJax-Span-2304"><span class="mo" id="MathJax-Span-2305"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="mn" id="MathJax-Span-2306"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">4</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>4</mn></math></span></span><script type="math/tex" id="MathJax-Element-215">1/4</script> to get 1, and also replace with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-216-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2307" style="width: 1.346em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.087em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.09em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2308"><span class="mn" id="MathJax-Span-2309"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="texatom" id="MathJax-Span-2310"><span class="mrow" id="MathJax-Span-2311"><span class="mo" id="MathJax-Span-2312"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="mn" id="MathJax-Span-2313"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-216">1/2</script> to get <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-217-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msqrt&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msqrt&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2314" style="width: 1.449em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.191em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(-0.152em, 1001.19em, 1.346em, -999.997em); top: -0.979em; left: 0em;"><span class="mrow" id="MathJax-Span-2315"><span class="msqrt" id="MathJax-Span-2316"><span style="display: inline-block; position: relative; width: 1.191em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0.777em;"><span class="mrow" id="MathJax-Span-2317"><span class="mn" id="MathJax-Span-2318"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.984em, 1000.42em, 1.294em, -999.997em); top: -2.064em; left: 0.777em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 0.416em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span><span style="position: absolute; clip: rect(3.05em, 1000.78em, 4.341em, -999.997em); top: -4.13em; left: 0em;"><span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">√</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.984em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msqrt><mn>2</mn></msqrt></math></span></span><script type="math/tex" id="MathJax-Element-217">\sqrt{2}</script>, just as
expected.

</p>
<a class="target" name="importancesampling">&nbsp;</a><a class="target" name="onedimensionalmontecarlointegration/importancesampling">&nbsp;</a><a class="target" name="toc3.7">&nbsp;</a><h2>Importance Sampling</h2>
<p>

You should now have a decent understanding of how to take an analytical PDF and generate a function
that produces random numbers with that distribution. We return to our original integral and try it
with a few different PDFs to get a better understanding:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-218-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2319" style="width: 4.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.877em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.087em, 1003.88em, 2.998em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2320"><span class="mi" id="MathJax-Span-2321"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">I</span></span><span class="mo" id="MathJax-Span-2322" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="msubsup" id="MathJax-Span-2323" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.637em, -999.997em); top: -2.218em; left: 0em;"><span class="mo" id="MathJax-Span-2324" style="vertical-align: -0.049em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∫</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -2.322em; left: 0.364em;"><span class="texatom" id="MathJax-Span-2325"><span class="mrow" id="MathJax-Span-2326"><span class="mn" id="MathJax-Span-2327" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -1.444em; left: 0.364em;"><span class="texatom" id="MathJax-Span-2328"><span class="mrow" id="MathJax-Span-2329"><span class="mn" id="MathJax-Span-2330" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2331" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-2332"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.27em; left: 0.416em;"><span class="mn" id="MathJax-Span-2333" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mi" id="MathJax-Span-2334"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-2335"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.747em; border-left: 0px solid; width: 0px; height: 2.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>I</mi><mo>=</mo><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msubsup><msup><mi>x</mi><mn>2</mn></msup><mi>d</mi><mi>x</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-218"> I = \int_{0}^{2} x^2 dx </script>

</p><p>

</p><div class="together">
The last time that we tried to solve for the integral we used a Monte Carlo approach, uniformly
sampling from the interval <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-219-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2336" style="width: 2.12em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.759em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1001.76em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2337"><span class="mo" id="MathJax-Span-2338"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">[</span></span><span class="mn" id="MathJax-Span-2339"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span class="mo" id="MathJax-Span-2340"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mn" id="MathJax-Span-2341" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mo" id="MathJax-Span-2342"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-219">[0, 2]</script>. We didn't know it at the time, but we were implicitly using a
uniform PDF between 0 and 2. This means that we're using a PDF = <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-220-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2343" style="width: 1.346em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.087em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.09em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2344"><span class="mn" id="MathJax-Span-2345"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="texatom" id="MathJax-Span-2346"><span class="mrow" id="MathJax-Span-2347"><span class="mo" id="MathJax-Span-2348"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="mn" id="MathJax-Span-2349"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-220">1/2</script> over the range <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-221-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2350" style="width: 2.12em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.759em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1001.76em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2351"><span class="mo" id="MathJax-Span-2352"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">[</span></span><span class="mn" id="MathJax-Span-2353"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span class="mo" id="MathJax-Span-2354"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mn" id="MathJax-Span-2355" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mo" id="MathJax-Span-2356"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-221">[0,2]</script>, which
means the CDF is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-222-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2357" style="width: 4.341em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.567em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1003.57em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2358"><span class="mi" id="MathJax-Span-2359"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span class="mo" id="MathJax-Span-2360"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2361"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-2362"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2363" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-2364" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="texatom" id="MathJax-Span-2365"><span class="mrow" id="MathJax-Span-2366"><span class="mo" id="MathJax-Span-2367"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="mn" id="MathJax-Span-2368"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-222">P(x) = x/2</script>, so <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-223-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2369" style="width: 3.825em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.153em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1003.15em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2370"><span class="mi" id="MathJax-Span-2371"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-2372"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2373"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mo" id="MathJax-Span-2374"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2375" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-2376" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-2377"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">)</mo><mo>=</mo><mn>2</mn><mi>d</mi></math></span></span><script type="math/tex" id="MathJax-Element-223">f(d) = 2d</script>. Knowing this, we can make this uniform PDF explicit:

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"rtweekend.h"</span></span>
<span class="line"></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iomanip&gt;</span></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;math.h&gt;</span></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span>
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span><span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">f</span><span class="hljs-params">(<span class="hljs-type">double</span> d)</span> </span>{
<span class="line"></span>    <span class="hljs-keyword">return</span> <span class="hljs-number">2.0</span> * d;
<span class="line"></span>}
<span class="line"></span>
<span class="line"></span><span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">pdf</span><span class="hljs-params">(<span class="hljs-type">double</span> x)</span> </span>{
<span class="line"></span>    <span class="hljs-keyword">return</span> <span class="hljs-number">0.5</span>;
<span class="line"></span>}</div><span class="line"></span>
<span class="line"></span><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
<span class="line"></span>    <span class="hljs-type">int</span> N = <span class="hljs-number">1000000</span>;
<span class="line"></span>    <span class="hljs-keyword">auto</span> sum = <span class="hljs-number">0.0</span>;
<span class="line"></span>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; N; i++) {<div class=" highlight"><span class="line"></span>        <span class="hljs-keyword">auto</span> x = <span class="hljs-built_in">f</span>(<span class="hljs-built_in">random_double</span>());
<span class="line"></span>        sum += x*x / <span class="hljs-built_in">pdf</span>(x);</div><span class="line"></span>    }
<span class="line"></span>    std::cout &lt;&lt; std::fixed &lt;&lt; std::<span class="hljs-built_in">setprecision</span>(<span class="hljs-number">12</span>);<div class=" highlight"><span class="line"></span>    std::cout &lt;&lt; <span class="hljs-string">"I = "</span> &lt;&lt; sum / N &lt;&lt; <span class="hljs-string">'\n'</span>;</div><span class="line"></span>}</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_integ-xsq-2">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;13:</b> <kbd>[integrate_x_sq.cc]</kbd> Explicit uniform PDF for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-224-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2378" style="width: 0.932em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(-0.101em, 1000.78em, 1.346em, -999.997em); top: -0.979em; left: 0em;"><span class="mrow" id="MathJax-Span-2379"><span class="msubsup" id="MathJax-Span-2380"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-2381"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.218em; left: 0.416em;"><span class="mn" id="MathJax-Span-2382" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.984em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-224">x^2</script></div></center>
<p>


</p></div>

<p></p><p>

There are a couple of important things to emphasize. Every value of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-225-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2383" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2384"><span class="mi" id="MathJax-Span-2385"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-225">x</script> represents one sample of the
function <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-226-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2386" style="width: 0.932em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(-0.101em, 1000.78em, 1.346em, -999.997em); top: -0.979em; left: 0em;"><span class="mrow" id="MathJax-Span-2387"><span class="msubsup" id="MathJax-Span-2388"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-2389"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.218em; left: 0.416em;"><span class="mn" id="MathJax-Span-2390" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.984em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-226">x^2</script> within the distribution <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-227-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2391" style="width: 2.12em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.759em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1001.76em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2392"><span class="mo" id="MathJax-Span-2393"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">[</span></span><span class="mn" id="MathJax-Span-2394"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span class="mo" id="MathJax-Span-2395"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mn" id="MathJax-Span-2396" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mo" id="MathJax-Span-2397"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-227">[0, 2]</script>. We use a function <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-228-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2398" style="width: 0.313em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.261em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2399"><span class="mi" id="MathJax-Span-2400"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-228">f</script> to randomly select samples
from within this distribution. We were previously multiplying the average over the interval
(<code>sum / N</code>) times the length of the interval (<code>b - a</code>) to arrive at the final answer. Here, we
don't need to multiply by the interval length—that is, we no longer need to multiply the average
by <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-229-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2401" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2402"><span class="mn" id="MathJax-Span-2403"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-229">2</script>.

</p><p>

We need to account for the nonuniformity of the PDF of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-230-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2404" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2405"><span class="mi" id="MathJax-Span-2406"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-230">x</script>. Failing to account for this
nonuniformity will introduce bias in our scene. Indeed, this bias is the source of our inaccurately
bright image—if we account for nonuniformity, we will get accurate results. The PDF will “steer”
samples toward specific parts of the distribution, which will cause us to converge faster, but at
the cost of introducing bias. To remove this bias, we need to down-weight where we sample more
frequently, and to up-weight where we sample less frequently. For our new nonuniform random number
generator, the PDF defines how much or how little we sample a specific portion.
So the weighting function should be proportional to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-231-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;p&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;d&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2407" style="width: 2.12em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.759em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.76em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2408"><span class="mn" id="MathJax-Span-2409"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="texatom" id="MathJax-Span-2410"><span class="mrow" id="MathJax-Span-2411"><span class="mo" id="MathJax-Span-2412"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="texatom" id="MathJax-Span-2413"><span class="mrow" id="MathJax-Span-2414"><span class="mi" id="MathJax-Span-2415"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mi" id="MathJax-Span-2416"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-2417"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">p</mi><mi class="MJX-tex-mathit" mathvariant="italic">d</mi><mi class="MJX-tex-mathit" mathvariant="italic">f</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-231">1/\mathit{pdf}</script>.
In fact it is <em class="underscore">exactly</em> <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-232-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;p&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;d&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2418" style="width: 2.12em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.759em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.76em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2419"><span class="mn" id="MathJax-Span-2420"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="texatom" id="MathJax-Span-2421"><span class="mrow" id="MathJax-Span-2422"><span class="mo" id="MathJax-Span-2423"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="texatom" id="MathJax-Span-2424"><span class="mrow" id="MathJax-Span-2425"><span class="mi" id="MathJax-Span-2426"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mi" id="MathJax-Span-2427"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-2428"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">p</mi><mi class="MJX-tex-mathit" mathvariant="italic">d</mi><mi class="MJX-tex-mathit" mathvariant="italic">f</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-232">1/\mathit{pdf}</script>.
This is why we divide <code>x*x</code> by <code>pdf(x)</code>.

</p><p>

We can try to solve for the integral using the linear PDF <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-233-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2429" style="width: 3.567em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.947em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.984em, 1002.95em, 3.05em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2430"><span class="mi" id="MathJax-Span-2431"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-2432"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2433"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-2434"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2435" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-2436" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.139em, 1000.21em, 2.172em, -999.997em); top: -2.425em; left: 50%; margin-left: -0.101em;"><span class="mi" id="MathJax-Span-2437" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.31em, 2.172em, -999.997em); top: -1.392em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-2438" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.42em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.416em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.809em; border-left: 0px solid; width: 0px; height: 2.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mi>r</mi><mn>2</mn></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-233">p(r) = \frac{r}{2}</script>, for which we were
able to solve for the CDF and its inverse. To do that, all we need to do is replace the functions
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-234-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msqrt&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msqrt&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2439" style="width: 3.618em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.998em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.139em, 1003em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2440"><span class="mi" id="MathJax-Span-2441"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-2442" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="msqrt" id="MathJax-Span-2443" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.604em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.83em, 2.585em, -999.997em); top: -2.218em; left: 0.777em;"><span class="mrow" id="MathJax-Span-2444"><span class="mn" id="MathJax-Span-2445"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">4</span></span><span class="mi" id="MathJax-Span-2446"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.984em, 1000.83em, 1.294em, -999.997em); top: -2.064em; left: 0.777em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 0.829em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span><span style="position: absolute; clip: rect(3.05em, 1000.78em, 4.341em, -999.997em); top: -4.13em; left: 0em;"><span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">√</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo>=</mo><msqrt><mn>4</mn><mi>d</mi></msqrt></math></span></span><script type="math/tex" id="MathJax-Element-234">f = \sqrt{4d}</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-235-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2447" style="width: 3.98em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.257em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1003.26em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2448"><span class="mi" id="MathJax-Span-2449"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mi" id="MathJax-Span-2450"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-2451"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-2452" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-2453" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="texatom" id="MathJax-Span-2454"><span class="mrow" id="MathJax-Span-2455"><span class="mo" id="MathJax-Span-2456"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="mn" id="MathJax-Span-2457"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mi>d</mi><mi>f</mi><mo>=</mo><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-235">pdf = x/2</script>.

</p><pre class="listing tilde"><code><div class=" highlight"><span class="line"></span><span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">f</span><span class="hljs-params">(<span class="hljs-type">double</span> d)</span> </span>{
<span class="line"></span>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">sqrt</span>(<span class="hljs-number">4.0</span> * d);
<span class="line"></span>}
<span class="line"></span>
<span class="line"></span><span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">pdf</span><span class="hljs-params">(<span class="hljs-type">double</span> x)</span> </span>{
<span class="line"></span>    <span class="hljs-keyword">return</span> x / <span class="hljs-number">2.0</span>;
<span class="line"></span>}</div><span class="line"></span>
<span class="line"></span><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
<span class="line"></span>    <span class="hljs-type">int</span> N = <span class="hljs-number">1000000</span>;
<span class="line"></span>    <span class="hljs-keyword">auto</span> sum = <span class="hljs-number">0.0</span>;
<span class="line"></span>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; N; i++) {
<span class="line"></span>        <span class="hljs-keyword">auto</span> x = <span class="hljs-built_in">f</span>(<span class="hljs-built_in">random_double</span>());
<span class="line"></span>        sum += x*x / <span class="hljs-built_in">pdf</span>(x);
<span class="line"></span>    }
<span class="line"></span>    std::cout &lt;&lt; std::fixed &lt;&lt; std::<span class="hljs-built_in">setprecision</span>(<span class="hljs-number">12</span>);
<span class="line"></span>    std::cout &lt;&lt; <span class="hljs-string">"I = "</span> &lt;&lt; sum / N &lt;&lt; <span class="hljs-string">'\n'</span>;
<span class="line"></span>}</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_integ-xsq-3">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;14:</b> <kbd>[integrate_x_sq.cc]</kbd> Integrating <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-236-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2458" style="width: 0.932em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(-0.101em, 1000.78em, 1.346em, -999.997em); top: -0.979em; left: 0em;"><span class="mrow" id="MathJax-Span-2459"><span class="msubsup" id="MathJax-Span-2460"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-2461"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.218em; left: 0.416em;"><span class="mn" id="MathJax-Span-2462" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.984em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-236">x^2</script> with linear PDF</div></center>
<p>


If you compared the runs from the uniform PDF and the linear PDF, you would have probably found that
the linear PDF converged faster. If you think about it, a linear PDF is probably a better
approximation for a quadratic function than a uniform PDF, so you would expect it to converge
faster. If that's the case, then we should just try to make the PDF match the integrand by turning
the PDF into a quadratic function:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-237-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;mtable columnalign=&quot;left left&quot; rowspacing=&quot;.2em&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;false&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo fence=&quot;true&quot; stretchy=&quot;true&quot; symmetric=&quot;true&quot;&gt;&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2463" style="width: 11.056em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.145em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.106em, 1009.14em, 3.928em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2464"><span class="mi" id="MathJax-Span-2465"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-2466"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2467"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-2468"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2469" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mrow" id="MathJax-Span-2470" style="padding-left: 0.261em;"><span class="mo" id="MathJax-Span-2471"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">{</span></span><span class="mtable" id="MathJax-Span-2472"><span style="display: inline-block; position: relative; width: 6.098em; height: 0px; margin-right: 0.158em; margin-left: 0.158em;"><span style="position: absolute; clip: rect(2.379em, 1001.81em, 6.201em, -999.997em); top: -4.543em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.81em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -3.458em; left: 0em;"><span class="mtd" id="MathJax-Span-2473"><span class="mrow" id="MathJax-Span-2474"><span class="mn" id="MathJax-Span-2475"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.191em, 1001.81em, 2.637em, -999.997em); top: -2.167em; left: 0em;"><span class="mtd" id="MathJax-Span-2481"><span class="mrow" id="MathJax-Span-2482"><span class="mi" id="MathJax-Span-2483"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span></span><span class="mo" id="MathJax-Span-2484" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="msubsup" id="MathJax-Span-2485" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-2486"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.218em; left: 0.261em;"><span class="mn" id="MathJax-Span-2487" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -0.927em; left: 0em;"><span class="mtd" id="MathJax-Span-2495"><span class="mrow" id="MathJax-Span-2496"><span class="mn" id="MathJax-Span-2497"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.548em;"></span></span><span style="position: absolute; clip: rect(2.379em, 1003.31em, 6.201em, -999.997em); top: -4.543em; left: 2.792em;"><span style="display: inline-block; position: relative; width: 3.308em; height: 0px;"><span style="position: absolute; clip: rect(1.346em, 1001.81em, 2.637em, -999.997em); top: -3.51em; left: 0em;"><span class="mtd" id="MathJax-Span-2476"><span class="mrow" id="MathJax-Span-2477"><span class="mi" id="MathJax-Span-2478"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-2479" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">&lt;</span></span><span class="mn" id="MathJax-Span-2480" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(1.346em, 1003.31em, 2.637em, -999.997em); top: -2.167em; left: 0em;"><span class="mtd" id="MathJax-Span-2488"><span class="mrow" id="MathJax-Span-2489"><span class="mn" id="MathJax-Span-2490"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span class="mo" id="MathJax-Span-2491" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">≤</span></span><span class="mi" id="MathJax-Span-2492" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-2493" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">≤</span></span><span class="mn" id="MathJax-Span-2494" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(1.346em, 1001.81em, 2.637em, -999.997em); top: -0.979em; left: 0em;"><span class="mtd" id="MathJax-Span-2498"><span class="mrow" id="MathJax-Span-2499"><span class="mn" id="MathJax-Span-2500"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mo" id="MathJax-Span-2501" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">&lt;</span></span><span class="mi" id="MathJax-Span-2502" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.548em;"></span></span></span></span><span class="mo" id="MathJax-Span-2503"></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.872em; border-left: 0px solid; width: 0px; height: 4.378em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>p</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo>{</mo><mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mtr><mtd><mn>0</mn></mtd><mtd><mi>r</mi><mo>&lt;</mo><mn>0</mn></mtd></mtr><mtr><mtd><mi>C</mi><mo>⋅</mo><msup><mi>r</mi><mn>2</mn></msup></mtd><mtd><mn>0</mn><mo>≤</mo><mi>r</mi><mo>≤</mo><mn>2</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>2</mn><mo>&lt;</mo><mi>r</mi></mtd></mtr></mtable><mo fence="true" stretchy="true" symmetric="true"></mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-237"> p(r)=\begin{cases}
            0           & r < 0           \\
            C \cdot r^2 & 0 \leq r \leq 2 \\
            0           & 2 < r           \\
       \end{cases}
    </script>

</p><p>

Like the linear PDF, we'll solve for the constant <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-238-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2504" style="width: 0.726em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.571em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.57em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2505"><span class="mi" id="MathJax-Span-2506"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-238">C</script> by integrating to 1 over the interval:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-239-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2507" style="width: 5.943em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.91em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.087em, 1004.91em, 2.998em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2508"><span class="mn" id="MathJax-Span-2509"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-2510" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="msubsup" id="MathJax-Span-2511" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.637em, -999.997em); top: -2.218em; left: 0em;"><span class="mo" id="MathJax-Span-2512" style="vertical-align: -0.049em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∫</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -2.322em; left: 0.364em;"><span class="texatom" id="MathJax-Span-2513"><span class="mrow" id="MathJax-Span-2514"><span class="mn" id="MathJax-Span-2515" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -1.444em; left: 0.364em;"><span class="texatom" id="MathJax-Span-2516"><span class="mrow" id="MathJax-Span-2517"><span class="mn" id="MathJax-Span-2518" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mi" id="MathJax-Span-2519" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span></span><span class="mo" id="MathJax-Span-2520" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="msubsup" id="MathJax-Span-2521" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-2522"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.27em; left: 0.261em;"><span class="mn" id="MathJax-Span-2523" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mi" id="MathJax-Span-2524"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-2525"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.747em; border-left: 0px solid; width: 0px; height: 2.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mn>1</mn><mo>=</mo><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msubsup><mi>C</mi><mo>⋅</mo><msup><mi>r</mi><mn>2</mn></msup><mi>d</mi><mi>r</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-239"> 1 = \int_{0}^{2} C \cdot r^2 dr </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-240-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2526" style="width: 5.168em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.238em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.087em, 1004.24em, 2.998em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2527"><span class="mo" id="MathJax-Span-2528"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-2529" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span></span><span class="mo" id="MathJax-Span-2530" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="msubsup" id="MathJax-Span-2531" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.637em, -999.997em); top: -2.218em; left: 0em;"><span class="mo" id="MathJax-Span-2532" style="vertical-align: -0.049em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∫</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -2.322em; left: 0.364em;"><span class="texatom" id="MathJax-Span-2533"><span class="mrow" id="MathJax-Span-2534"><span class="mn" id="MathJax-Span-2535" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -1.444em; left: 0.364em;"><span class="texatom" id="MathJax-Span-2536"><span class="mrow" id="MathJax-Span-2537"><span class="mn" id="MathJax-Span-2538" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2539" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-2540"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.27em; left: 0.261em;"><span class="mn" id="MathJax-Span-2541" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mi" id="MathJax-Span-2542"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-2543"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.747em; border-left: 0px solid; width: 0px; height: 2.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>=</mo><mi>C</mi><mo>⋅</mo><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msubsup><msup><mi>r</mi><mn>2</mn></msup><mi>d</mi><mi>r</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-240"> = C \cdot \int_{0}^{2} r^2 dr </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-241-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mfrac&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msup&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mfrac&gt;&lt;msubsup&gt;&lt;mstyle scriptlevel=&quot;0&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2544" style="width: 4.341em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.567em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.519em, 1003.57em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2545"><span class="mo" id="MathJax-Span-2546"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-2547" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span></span><span class="mo" id="MathJax-Span-2548" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mfrac" id="MathJax-Span-2549" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(2.895em, 1000.62em, 4.341em, -999.997em); top: -4.646em; left: 50%; margin-left: -0.307em;"><span class="msubsup" id="MathJax-Span-2550"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-2551"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.218em; left: 0.261em;"><span class="mn" id="MathJax-Span-2552" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">3</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-2553"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">3</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.78em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.777em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2554"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.16em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mstyle" id="MathJax-Span-2555"><span class="mrow" id="MathJax-Span-2556"><span class="texatom" id="MathJax-Span-2557"><span class="mrow" id="MathJax-Span-2558"><span class="mo" id="MathJax-Span-2559"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">|</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -2.373em; left: 0.158em;"><span class="texatom" id="MathJax-Span-2560"><span class="mrow" id="MathJax-Span-2561"><span class="mn" id="MathJax-Span-2562" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -1.495em; left: 0.158em;"><span class="texatom" id="MathJax-Span-2563"><span class="mrow" id="MathJax-Span-2564"><span class="mn" id="MathJax-Span-2565" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.253em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>=</mo><mi>C</mi><mo>⋅</mo><mfrac><msup><mi>r</mi><mn>3</mn></msup><mn>3</mn></mfrac><msubsup><mstyle scriptlevel="0"><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">|</mo></mrow></mstyle><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msubsup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-241"> = C \cdot \frac{r^3}{3} \Big|_{0}^{2} </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-242-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msup&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2566" style="width: 5.839em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.806em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.364em, 1004.81em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2567"><span class="mo" id="MathJax-Span-2568"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-2569" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span></span><span class="mo" id="MathJax-Span-2570"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mfrac" id="MathJax-Span-2571"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(2.74em, 1000.78em, 4.341em, -999.997em); top: -4.646em; left: 50%; margin-left: -0.411em;"><span class="msubsup" id="MathJax-Span-2572"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mn" id="MathJax-Span-2573"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.373em; left: 0.416em;"><span class="mn" id="MathJax-Span-2574" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">3</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-2575"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">3</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.93em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.932em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mo" id="MathJax-Span-2576" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mfrac" id="MathJax-Span-2577" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-2578"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-2579"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">3</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.52em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.519em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mo" id="MathJax-Span-2580"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.441em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>=</mo><mi>C</mi><mo stretchy="false">(</mo><mfrac><msup><mn>2</mn><mn>3</mn></msup><mn>3</mn></mfrac><mo>−</mo><mfrac><mn>0</mn><mn>3</mn></mfrac><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-242"> = C ( \frac{2^3}{3} - \frac{0}{3} ) </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-243-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2581" style="width: 2.895em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.379em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1002.38em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2582"><span class="mi" id="MathJax-Span-2583"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span></span><span class="mo" id="MathJax-Span-2584" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-2585" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-2586"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">3</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-2587"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">8</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.52em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.519em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>C</mi><mo>=</mo><mfrac><mn>3</mn><mn>8</mn></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-243"> C = \frac{3}{8} </script>

</p><p>

Which gives us:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-244-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;mtable columnalign=&quot;left left&quot; rowspacing=&quot;.2em&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;false&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;/mfrac&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo fence=&quot;true&quot; stretchy=&quot;true&quot; symmetric=&quot;true&quot;&gt;&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2588" style="width: 10.54em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.68em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(-0.204em, 1008.68em, 4.238em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2589"><span class="mi" id="MathJax-Span-2590"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-2591"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2592"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-2593"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2594" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mrow" id="MathJax-Span-2595" style="padding-left: 0.261em;"><span class="mo" id="MathJax-Span-2596"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">{</span></span><span class="mtable" id="MathJax-Span-2597"><span style="display: inline-block; position: relative; width: 5.633em; height: 0px; margin-right: 0.158em; margin-left: 0.158em;"><span style="position: absolute; clip: rect(2.637em, 1001.29em, 7.079em, -999.997em); top: -5.111em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.294em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -3.716em; left: 0em;"><span class="mtd" id="MathJax-Span-2598"><span class="mrow" id="MathJax-Span-2599"><span class="mn" id="MathJax-Span-2600"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(2.689em, 1001.29em, 4.755em, -999.997em); top: -3.975em; left: 0em;"><span class="mtd" id="MathJax-Span-2606"><span class="mrow" id="MathJax-Span-2607"><span class="mfrac" id="MathJax-Span-2608"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.139em, 1000.31em, 2.172em, -999.997em); top: -2.425em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-2609" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">3</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.31em, 2.172em, -999.997em); top: -1.392em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-2610" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">8</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.42em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.416em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2611"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-2612"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.218em; left: 0.261em;"><span class="mn" id="MathJax-Span-2613" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -0.617em; left: 0em;"><span class="mtd" id="MathJax-Span-2621"><span class="mrow" id="MathJax-Span-2622"><span class="mn" id="MathJax-Span-2623"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.116em;"></span></span><span style="position: absolute; clip: rect(2.637em, 1003.31em, 7.079em, -999.997em); top: -5.111em; left: 2.327em;"><span style="display: inline-block; position: relative; width: 3.308em; height: 0px;"><span style="position: absolute; clip: rect(1.346em, 1001.81em, 2.637em, -999.997em); top: -3.768em; left: 0em;"><span class="mtd" id="MathJax-Span-2601"><span class="mrow" id="MathJax-Span-2602"><span class="mi" id="MathJax-Span-2603"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-2604" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">&lt;</span></span><span class="mn" id="MathJax-Span-2605" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(1.346em, 1003.31em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mtd" id="MathJax-Span-2614"><span class="mrow" id="MathJax-Span-2615"><span class="mn" id="MathJax-Span-2616"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span class="mo" id="MathJax-Span-2617" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">≤</span></span><span class="mi" id="MathJax-Span-2618" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-2619" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">≤</span></span><span class="mn" id="MathJax-Span-2620" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(1.346em, 1001.81em, 2.637em, -999.997em); top: -0.669em; left: 0em;"><span class="mtd" id="MathJax-Span-2624"><span class="mrow" id="MathJax-Span-2625"><span class="mn" id="MathJax-Span-2626"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mo" id="MathJax-Span-2627" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">&lt;</span></span><span class="mi" id="MathJax-Span-2628" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.116em;"></span></span></span></span><span class="mo" id="MathJax-Span-2629"></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.247em; border-left: 0px solid; width: 0px; height: 5.128em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>p</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo>{</mo><mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mtr><mtd><mn>0</mn></mtd><mtd><mi>r</mi><mo>&lt;</mo><mn>0</mn></mtd></mtr><mtr><mtd><mfrac><mn>3</mn><mn>8</mn></mfrac><msup><mi>r</mi><mn>2</mn></msup></mtd><mtd><mn>0</mn><mo>≤</mo><mi>r</mi><mo>≤</mo><mn>2</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>2</mn><mo>&lt;</mo><mi>r</mi></mtd></mtr></mtable><mo fence="true" stretchy="true" symmetric="true"></mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-244"> p(r)=\begin{cases}
            0           & r < 0           \\
            \frac{3}{8} r^2 & 0 \leq r \leq 2 \\
            0           & 2 < r           \\
       \end{cases}
    </script>

</p><p>

And we get the corresponding CDF:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-245-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msup&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2630" style="width: 4.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.36em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.519em, 1003.36em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2631"><span class="mi" id="MathJax-Span-2632"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span class="mo" id="MathJax-Span-2633"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2634"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-2635"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2636" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-2637" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(2.895em, 1000.62em, 4.341em, -999.997em); top: -4.646em; left: 50%; margin-left: -0.307em;"><span class="msubsup" id="MathJax-Span-2638"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-2639"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.218em; left: 0.261em;"><span class="mn" id="MathJax-Span-2640" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">3</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-2641"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">8</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.78em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.777em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.253em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><msup><mi>r</mi><mn>3</mn></msup><mn>8</mn></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-245"> P(r) = \frac{r^3}{8} </script>

</p><p>

and

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-246-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msup&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;msup&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mfrac&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2642" style="width: 8.525em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.027em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.674em, 1007.03em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2643"><span class="msubsup" id="MathJax-Span-2644"><span style="display: inline-block; position: relative; width: 1.191em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.47em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-2645"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.27em; left: 0.467em;"><span class="texatom" id="MathJax-Span-2646"><span class="mrow" id="MathJax-Span-2647"><span class="mo" id="MathJax-Span-2648" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mn" id="MathJax-Span-2649" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-2650"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2651"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-2652"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2653" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-2654" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-2655"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2656"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mo" id="MathJax-Span-2657"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2658" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-2659" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">8</span></span><span class="msubsup" id="MathJax-Span-2660"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-2661"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -4.543em; left: 0.416em;"><span class="mfrac" id="MathJax-Span-2662"><span style="display: inline-block; position: relative; width: 0.313em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.036em, 1000.21em, 1.862em, -999.997em); top: -2.012em; left: 50%; margin-left: -0.101em;"><span class="mn" id="MathJax-Span-2663" style="font-size: 50%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.604em;"></span></span><span style="position: absolute; clip: rect(1.036em, 1000.21em, 1.862em, -999.997em); top: -1.237em; left: 50%; margin-left: -0.101em;"><span class="mn" id="MathJax-Span-2664" style="font-size: 50%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">3</span></span><span style="display: inline-block; width: 0px; height: 1.604em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.31em, 1.242em, -999.997em); top: -1.237em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.313em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 2.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">)</mo><mo>=</mo><mn>8</mn><msup><mi>d</mi><mfrac><mn>1</mn><mn>3</mn></mfrac></msup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-246"> P^{-1}(x) = f(d) = 8d^\frac{1}{3} </script>

</p><p>

</p><div class="together">
For just one sample we get:

<p></p><pre class="listing tilde"><code><div class=" highlight"><span class="line"></span><span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">f</span><span class="hljs-params">(<span class="hljs-type">double</span> d)</span> </span>{
<span class="line"></span>    <span class="hljs-keyword">return</span> <span class="hljs-number">8.0</span> * <span class="hljs-built_in">pow</span>(d, <span class="hljs-number">1.0</span>/<span class="hljs-number">3.0</span>);
<span class="line"></span>}
<span class="line"></span>
<span class="line"></span><span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">pdf</span><span class="hljs-params">(<span class="hljs-type">double</span> x)</span> </span>{
<span class="line"></span>    <span class="hljs-keyword">return</span> (<span class="hljs-number">3.0</span>/<span class="hljs-number">8.0</span>) * x*x;
<span class="line"></span>}</div><span class="line"></span>
<span class="line"></span><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{<div class=" highlight"><span class="line"></span>    <span class="hljs-type">int</span> N = <span class="hljs-number">1</span>;</div><span class="line"></span>    <span class="hljs-keyword">auto</span> sum = <span class="hljs-number">0.0</span>;
<span class="line"></span>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; N; i++) {
<span class="line"></span>        <span class="hljs-keyword">auto</span> x = <span class="hljs-built_in">f</span>(<span class="hljs-built_in">random_double</span>()));
<span class="line"></span>        sum += x*x / <span class="hljs-built_in">pdf</span>(x);
<span class="line"></span>    }
<span class="line"></span>    std::cout &lt;&lt; std::fixed &lt;&lt; std::<span class="hljs-built_in">setprecision</span>(<span class="hljs-number">12</span>);
<span class="line"></span>    std::cout &lt;&lt; <span class="hljs-string">"I = "</span> &lt;&lt; sum / N &lt;&lt; <span class="hljs-string">'\n'</span>;
<span class="line"></span>}</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_integ-xsq-5">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;15:</b> <kbd>[integrate_x_sq.cc]</kbd> Integrating <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-247-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2665" style="width: 0.932em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(-0.101em, 1000.78em, 1.346em, -999.997em); top: -0.979em; left: 0em;"><span class="mrow" id="MathJax-Span-2666"><span class="msubsup" id="MathJax-Span-2667"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-2668"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.218em; left: 0.416em;"><span class="mn" id="MathJax-Span-2669" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.984em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-247">x^2</script>, final version</div></center>
<p>


This always returns the exact answer. Which, honestly, feels a bit like magic.

</p><p>

</p></div>

<p></p><p>

A nonuniform PDF “steers” more samples to where the PDF is big, and fewer samples to where the PDF
is small. By this sampling, we would expect less noise in the places where the PDF is big and more
noise where the PDF is small. If we choose a PDF that is higher in the parts of the scene that have
higher noise, and is smaller in the parts of the scene that have lower noise, we'll be able to
reduce the total noise of the scene with fewer samples. This means that we will be able to converge
to the correct scene <em class="underscore">faster</em> than with a uniform PDF. In effect, we are steering our samples toward
the parts of the distribution that are more <em class="underscore">important</em>. This is why using a carefully chosen
nonuniform PDF is usually called <em class="underscore">importance sampling</em>.

</p><p>

In all of the examples given, we always converged to the correct answer of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-248-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2670" style="width: 1.346em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.087em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.09em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2671"><span class="mn" id="MathJax-Span-2672"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">8</span></span><span class="texatom" id="MathJax-Span-2673"><span class="mrow" id="MathJax-Span-2674"><span class="mo" id="MathJax-Span-2675"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="mn" id="MathJax-Span-2676"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">3</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>8</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>3</mn></math></span></span><script type="math/tex" id="MathJax-Element-248">8/3</script>. We got the same
answer when we used both a uniform PDF and the “correct” PDF (<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-249-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;msup&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2677" style="width: 6.201em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.116em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.674em, 1005.12em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2678"><span class="mi" id="MathJax-Span-2679"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span class="mo" id="MathJax-Span-2680"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span></span><span class="mi" id="MathJax-Span-2681" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span><span class="mo" id="MathJax-Span-2682"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span></span><span class="mi" id="MathJax-Span-2683" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-2684"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2685"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mo" id="MathJax-Span-2686"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2687" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-2688" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">8</span></span><span class="msubsup" id="MathJax-Span-2689"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-2690"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -4.543em; left: 0.416em;"><span class="texatom" id="MathJax-Span-2691"><span class="mrow" id="MathJax-Span-2692"><span class="mfrac" id="MathJax-Span-2693"><span style="display: inline-block; position: relative; width: 0.313em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.036em, 1000.21em, 1.862em, -999.997em); top: -2.012em; left: 50%; margin-left: -0.101em;"><span class="mn" id="MathJax-Span-2694" style="font-size: 50%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.604em;"></span></span><span style="position: absolute; clip: rect(1.036em, 1000.21em, 1.862em, -999.997em); top: -1.237em; left: 50%; margin-left: -0.101em;"><span class="mn" id="MathJax-Span-2695" style="font-size: 50%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">3</span></span><span style="display: inline-block; width: 0px; height: 1.604em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.31em, 1.242em, -999.997em); top: -1.237em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.313em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 2.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>.</mo><mi>e</mi><mo>.</mo><mi>f</mi><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">)</mo><mo>=</mo><mn>8</mn><msup><mi>d</mi><mrow class="MJX-TeXAtom-ORD"><mfrac><mn>1</mn><mn>3</mn></mfrac></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-249">i.e. f(d)=8d^{\frac{1}{3}}</script>). While
they both converged to the same answer, the uniform PDF took much longer. After all, we only needed
a single sample from the PDF that perfectly matched the integral. This should make sense, as we were
choosing to sample the important parts of the distribution more often, whereas the uniform PDF just
sampled the whole distribution equally, without taking importance into account.

</p><p>

Indeed, this is the case for any PDF that you create—they will all converge eventually. This is
just another part of the power of the Monte Carlo algorithm. Even the naive PDF where we solved for
the 50% value and split the distribution into two halves: <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-250-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msqrt&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msqrt&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2696" style="width: 3.102em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.534em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.139em, 1002.53em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2697"><span class="mo" id="MathJax-Span-2698"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">[</span></span><span class="mn" id="MathJax-Span-2699"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span class="mo" id="MathJax-Span-2700"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msqrt" id="MathJax-Span-2701" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.191em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0.777em;"><span class="mrow" id="MathJax-Span-2702"><span class="mn" id="MathJax-Span-2703"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.984em, 1000.42em, 1.294em, -999.997em); top: -2.064em; left: 0.777em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 0.416em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span><span style="position: absolute; clip: rect(3.05em, 1000.78em, 4.341em, -999.997em); top: -4.13em; left: 0em;"><span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">√</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2704"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><msqrt><mn>2</mn></msqrt><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-250">[0, \sqrt{2}]</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-251-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msqrt&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msqrt&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2705" style="width: 3.102em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.534em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.139em, 1002.53em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2706"><span class="mo" id="MathJax-Span-2707"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">[</span></span><span class="msqrt" id="MathJax-Span-2708"><span style="display: inline-block; position: relative; width: 1.191em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0.777em;"><span class="mrow" id="MathJax-Span-2709"><span class="mn" id="MathJax-Span-2710"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.984em, 1000.42em, 1.294em, -999.997em); top: -2.064em; left: 0.777em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 0.416em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span><span style="position: absolute; clip: rect(3.05em, 1000.78em, 4.341em, -999.997em); top: -4.13em; left: 0em;"><span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">√</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2711"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mn" id="MathJax-Span-2712" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mo" id="MathJax-Span-2713"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><msqrt><mn>2</mn></msqrt><mo>,</mo><mn>2</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-251">[\sqrt{2}, 2]</script>. That
PDF will converge. Hopefully you should have an intuition as to why that PDF will converge faster
than a pure uniform PDF, but slower than the linear PDF (<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-252-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msqrt&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msqrt&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2714" style="width: 6.408em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.271em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.139em, 1005.27em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2715"><span class="mi" id="MathJax-Span-2716"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span class="mo" id="MathJax-Span-2717"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span></span><span class="mi" id="MathJax-Span-2718" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span><span class="mo" id="MathJax-Span-2719"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">.</span></span><span class="mi" id="MathJax-Span-2720" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-2721"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2722"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mo" id="MathJax-Span-2723"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2724" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="msqrt" id="MathJax-Span-2725" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.604em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.83em, 2.585em, -999.997em); top: -2.218em; left: 0.777em;"><span class="mrow" id="MathJax-Span-2726"><span class="mn" id="MathJax-Span-2727"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">4</span></span><span class="mi" id="MathJax-Span-2728"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.984em, 1000.83em, 1.294em, -999.997em); top: -2.064em; left: 0.777em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 0.829em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span><span style="position: absolute; clip: rect(3.05em, 1000.78em, 4.341em, -999.997em); top: -4.13em; left: 0em;"><span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">√</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>.</mo><mi>e</mi><mo>.</mo><mi>f</mi><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">)</mo><mo>=</mo><msqrt><mn>4</mn><mi>d</mi></msqrt></math></span></span><script type="math/tex" id="MathJax-Element-252">i.e. f(d) = \sqrt{4d}</script>).

</p><p>

The perfect importance sampling is only possible when we already know the answer (we got <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-253-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2729" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.47em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2730"><span class="mi" id="MathJax-Span-2731"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">P</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-253">P</script> by
integrating <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-254-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2732" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2733"><span class="mi" id="MathJax-Span-2734"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-254">p</script> analytically), but it’s a good exercise to make sure our code works.

</p><p>

Let's review the main concepts that underlie Monte Carlo ray tracers:

</p><p>

</p><ol start="1">
  <li class="number">You have an integral of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-255-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2735" style="width: 1.501em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.24em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2736"><span class="mi" id="MathJax-Span-2737"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-2738"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2739"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-2740"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-255">f(x)</script> over some domain <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-256-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2741" style="width: 2.069em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.707em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1001.71em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2742"><span class="mo" id="MathJax-Span-2743"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">[</span></span><span class="mi" id="MathJax-Span-2744"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mo" id="MathJax-Span-2745"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-2746" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span></span><span class="mo" id="MathJax-Span-2747"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-256">[a,b]</script>
</li>
  <li class="number">You pick a PDF <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-257-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2748" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2749"><span class="mi" id="MathJax-Span-2750"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-257">p</script> that is non-zero and non-negative over <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-258-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2751" style="width: 2.069em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.707em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1001.71em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2752"><span class="mo" id="MathJax-Span-2753"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">[</span></span><span class="mi" id="MathJax-Span-2754"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mo" id="MathJax-Span-2755"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-2756" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span></span><span class="mo" id="MathJax-Span-2757"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-258">[a,b]</script>
</li>
  <li class="number">You average a whole ton of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-259-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2758" style="width: 1.449em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.191em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(-0.307em, 1001.19em, 1.759em, -999.997em); top: -0.979em; left: 0em;"><span class="mrow" id="MathJax-Span-2759"><span class="mfrac" id="MathJax-Span-2760"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.139em, 1000.78em, 2.172em, -999.997em); top: -2.425em; left: 50%; margin-left: -0.359em;"><span class="mrow" id="MathJax-Span-2761"><span class="mi" id="MathJax-Span-2762" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-2763" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2764" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-2765" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.88em, 2.172em, -999.997em); top: -1.392em; left: 50%; margin-left: -0.411em;"><span class="mrow" id="MathJax-Span-2766"><span class="mi" id="MathJax-Span-2767" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-2768" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2769" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-2770" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.98em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.984em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.984em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.809em; border-left: 0px solid; width: 0px; height: 2.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo></mrow><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-259">\frac{f(r)}{p(r)}</script> where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-260-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2771" style="width: 0.313em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.261em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2772"><span class="mi" id="MathJax-Span-2773"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-260">r</script> is a random number with PDF <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-261-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2774" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2775"><span class="mi" id="MathJax-Span-2776"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-261">p</script>.</li></ol>

<p></p><p>

Any choice of PDF <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-262-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2777" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2778"><span class="mi" id="MathJax-Span-2779"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-262">p</script> will always converge to the right answer, but the closer that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-263-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2780" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2781"><span class="mi" id="MathJax-Span-2782"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-263">p</script> approximates
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-264-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2783" style="width: 0.313em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.261em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2784"><span class="mi" id="MathJax-Span-2785"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-264">f</script>, the faster that it will converge.

</p>
<a class="target" name="montecarlointegrationonthesphereofdirections">&nbsp;</a><a class="target" name="montecarlointegrationonthesphereofdirections">&nbsp;</a><a class="target" name="toc4">&nbsp;</a><h1>Monte Carlo Integration on the Sphere of Directions</h1>
<p>

In chapter <a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#onedimensionalmontecarlointegration">One Dimensional Monte Carlo Integration</a> we started with uniform random numbers and
slowly, over the course of a chapter, built up more and more complicated ways of producing random
numbers, before ultimately arriving at the intuition of PDFs, and how to use them to generate random
numbers of arbitrary distribution.

</p><p>

All of the concepts covered in that chapter continue to work as we extend beyond a single dimension.
Moving forward, we might need to be able to select a point from a two, three, or even higher
dimensional space and then weight that selection by an arbitrary PDF. An important case of this—at
least for ray tracing—is producing a random direction. In the first two books we generated a random
direction by creating a random vector and rejecting it if it fell outside of the unit sphere. We
repeated this process until we found a random vector that fell inside the unit sphere. Normalizing
this vector produced points that lay exactly on the unit sphere and thereby represent a random
direction. This process of generating samples and rejecting them if they are not inside a desired
space is called <em class="underscore">the rejection method</em>, and is found all over the literature. The method covered
last chapter is referred to as <em class="underscore">the inversion method</em> because we invert a PDF.

</p><p>

Every direction in 3D space has an associated point on the unit sphere and can be generated by
solving for the vector that travels from the origin to that associated point. You can think of
choosing a random direction as choosing a random point in a constrained two dimensional plane: the
plane created by mapping the unit sphere to Cartesian coordinates. The same methodology as before
applies, but now we might have a PDF defined over two dimensions. Suppose we want to integrate this
function over the surface of the unit sphere:

</p><p>

  <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-265-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2786" style="width: 6.821em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.633em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.139em, 1005.63em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2787"><span class="mi" id="MathJax-Span-2788"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-2789"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2790"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-2791"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-2792" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ϕ</span></span><span class="mo" id="MathJax-Span-2793"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-2794" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-2795" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span></span><span class="mi" id="MathJax-Span-2796"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span class="msubsup" id="MathJax-Span-2797"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.31em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-2798"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.27em; left: 0.313em;"><span class="mn" id="MathJax-Span-2799" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-2800"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2801"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-2802"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo stretchy="false">(</mo><mi>θ</mi><mo>,</mo><mi>ϕ</mi><mo stretchy="false">)</mo><mo>=</mo><mi>c</mi><mi>o</mi><msup><mi>s</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-265"> f(\theta, \phi) = cos^2(\theta) </script>

</p><p>

Using Monte Carlo integration, we should just be able to sample <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-266-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2803" style="width: 4.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.877em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.984em, 1003.88em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2804"><span class="msubsup" id="MathJax-Span-2805"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1001.09em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-2806"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.373em; left: 1.087em;"><span class="mn" id="MathJax-Span-2807" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-2808"></span><span class="mo" id="MathJax-Span-2809"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2810"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-2811"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="texatom" id="MathJax-Span-2812"><span class="mrow" id="MathJax-Span-2813"><span class="mo" id="MathJax-Span-2814"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="mi" id="MathJax-Span-2815"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-2816"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2817"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-2818"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>cos</mi><mn>2</mn></msup><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>p</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-266">\cos^2(\theta) / p(r)</script>, where the
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-267-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2819" style="width: 1.501em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.24em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2820"><span class="mi" id="MathJax-Span-2821"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-2822"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2823"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-2824"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-267">p(r)</script> is now just <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-268-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2825" style="width: 4.755em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.928em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1003.93em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2826"><span class="mi" id="MathJax-Span-2827"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-2828"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2829"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-2830"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span class="mi" id="MathJax-Span-2831"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mi" id="MathJax-Span-2832"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span><span class="mi" id="MathJax-Span-2833"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span></span><span class="mi" id="MathJax-Span-2834"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span></span><span class="mi" id="MathJax-Span-2835"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span class="mi" id="MathJax-Span-2836"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span class="mi" id="MathJax-Span-2837"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mo" id="MathJax-Span-2838"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>d</mi><mi>i</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-268">p(direction)</script>. But what is <em class="underscore">direction</em> in that context? We could make it based
on polar coordinates, so <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-269-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2839" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2840"><span class="mi" id="MathJax-Span-2841"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-269">p</script> would be in terms of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-270-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2842" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2843"><span class="mi" id="MathJax-Span-2844"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-270">\theta</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-271-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2845" style="width: 0.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2846"><span class="mi" id="MathJax-Span-2847"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ϕ</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϕ</mi></math></span></span><script type="math/tex" id="MathJax-Element-271">\phi</script> for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-272-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2848" style="width: 2.792em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.275em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1002.27em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2849"><span class="mi" id="MathJax-Span-2850"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-2851"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2852"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-2853"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-2854" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ϕ</span></span><span class="mo" id="MathJax-Span-2855"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>θ</mi><mo>,</mo><mi>ϕ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-272">p(\theta, \phi)</script>. It
doesn't matter which coordinate system you choose to use. Although, however you choose to do it,
remember that a PDF must integrate to one over the whole surface and that the PDF represents the
<em class="underscore">relative probability</em> of that direction being sampled. Recall that we have a <code>vec3</code> function to
generate uniform random samples on the unit sphere (<code>random_unit_vector()</code>). What is the PDF of
these uniform samples? As a uniform density on the unit sphere, it is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-273-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;e&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2856" style="width: 2.43em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.017em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1002.02em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2857"><span class="mn" id="MathJax-Span-2858"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="texatom" id="MathJax-Span-2859"><span class="mrow" id="MathJax-Span-2860"><span class="mo" id="MathJax-Span-2861"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="texatom" id="MathJax-Span-2862"><span class="mrow" id="MathJax-Span-2863"><span class="mi" id="MathJax-Span-2864"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mi" id="MathJax-Span-2865"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mi" id="MathJax-Span-2866"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span><span class="mi" id="MathJax-Span-2867"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">e</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-273">1/\mathit{area}</script> of the
sphere, which is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-274-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2868" style="width: 2.43em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.017em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1002.02em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2869"><span class="mn" id="MathJax-Span-2870"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="texatom" id="MathJax-Span-2871"><span class="mrow" id="MathJax-Span-2872"><span class="mo" id="MathJax-Span-2873"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="mo" id="MathJax-Span-2874"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-2875"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">4</span></span><span class="mi" id="MathJax-Span-2876"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span class="mo" id="MathJax-Span-2877"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mo stretchy="false">(</mo><mn>4</mn><mi>π</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-274">1/(4\pi)</script>. If the integrand is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-275-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2878" style="width: 2.947em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.43em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.984em, 1002.43em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2879"><span class="msubsup" id="MathJax-Span-2880"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1001.09em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-2881"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.373em; left: 1.087em;"><span class="mn" id="MathJax-Span-2882" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-2883"></span><span class="mo" id="MathJax-Span-2884"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-2885"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-2886"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>cos</mi><mn>2</mn></msup><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-275">\cos^2(\theta)</script>, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-276-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2887" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2888"><span class="mi" id="MathJax-Span-2889"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-276">\theta</script> is the angle with
the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-277-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2890" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.364em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2891"><span class="mi" id="MathJax-Span-2892"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">z</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-277">z</script> axis:

</p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">f</span><span class="hljs-params">(<span class="hljs-type">const</span> vec3&amp; d)</span> </span>{
<span class="line"></span>    <span class="hljs-keyword">auto</span> cosine_squared = d.<span class="hljs-built_in">z</span>()*d.<span class="hljs-built_in">z</span>();
<span class="line"></span>    <span class="hljs-keyword">return</span> cosine_squared;
<span class="line"></span>}
<span class="line"></span>
<span class="line"></span><span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">pdf</span><span class="hljs-params">(<span class="hljs-type">const</span> vec3&amp; d)</span> </span>{
<span class="line"></span>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span> / (<span class="hljs-number">4</span>*pi);
<span class="line"></span>}
<span class="line"></span>
<span class="line"></span><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
<span class="line"></span>    <span class="hljs-type">int</span> N = <span class="hljs-number">1000000</span>;
<span class="line"></span>    <span class="hljs-keyword">auto</span> sum = <span class="hljs-number">0.0</span>;
<span class="line"></span>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; N; i++) {
<span class="line"></span>        vec3 d = <span class="hljs-built_in">random_unit_vector</span>();
<span class="line"></span>        <span class="hljs-keyword">auto</span> f_d = <span class="hljs-built_in">f</span>(d);
<span class="line"></span>        sum += f_d / <span class="hljs-built_in">pdf</span>(d);
<span class="line"></span>    }
<span class="line"></span>    std::cout &lt;&lt; std::fixed &lt;&lt; std::<span class="hljs-built_in">setprecision</span>(<span class="hljs-number">12</span>);
<span class="line"></span>    std::cout &lt;&lt; <span class="hljs-string">"I = "</span> &lt;&lt; sum / N &lt;&lt; <span class="hljs-string">'\n'</span>;
<span class="line"></span>}</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_main-sphereimp">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;16:</b> <kbd>[sphere_importance.cc]</kbd>
        Generating importance-sampled points on the unit sphere
    </div></center>
<p>


The analytic answer is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-278-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2893" style="width: 1.294em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.932em, 1001.04em, 2.998em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2894"><span class="mfrac" id="MathJax-Span-2895"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.139em, 1000.31em, 2.172em, -999.997em); top: -2.425em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-2896" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">4</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.31em, 2.172em, -999.997em); top: -1.392em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-2897" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">3</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.42em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.416em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mi" id="MathJax-Span-2898"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.809em; border-left: 0px solid; width: 0px; height: 2.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mn>4</mn><mn>3</mn></mfrac><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-278">\frac{4}{3} \pi</script> — if you remember enough advanced calc, check me! And the
code above produces that. The key point here is that all of the integrals and the probability and
everything else is over the unit sphere. The way to represent a single direction in 3D is its
associated point on the unit sphere. The way to represent a range of directions in 3D is the amount
of area on the unit sphere that those directions travel through. Call it direction, area, or <em class="underscore">solid
angle</em> — it’s all the same thing. Solid angle is the term that you'll usually find in the
literature. You have radians (r) in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-279-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2899" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2900"><span class="mi" id="MathJax-Span-2901"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-279">\theta</script> over one dimension, and you have <em class="underscore">steradians</em> (sr) in
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-280-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2902" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2903"><span class="mi" id="MathJax-Span-2904"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-280">\theta</script> <em class="underscore">and</em> <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-281-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2905" style="width: 0.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2906"><span class="mi" id="MathJax-Span-2907"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ϕ</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϕ</mi></math></span></span><script type="math/tex" id="MathJax-Element-281">\phi</script> over two dimensions (the unit sphere is a three dimensional object, but its
surface is only two dimensional). Solid Angle is just the two dimensional extension of angles. If
you are comfortable with a two dimensional angle, great! If not, do what I do and imagine the area
on the unit sphere that a set of directions goes through. The solid angle <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-282-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2908" style="width: 0.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2909"><span class="mi" id="MathJax-Span-2910"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ω</mi></math></span></span><script type="math/tex" id="MathJax-Element-282">\omega</script> and the projected
area <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-283-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2911" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.62em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2912"><span class="mi" id="MathJax-Span-2913"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">A</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-283">A</script> on the unit sphere are the same thing.

</p><p>

  </p><center><div class="image" style=""><a href="./input_files/fig-3.09-solid-angle.jpg" target="_blank"><img class="markdeep" src="./input_files/fig-3.09-solid-angle.jpg"></a><center><span class="imagecaption"><a class="target" name="figure_solid-angle">&nbsp;</a><b style="font-style:normal;">Figure&nbsp;9:</b> Solid angle / projected area of a sphere
  </span></center></div></center>

<p></p><p>

Now let’s go on to the light transport equation we are solving.

</p>
<a class="target" name="lightscattering">&nbsp;</a><a class="target" name="lightscattering">&nbsp;</a><a class="target" name="toc5">&nbsp;</a><h1>Light Scattering</h1>
<p>

In this chapter we won't actually program anything. We'll just be setting up for a big lighting
change in the next chapter. Our ray tracing program from the first two books scatters a ray when it
interacts with a surface or a volume. Ray scattering is the most commonly used model for simulating
light propagation through a scene. This can naturally be modeled probabilistically. There are many
things to consider when modeling the probabilistic scattering of rays.

</p>
<a class="target" name="albedo">&nbsp;</a><a class="target" name="lightscattering/albedo">&nbsp;</a><a class="target" name="toc5.1">&nbsp;</a><h2>Albedo</h2>
<p>

First, is the light absorbed?

</p><p>

Probability of light being scattered: <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-284-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2914" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.62em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2915"><span class="mi" id="MathJax-Span-2916"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">A</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-284">A</script>

</p><p>

Probability of light being absorbed: <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-285-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2917" style="width: 2.43em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.017em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1002.02em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2918"><span class="mn" id="MathJax-Span-2919"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-2920" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mi" id="MathJax-Span-2921" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">A</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>−</mo><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-285">1-A</script>

</p><p>

Where here <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-286-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2922" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.62em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2923"><span class="mi" id="MathJax-Span-2924"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">A</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-286">A</script> stands for <em class="underscore">albedo</em>. As covered in our first book, recall that albedo is a form of
fractional reflectance. It can help to stop and remember that when we simulate light propagation,
all we're doing is simulating the movement of photons through a space. If you remember your high
school Physics then you should recall that every photon has a unique energy and wavelength
associated by the Planck constant:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-287-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2925" style="width: 3.257em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.689em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1002.69em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2926"><span class="mi" id="MathJax-Span-2927"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">E</span></span><span class="mo" id="MathJax-Span-2928" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-2929" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.78em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.359em;"><span class="mrow" id="MathJax-Span-2930"><span class="mi" id="MathJax-Span-2931"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">h</span></span><span class="mi" id="MathJax-Span-2932"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mi" id="MathJax-Span-2933"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">λ</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.88em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.881em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>E</mi><mo>=</mo><mfrac><mrow><mi>h</mi><mi>c</mi></mrow><mi>λ</mi></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-287"> E = \frac{hc}{\lambda} </script>

</p><p>

Each individual photon has a <em class="underscore">tiny</em> amount of energy, but when you add enough of them up you get all
of the illumination in your rendering. The absorption or scattering of a photon with a surface or a
volume (or really anything that a photon can interact with) is probabilistically determined by the
albedo of the object. Albedo can depend on color because some objects are more likely to absorb some
wavelengths.

</p><p>

In most physically based renderers, we would use a predefined set of specific wavelengths for the
light color rather than RGB. As an example, we would replace our <em class="underscore">tristimulus</em> RGB renderer with
something that specifically samples at 300nm, 350nm, 400nm, ..., 700nm. We can extend our intuition
by thinking of R, G, and B as specific algebraic mixtures of wavelengths where R is <em class="underscore">mostly</em> red
wavelengths, G is <em class="underscore">mostly</em> green wavelengths, and B is <em class="underscore">mostly</em> blue wavelengths. This is an
approximation of the human visual system which has 3 unique sets of color receptors, called <em class="underscore">cones</em>,
that are each sensitive to different algebraic mixtures of wavelengths, roughly RGB, but are
referred to as long, medium, and short cones (the names are in reference to the wavelengths that
each cone is sensitive to, not the length of the cone). Just as colors can be represented by their
strength in the RGB color space, colors can also be represented by how excited each set of cones is
in the <em class="underscore">LMS color space</em> (long, medium, short).

</p>
<a class="target" name="scattering">&nbsp;</a><a class="target" name="lightscattering/scattering">&nbsp;</a><a class="target" name="toc5.2">&nbsp;</a><h2>Scattering</h2>
<p>

If the light does scatter, it will have a directional distribution that we can describe as a PDF
over solid angle. I will refer to this as its <em class="underscore">scattering PDF</em>: <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-288-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;pScatter&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2934" style="width: 3.98em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.257em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1003.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2935"><span class="mi" id="MathJax-Span-2936"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">S</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-2937"></span><span class="mo" id="MathJax-Span-2938"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mo" id="MathJax-Span-2939"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>pScatter</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-288">\operatorname{pScatter}()</script>. The
scattering PDF will vary with outgoing direction: <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-289-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;pScatter&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2940" style="width: 5.013em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.135em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1004.13em, 2.74em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2941"><span class="mi" id="MathJax-Span-2942"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">S</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-2943"></span><span class="mo" id="MathJax-Span-2944"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-2945"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-2946"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-2947" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-2948"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>pScatter</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>ω</mi><mi>o</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-289">\operatorname{pScatter}(\omega_o)</script>. The
scattering PDF can also vary with <em class="underscore">incident direction</em>:
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-290-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;pScatter&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2949" style="width: 6.408em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.271em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1005.27em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2950"><span class="mi" id="MathJax-Span-2951"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">S</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-2952"></span><span class="mo" id="MathJax-Span-2953"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-2954"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-2955"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-2956" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-2957"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-2958" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-2959"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-2960" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-2961"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>pScatter</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>ω</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ω</mi><mi>o</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-290">\operatorname{pScatter}(\omega_i, \omega_o)</script>. You can see this varying with incident direction when
you look at reflections off a road — they become mirror-like as your viewing angle (incident angle)
approaches grazing. The scattering PDF can vary with the wavelength of the light:
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-291-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;pScatter&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2962" style="width: 7.337em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.046em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1006.05em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2963"><span class="mi" id="MathJax-Span-2964"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">S</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-2965"></span><span class="mo" id="MathJax-Span-2966"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-2967"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-2968"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-2969" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-2970"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-2971" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-2972"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-2973" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-2974"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-2975" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">λ</span></span><span class="mo" id="MathJax-Span-2976"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>pScatter</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>ω</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ω</mi><mi>o</mi></msub><mo>,</mo><mi>λ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-291">\operatorname{pScatter}(\omega_i, \omega_o, \lambda)</script>. A good example of this is a prism refracting
white light into a rainbow. Lastly, the scattering PDF can also depend on the scattering position:
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-292-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;pScatter&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2977" style="width: 8.267em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.821em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1006.82em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2978"><span class="mi" id="MathJax-Span-2979"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">S</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-2980"></span><span class="mo" id="MathJax-Span-2981"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="texatom" id="MathJax-Span-2982"><span class="mrow" id="MathJax-Span-2983"><span class="mi" id="MathJax-Span-2984"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span class="mo" id="MathJax-Span-2985"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-2986" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-2987"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-2988" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-2989"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-2990" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-2991"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-2992" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-2993"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-2994" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">λ</span></span><span class="mo" id="MathJax-Span-2995"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>pScatter</mi><mo>⁡</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><msub><mi>ω</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ω</mi><mi>o</mi></msub><mo>,</mo><mi>λ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-292">\operatorname{pScatter}(\mathbf{x}, \omega_i, \omega_o, \lambda)</script>. The <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-293-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2996" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-2997"><span class="texatom" id="MathJax-Span-2998"><span class="mrow" id="MathJax-Span-2999"><span class="mi" id="MathJax-Span-3000"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-293">\mathbf{x}</script> is just math
notation for the scattering position: <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-294-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3001" style="width: 4.806em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.98em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1003.98em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-3002"><span class="texatom" id="MathJax-Span-3003"><span class="mrow" id="MathJax-Span-3004"><span class="mi" id="MathJax-Span-3005"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span class="mo" id="MathJax-Span-3006" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mo" id="MathJax-Span-3007" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-3008"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-3009"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-3010" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">y</span></span><span class="mo" id="MathJax-Span-3011"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-3012" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">z</span></span><span class="mo" id="MathJax-Span-3013"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>=</mo><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-294">\mathbf{x} = (x, y, z)</script>. The albedo of an object can also
depend on these quantities: <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-295-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3014" style="width: 5.684em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.703em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1004.7em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-3015"><span class="mi" id="MathJax-Span-3016"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">A</span></span><span class="mo" id="MathJax-Span-3017"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="texatom" id="MathJax-Span-3018"><span class="mrow" id="MathJax-Span-3019"><span class="mi" id="MathJax-Span-3020"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span class="mo" id="MathJax-Span-3021"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-3022" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3023"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3024" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3025"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-3026" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3027"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3028" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3029"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-3030" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">λ</span></span><span class="mo" id="MathJax-Span-3031"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><msub><mi>ω</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ω</mi><mi>o</mi></msub><mo>,</mo><mi>λ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-295">A(\mathbf{x}, \omega_i, \omega_o, \lambda)</script>.

</p><p>

The color of a surface is found by integrating these terms over the unit hemisphere by the incident
direction:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-296-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;Color&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;pScatter&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Color&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3032" style="width: 30.529em; display: inline-block;"><span style="display: inline-block; position: relative; width: 25.209em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1025.21em, 2.998em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-3033"><span class="msubsup" id="MathJax-Span-3034"><span style="display: inline-block; position: relative; width: 2.275em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1001.91em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3035"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.599em; left: 1.914em;"><span class="mi" id="MathJax-Span-3036" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3037"></span><span class="mo" id="MathJax-Span-3038"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="texatom" id="MathJax-Span-3039"><span class="mrow" id="MathJax-Span-3040"><span class="mi" id="MathJax-Span-3041"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span class="mo" id="MathJax-Span-3042"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-3043" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3044"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3045" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3046"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-3047" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">λ</span></span><span class="mo" id="MathJax-Span-3048"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-3049" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="msubsup" id="MathJax-Span-3050" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.637em, -999.997em); top: -2.218em; left: 0em;"><span class="mo" id="MathJax-Span-3051" style="vertical-align: -0.049em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∫</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -3.665em; left: 0.364em;"><span class="texatom" id="MathJax-Span-3052"><span class="mrow" id="MathJax-Span-3053"><span class="msubsup" id="MathJax-Span-3054"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px;"><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -1.857em; left: 0em;"><span class="mi" id="MathJax-Span-3055" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; top: -1.444em; left: 0.364em;"><span class="mi" id="MathJax-Span-3056" style="font-size: 50%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.604em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-3057" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">A</span></span><span class="mo" id="MathJax-Span-3058"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="texatom" id="MathJax-Span-3059"><span class="mrow" id="MathJax-Span-3060"><span class="mi" id="MathJax-Span-3061"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span class="mo" id="MathJax-Span-3062"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-3063" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3064"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3065" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3066"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-3067" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3068"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3069" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3070"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-3071" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">λ</span></span><span class="mo" id="MathJax-Span-3072"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-3073" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mi" id="MathJax-Span-3074" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">S</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-3075"></span><span class="mo" id="MathJax-Span-3076"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="texatom" id="MathJax-Span-3077"><span class="mrow" id="MathJax-Span-3078"><span class="mi" id="MathJax-Span-3079"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span class="mo" id="MathJax-Span-3080"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-3081" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3082"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3083" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3084"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-3085" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3086"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3087" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3088"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-3089" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">λ</span></span><span class="mo" id="MathJax-Span-3090"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-3091" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="msubsup" id="MathJax-Span-3092" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 2.12em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1001.91em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3093"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.599em; left: 1.914em;"><span class="mi" id="MathJax-Span-3094" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3095"></span><span class="mo" id="MathJax-Span-3096"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="texatom" id="MathJax-Span-3097"><span class="mrow" id="MathJax-Span-3098"><span class="mi" id="MathJax-Span-3099"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span class="mo" id="MathJax-Span-3100"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-3101" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3102"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3103" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3104"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-3105" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">λ</span></span><span class="mo" id="MathJax-Span-3106"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.747em; border-left: 0px solid; width: 0px; height: 1.753em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>Color</mi><mi>o</mi></msub><mo>⁡</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><msub><mi>ω</mi><mi>o</mi></msub><mo>,</mo><mi>λ</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>ω</mi><mi>i</mi></msub></mrow></msub><mi>A</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><msub><mi>ω</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ω</mi><mi>o</mi></msub><mo>,</mo><mi>λ</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>pScatter</mi><mo>⁡</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><msub><mi>ω</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ω</mi><mi>o</mi></msub><mo>,</mo><mi>λ</mi><mo stretchy="false">)</mo><mo>⋅</mo><msub><mi>Color</mi><mi>i</mi></msub><mo>⁡</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><msub><mi>ω</mi><mi>i</mi></msub><mo>,</mo><mi>λ</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-296"> \operatorname{Color}_o(\mathbf{x}, \omega_o, \lambda) = \int_{\omega_i}
        A(\mathbf{x}, \omega_i, \omega_o, \lambda) \cdot
        \operatorname{pScatter}(\mathbf{x}, \omega_i, \omega_o, \lambda) \cdot
        \operatorname{Color}_i(\mathbf{x}, \omega_i, \lambda) </script>

</p><p>

We've added a <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-297-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;Color&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3107" style="width: 2.585em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.12em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.054em, 1002.12em, 1.501em, -999.997em); top: -0.979em; left: 0em;"><span class="mrow" id="MathJax-Span-3108"><span class="msubsup" id="MathJax-Span-3109"><span style="display: inline-block; position: relative; width: 2.12em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1001.91em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3110"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.599em; left: 1.914em;"><span class="mi" id="MathJax-Span-3111" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.984em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>Color</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-297">\operatorname{Color}_i</script> term. The scattering PDF and the albedo at the surface of an
object are acting as filters to the light that is shining on that point. So we need to solve for the
light that is shining on that point. This is a recursive algorithm, and is the reason our
<code>ray_color</code> function returns the color of the current object multiplied by the color of the next
ray.

</p>
<a class="target" name="thescatteringpdf">&nbsp;</a><a class="target" name="lightscattering/thescatteringpdf">&nbsp;</a><a class="target" name="toc5.3">&nbsp;</a><h2>The Scattering PDF</h2>
<p>

If we apply the Monte Carlo basic formula we get the following statistical estimate:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-298-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;Color&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;pScatter&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Color&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3112" style="width: 23.505em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.424em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.519em, 1019.42em, 3.618em, -999.997em); top: -2.322em; left: 0em;"><span class="mrow" id="MathJax-Span-3113"><span class="msubsup" id="MathJax-Span-3114"><span style="display: inline-block; position: relative; width: 2.275em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1001.91em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3115"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.599em; left: 1.914em;"><span class="mi" id="MathJax-Span-3116" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3117"></span><span class="mo" id="MathJax-Span-3118"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="texatom" id="MathJax-Span-3119"><span class="mrow" id="MathJax-Span-3120"><span class="mi" id="MathJax-Span-3121"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span class="mo" id="MathJax-Span-3122"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-3123" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3124"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3125" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3126"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-3127" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">λ</span></span><span class="mo" id="MathJax-Span-3128"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-3129" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">≈</span></span><span class="mo" id="MathJax-Span-3130" style="vertical-align: -0.049em; padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∑</span></span><span class="mfrac" id="MathJax-Span-3131" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 11.934em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.346em, 1011.83em, 2.792em, -999.997em); top: -3.097em; left: 50%; margin-left: -5.886em;"><span class="mrow" id="MathJax-Span-3132"><span class="mi" id="MathJax-Span-3133"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">A</span></span><span class="mo" id="MathJax-Span-3134"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mspace" id="MathJax-Span-3135" style="height: 0em; vertical-align: 0em; width: 0.158em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3136"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">…</span></span><span class="mspace" id="MathJax-Span-3137" style="height: 0em; vertical-align: 0em; width: 0.158em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3138"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-3139" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mi" id="MathJax-Span-3140" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">S</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-3141"></span><span class="mo" id="MathJax-Span-3142"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mspace" id="MathJax-Span-3143" style="height: 0em; vertical-align: 0em; width: 0.158em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3144"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">…</span></span><span class="mspace" id="MathJax-Span-3145" style="height: 0em; vertical-align: 0em; width: 0.158em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3146"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-3147" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="msubsup" id="MathJax-Span-3148" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 2.12em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1001.91em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3149"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.599em; left: 1.914em;"><span class="mi" id="MathJax-Span-3150" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3151"></span><span class="mo" id="MathJax-Span-3152"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mspace" id="MathJax-Span-3153" style="height: 0em; vertical-align: 0em; width: 0.158em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3154"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">…</span></span><span class="mspace" id="MathJax-Span-3155" style="height: 0em; vertical-align: 0em; width: 0.158em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3156"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(1.346em, 1004.5em, 2.792em, -999.997em); top: -1.495em; left: 50%; margin-left: -2.218em;"><span class="mrow" id="MathJax-Span-3157"><span class="mi" id="MathJax-Span-3158"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-3159"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="texatom" id="MathJax-Span-3160"><span class="mrow" id="MathJax-Span-3161"><span class="mi" id="MathJax-Span-3162"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span class="mo" id="MathJax-Span-3163"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-3164" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3165"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3166" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3167"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-3168" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3169"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3170" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3171"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-3172" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">λ</span></span><span class="mo" id="MathJax-Span-3173"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1011.93em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 11.934em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.327em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.434em; border-left: 0px solid; width: 0px; height: 3.503em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>Color</mi><mi>o</mi></msub><mo>⁡</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><msub><mi>ω</mi><mi>o</mi></msub><mo>,</mo><mi>λ</mi><mo stretchy="false">)</mo><mo>≈</mo><mo>∑</mo><mfrac><mrow><mi>A</mi><mo stretchy="false">(</mo><mspace width="thinmathspace"></mspace><mo>…</mo><mspace width="thinmathspace"></mspace><mo stretchy="false">)</mo><mo>⋅</mo><mi>pScatter</mi><mo>⁡</mo><mo stretchy="false">(</mo><mspace width="thinmathspace"></mspace><mo>…</mo><mspace width="thinmathspace"></mspace><mo stretchy="false">)</mo><mo>⋅</mo><msub><mi>Color</mi><mi>i</mi></msub><mo>⁡</mo><mo stretchy="false">(</mo><mspace width="thinmathspace"></mspace><mo>…</mo><mspace width="thinmathspace"></mspace><mo stretchy="false">)</mo></mrow><mrow><mi>p</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><msub><mi>ω</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ω</mi><mi>o</mi></msub><mo>,</mo><mi>λ</mi><mo stretchy="false">)</mo></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-298"> \operatorname{Color}_o(\mathbf{x}, \omega_o, \lambda) \approx \sum
        \frac{A(\, \ldots \,) \cdot
        \operatorname{pScatter}(\, \ldots \,) \cdot
        \operatorname{Color}_i(\, \ldots \,)}
        {p(\mathbf{x}, \omega_i, \omega_o, \lambda)} </script>

</p><p>

where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-299-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3174" style="width: 5.478em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.496em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1004.5em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-3175"><span class="mi" id="MathJax-Span-3176"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-3177"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="texatom" id="MathJax-Span-3178"><span class="mrow" id="MathJax-Span-3179"><span class="mi" id="MathJax-Span-3180"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span class="mo" id="MathJax-Span-3181"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-3182" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3183"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3184" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3185"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-3186" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3187"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3188" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3189"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-3190" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">λ</span></span><span class="mo" id="MathJax-Span-3191"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><msub><mi>ω</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ω</mi><mi>o</mi></msub><mo>,</mo><mi>λ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-299">p(\mathbf{x}, \omega_i, \omega_o, \lambda)</script> is the PDF of whatever outgoing direction we
randomly generate.

</p><p>

For a Lambertian surface we already implicitly implemented this formula for the special case where
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-300-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3192" style="width: 5.374em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.445em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1004.45em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3193"><span class="mi" id="MathJax-Span-3194"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mi" id="MathJax-Span-3195"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">S</span></span><span class="mi" id="MathJax-Span-3196"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span></span><span class="mi" id="MathJax-Span-3197"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mi" id="MathJax-Span-3198"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span></span><span class="mi" id="MathJax-Span-3199"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span></span><span class="mi" id="MathJax-Span-3200"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span><span class="mi" id="MathJax-Span-3201"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-3202"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mspace" id="MathJax-Span-3203" style="height: 0em; vertical-align: 0em; width: 0.158em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3204"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">…</span></span><span class="mspace" id="MathJax-Span-3205" style="height: 0em; vertical-align: 0em; width: 0.158em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3206"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mi>S</mi><mi>c</mi><mi>a</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mspace width="thinmathspace"></mspace><mo>…</mo><mspace width="thinmathspace"></mspace><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-300">pScatter(\, \ldots \,)</script> is a cosine density. The <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-301-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;pScatter&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3207" style="width: 5.374em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.445em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1004.45em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3208"><span class="mi" id="MathJax-Span-3209"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">S</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-3210"></span><span class="mo" id="MathJax-Span-3211"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mspace" id="MathJax-Span-3212" style="height: 0em; vertical-align: 0em; width: 0.158em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3213"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">…</span></span><span class="mspace" id="MathJax-Span-3214" style="height: 0em; vertical-align: 0em; width: 0.158em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3215"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>pScatter</mi><mo>⁡</mo><mo stretchy="false">(</mo><mspace width="thinmathspace"></mspace><mo>…</mo><mspace width="thinmathspace"></mspace><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-301">\operatorname{pScatter}(\, \ldots \,)</script> of a
Lambertian surface is proportional to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-302-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3216" style="width: 2.947em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.43em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1002.43em, 2.74em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3217"><span class="mi" id="MathJax-Span-3218"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-3219"></span><span class="mo" id="MathJax-Span-3220"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-3221"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3222"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mi" id="MathJax-Span-3223" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3224"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mi>o</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-302">\cos(\theta_o)</script>, where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-303-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3225" style="width: 0.932em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.054em, 1000.78em, 1.501em, -999.997em); top: -0.979em; left: 0em;"><span class="mrow" id="MathJax-Span-3226"><span class="msubsup" id="MathJax-Span-3227"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3228"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mi" id="MathJax-Span-3229" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.984em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mi>o</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-303">\theta_o</script> is the angle relative to
the surface normal. Let's solve for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-304-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3230" style="width: 0.726em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.571em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.57em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3231"><span class="mi" id="MathJax-Span-3232"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-304">C</script> once more:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-305-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;pScatter&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3233" style="width: 13.949em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.521em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1011.52em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-3234"><span class="mi" id="MathJax-Span-3235"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">S</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-3236"></span><span class="mo" id="MathJax-Span-3237"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="texatom" id="MathJax-Span-3238"><span class="mrow" id="MathJax-Span-3239"><span class="mi" id="MathJax-Span-3240"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span class="mo" id="MathJax-Span-3241"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-3242" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3243"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3244" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3245"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-3246" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3247"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3248" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3249"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-3250" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">λ</span></span><span class="mo" id="MathJax-Span-3251"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-3252" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-3253" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span></span><span class="mo" id="MathJax-Span-3254" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mi" id="MathJax-Span-3255" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-3256"></span><span class="mo" id="MathJax-Span-3257"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-3258"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3259"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mi" id="MathJax-Span-3260" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3261"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>pScatter</mi><mo>⁡</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><msub><mi>ω</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ω</mi><mi>o</mi></msub><mo>,</mo><mi>λ</mi><mo stretchy="false">)</mo><mo>=</mo><mi>C</mi><mo>⋅</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mi>o</mi></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-305"> \operatorname{pScatter}(\mathbf{x}, \omega_i, \omega_o, \lambda) = C \cdot \cos(\theta_o) </script>

</p><p>

All two dimensional PDFs need to integrate to one over the whole surface (remember that
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-306-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;pScatter&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3262" style="width: 3.308em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.74em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1002.74em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3263"><span class="mi" id="MathJax-Span-3264"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">S</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>pScatter</mi></math></span></span><script type="math/tex" id="MathJax-Element-306">\operatorname{pScatter}</script> is a PDF). We set <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-307-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;pScatter&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3265" style="width: 8.577em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.079em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1007.08em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-3266"><span class="mi" id="MathJax-Span-3267"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">S</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-3268"></span><span class="mo" id="MathJax-Span-3269"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-3270"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3271"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mi" id="MathJax-Span-3272" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3273" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">&lt;</span></span><span class="mn" id="MathJax-Span-3274" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span class="mo" id="MathJax-Span-3275"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-3276" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-3277" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>pScatter</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mi>o</mi></msub><mo>&lt;</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-307">\operatorname{pScatter}(\theta_o < 0) = 0</script> so that we
don't scatter below the horizon.

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-308-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3278" style="width: 10.075em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.319em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.087em, 1008.32em, 2.998em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-3279"><span class="mn" id="MathJax-Span-3280"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-3281" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="msubsup" id="MathJax-Span-3282" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.637em, -999.997em); top: -2.218em; left: 0em;"><span class="mo" id="MathJax-Span-3283" style="vertical-align: -0.049em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∫</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.62em, 2.172em, -999.997em); top: -2.322em; left: 0.364em;"><span class="texatom" id="MathJax-Span-3284"><span class="mrow" id="MathJax-Span-3285"><span class="mn" id="MathJax-Span-3286" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-3287" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -1.444em; left: 0.364em;"><span class="texatom" id="MathJax-Span-3288"><span class="mrow" id="MathJax-Span-3289"><span class="mn" id="MathJax-Span-3290" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3291" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.191em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.637em, -999.997em); top: -2.218em; left: 0em;"><span class="mo" id="MathJax-Span-3292" style="vertical-align: -0.049em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∫</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.83em, 2.172em, -999.997em); top: -2.322em; left: 0.364em;"><span class="texatom" id="MathJax-Span-3293"><span class="mrow" id="MathJax-Span-3294"><span class="mi" id="MathJax-Span-3295" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span class="texatom" id="MathJax-Span-3296"><span class="mrow" id="MathJax-Span-3297"><span class="mo" id="MathJax-Span-3298" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="mn" id="MathJax-Span-3299" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -1.444em; left: 0.364em;"><span class="texatom" id="MathJax-Span-3300"><span class="mrow" id="MathJax-Span-3301"><span class="mn" id="MathJax-Span-3302" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mi" id="MathJax-Span-3303" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span></span><span class="mo" id="MathJax-Span-3304" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mi" id="MathJax-Span-3305" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span></span><span class="mi" id="MathJax-Span-3306"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span class="mi" id="MathJax-Span-3307"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-3308"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-3309"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-3310"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mi" id="MathJax-Span-3311"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-3312"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">A</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.747em; border-left: 0px solid; width: 0px; height: 2.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mn>1</mn><mo>=</mo><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mn>2</mn><mi>π</mi></mrow></msubsup><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>π</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn></mrow></msubsup><mi>C</mi><mo>⋅</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mi>d</mi><mi>A</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-308"> 1 = \int_{0}^{2 \pi} \int_{0}^{\pi / 2} C \cdot cos(\theta) dA </script>

</p><p>

To integrate over the hemisphere, remember that in spherical coordinates:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-309-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3313" style="width: 7.027em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.788em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1005.79em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-3314"><span class="mi" id="MathJax-Span-3315"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-3316"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">A</span></span><span class="mo" id="MathJax-Span-3317" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-3318" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mo" id="MathJax-Span-3319"></span><span class="mo" id="MathJax-Span-3320"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-3321"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-3322"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mi" id="MathJax-Span-3323"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-3324"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mi" id="MathJax-Span-3325"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-3326"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ϕ</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>d</mi><mi>A</mi><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mi>d</mi><mi>θ</mi><mi>d</mi><mi>ϕ</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-309"> dA = \sin(\theta) d\theta d\phi </script>

</p><p>

So:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-310-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3327" style="width: 13.277em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.953em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.087em, 1010.95em, 2.998em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-3328"><span class="mn" id="MathJax-Span-3329"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-3330" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-3331" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span></span><span class="mo" id="MathJax-Span-3332" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="msubsup" id="MathJax-Span-3333" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.637em, -999.997em); top: -2.218em; left: 0em;"><span class="mo" id="MathJax-Span-3334" style="vertical-align: -0.049em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∫</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.62em, 2.172em, -999.997em); top: -2.322em; left: 0.364em;"><span class="texatom" id="MathJax-Span-3335"><span class="mrow" id="MathJax-Span-3336"><span class="mn" id="MathJax-Span-3337" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-3338" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -1.444em; left: 0.364em;"><span class="texatom" id="MathJax-Span-3339"><span class="mrow" id="MathJax-Span-3340"><span class="mn" id="MathJax-Span-3341" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3342" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.191em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.637em, -999.997em); top: -2.218em; left: 0em;"><span class="mo" id="MathJax-Span-3343" style="vertical-align: -0.049em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∫</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.83em, 2.172em, -999.997em); top: -2.322em; left: 0.364em;"><span class="texatom" id="MathJax-Span-3344"><span class="mrow" id="MathJax-Span-3345"><span class="mi" id="MathJax-Span-3346" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span class="texatom" id="MathJax-Span-3347"><span class="mrow" id="MathJax-Span-3348"><span class="mo" id="MathJax-Span-3349" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="mn" id="MathJax-Span-3350" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -1.444em; left: 0.364em;"><span class="texatom" id="MathJax-Span-3351"><span class="mrow" id="MathJax-Span-3352"><span class="mn" id="MathJax-Span-3353" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mi" id="MathJax-Span-3354" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span></span><span class="mi" id="MathJax-Span-3355"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span class="mi" id="MathJax-Span-3356"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-3357"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-3358"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-3359"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mi" id="MathJax-Span-3360"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mi" id="MathJax-Span-3361"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span class="mi" id="MathJax-Span-3362"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mo" id="MathJax-Span-3363"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-3364"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-3365"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mi" id="MathJax-Span-3366"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-3367"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mi" id="MathJax-Span-3368"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-3369"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ϕ</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.747em; border-left: 0px solid; width: 0px; height: 2.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mn>1</mn><mo>=</mo><mi>C</mi><mo>⋅</mo><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mn>2</mn><mi>π</mi></mrow></msubsup><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>π</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn></mrow></msubsup><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mi>d</mi><mi>θ</mi><mi>d</mi><mi>ϕ</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-310"> 1 = C \cdot \int_{0}^{2 \pi} \int_{0}^{\pi / 2} cos(\theta) sin(\theta) d\theta d\phi </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-311-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3370" style="width: 5.22em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.29em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1004.29em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-3371"><span class="mn" id="MathJax-Span-3372"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-3373" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-3374" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span></span><span class="mo" id="MathJax-Span-3375" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mn" id="MathJax-Span-3376" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-3377"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span class="mfrac" id="MathJax-Span-3378"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-3379"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-3380"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.52em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.519em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mn>1</mn><mo>=</mo><mi>C</mi><mo>⋅</mo><mn>2</mn><mi>π</mi><mfrac><mn>1</mn><mn>2</mn></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-311"> 1 = C \cdot 2 \pi \frac{1}{2} </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-312-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3381" style="width: 3.825em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.153em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1003.15em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-3382"><span class="mn" id="MathJax-Span-3383"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-3384" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-3385" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span></span><span class="mo" id="MathJax-Span-3386" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mi" id="MathJax-Span-3387" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mn>1</mn><mo>=</mo><mi>C</mi><mo>⋅</mo><mi>π</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-312"> 1 = C \cdot \pi </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-313-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3388" style="width: 2.895em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.379em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1002.38em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-3389"><span class="mi" id="MathJax-Span-3390"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span></span><span class="mo" id="MathJax-Span-3391" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-3392" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-3393"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mi" id="MathJax-Span-3394"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.52em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.519em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>C</mi><mo>=</mo><mfrac><mn>1</mn><mi>π</mi></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-313"> C = \frac{1}{\pi} </script>

</p><p>

The integral of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-314-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3395" style="width: 2.947em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.43em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1002.43em, 2.74em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3396"><span class="mi" id="MathJax-Span-3397"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-3398"></span><span class="mo" id="MathJax-Span-3399"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-3400"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3401"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mi" id="MathJax-Span-3402" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3403"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mi>o</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-314">\cos(\theta_o)</script> over the hemisphere is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-315-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3404" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3405"><span class="mi" id="MathJax-Span-3406"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-315">\pi</script>, so we need to normalize by
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-316-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3407" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(-0.307em, 1000.62em, 1.759em, -999.997em); top: -0.979em; left: 0em;"><span class="mrow" id="MathJax-Span-3408"><span class="mfrac" id="MathJax-Span-3409"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.139em, 1000.31em, 2.172em, -999.997em); top: -2.425em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-3410" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.31em, 2.172em, -999.997em); top: -1.392em; left: 50%; margin-left: -0.152em;"><span class="mi" id="MathJax-Span-3411" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.42em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.416em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.984em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.809em; border-left: 0px solid; width: 0px; height: 2.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mn>1</mn><mi>π</mi></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-316">\frac{1}{\pi}</script>. The PDF <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-317-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;pScatter&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3412" style="width: 3.308em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.74em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1002.74em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3413"><span class="mi" id="MathJax-Span-3414"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">S</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>pScatter</mi></math></span></span><script type="math/tex" id="MathJax-Element-317">\operatorname{pScatter}</script> is only dependent on outgoing direction
(<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-318-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3415" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.054em, 1000.88em, 1.501em, -999.997em); top: -0.979em; left: 0em;"><span class="mrow" id="MathJax-Span-3416"><span class="msubsup" id="MathJax-Span-3417"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3418"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3419" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.984em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>ω</mi><mi>o</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-318">\omega_o</script>), so we'll simplify its representation to just <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-319-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;pScatter&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3420" style="width: 5.013em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.135em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1004.13em, 2.74em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3421"><span class="mi" id="MathJax-Span-3422"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">S</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-3423"></span><span class="mo" id="MathJax-Span-3424"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-3425"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3426"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3427" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3428"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>pScatter</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>ω</mi><mi>o</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-319">\operatorname{pScatter}(\omega_o)</script>. Put
all of this together and you get the scattering PDF for a Lambertian surface:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-320-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;pScatter&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3429" style="width: 9.713em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.009em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.467em, 1008.01em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-3430"><span class="mi" id="MathJax-Span-3431"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">S</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-3432"></span><span class="mo" id="MathJax-Span-3433"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-3434"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3435"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3436" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3437"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-3438" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-3439" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 2.534em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1002.43em, 2.74em, -999.997em); top: -3.045em; left: 50%; margin-left: -1.185em;"><span class="mrow" id="MathJax-Span-3440"><span class="mi" id="MathJax-Span-3441"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-3442"></span><span class="mo" id="MathJax-Span-3443"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-3444"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3445"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mi" id="MathJax-Span-3446" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3447"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mi" id="MathJax-Span-3448"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1002.53em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.534em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.253em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>pScatter</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>ω</mi><mi>o</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mi>o</mi></msub><mo stretchy="false">)</mo></mrow><mi>π</mi></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-320"> \operatorname{pScatter}(\omega_o) = \frac{\cos(\theta_o)}{\pi} </script>

</p><p>

We'll assume that the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-321-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3449" style="width: 5.478em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.496em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1004.5em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-3450"><span class="mi" id="MathJax-Span-3451"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-3452"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="texatom" id="MathJax-Span-3453"><span class="mrow" id="MathJax-Span-3454"><span class="mi" id="MathJax-Span-3455"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span class="mo" id="MathJax-Span-3456"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-3457" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3458"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3459" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3460"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-3461" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3462"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3463" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3464"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-3465" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">λ</span></span><span class="mo" id="MathJax-Span-3466"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><msub><mi>ω</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ω</mi><mi>o</mi></msub><mo>,</mo><mi>λ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-321">p(\mathbf{x}, \omega_i, \omega_o, \lambda)</script> is equal to the scattering PDF:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-322-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;pScatter&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3467" style="width: 13.277em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.953em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.467em, 1010.95em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-3468"><span class="mi" id="MathJax-Span-3469"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-3470"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-3471"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3472"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3473" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3474"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-3475" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-3476" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">S</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-3477"></span><span class="mo" id="MathJax-Span-3478"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-3479"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3480"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3481" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3482"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-3483" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-3484" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 2.534em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1002.43em, 2.74em, -999.997em); top: -3.045em; left: 50%; margin-left: -1.185em;"><span class="mrow" id="MathJax-Span-3485"><span class="mi" id="MathJax-Span-3486"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-3487"></span><span class="mo" id="MathJax-Span-3488"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-3489"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3490"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mi" id="MathJax-Span-3491" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3492"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mi" id="MathJax-Span-3493"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1002.53em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.534em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.253em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>p</mi><mo stretchy="false">(</mo><msub><mi>ω</mi><mi>o</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>pScatter</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>ω</mi><mi>o</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mi>o</mi></msub><mo stretchy="false">)</mo></mrow><mi>π</mi></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-322"> p(\omega_o) = \operatorname{pScatter}(\omega_o) = \frac{\cos(\theta_o)}{\pi} </script>

</p><p>

The numerator and denominator cancel out, and we get:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-323-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;Color&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Color&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3494" style="width: 16.996em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.052em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.397em, 1014.05em, 2.843em, -999.997em); top: -2.322em; left: 0em;"><span class="mrow" id="MathJax-Span-3495"><span class="msubsup" id="MathJax-Span-3496"><span style="display: inline-block; position: relative; width: 2.275em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1001.91em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3497"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.599em; left: 1.914em;"><span class="mi" id="MathJax-Span-3498" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3499"></span><span class="mo" id="MathJax-Span-3500"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="texatom" id="MathJax-Span-3501"><span class="mrow" id="MathJax-Span-3502"><span class="mi" id="MathJax-Span-3503"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span class="mo" id="MathJax-Span-3504"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-3505" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3506"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3507" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3508"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-3509" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">λ</span></span><span class="mo" id="MathJax-Span-3510"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-3511" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">≈</span></span><span class="mo" id="MathJax-Span-3512" style="vertical-align: -0.049em; padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∑</span></span><span class="mi" id="MathJax-Span-3513" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">A</span></span><span class="mo" id="MathJax-Span-3514"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mspace" id="MathJax-Span-3515" style="height: 0em; vertical-align: 0em; width: 0.158em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3516"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">…</span></span><span class="mspace" id="MathJax-Span-3517" style="height: 0em; vertical-align: 0em; width: 0.158em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3518"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-3519" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="msubsup" id="MathJax-Span-3520" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 2.12em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1001.91em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3521"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.599em; left: 1.914em;"><span class="mi" id="MathJax-Span-3522" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3523"></span><span class="mo" id="MathJax-Span-3524"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mspace" id="MathJax-Span-3525" style="height: 0em; vertical-align: 0em; width: 0.158em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3526"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">…</span></span><span class="mspace" id="MathJax-Span-3527" style="height: 0em; vertical-align: 0em; width: 0.158em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3528"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.327em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>Color</mi><mi>o</mi></msub><mo>⁡</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><msub><mi>ω</mi><mi>o</mi></msub><mo>,</mo><mi>λ</mi><mo stretchy="false">)</mo><mo>≈</mo><mo>∑</mo><mi>A</mi><mo stretchy="false">(</mo><mspace width="thinmathspace"></mspace><mo>…</mo><mspace width="thinmathspace"></mspace><mo stretchy="false">)</mo><mo>⋅</mo><msub><mi>Color</mi><mi>i</mi></msub><mo>⁡</mo><mo stretchy="false">(</mo><mspace width="thinmathspace"></mspace><mo>…</mo><mspace width="thinmathspace"></mspace><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-323"> \operatorname{Color}_o(\mathbf{x}, \omega_o, \lambda) \approx \sum
        A(\, \ldots \,) \cdot
        \operatorname{Color}_i(\, \ldots \,) </script>

</p><p>

</p><div class="together">
This is exactly what we had in our original <code>ray_color()</code> function!

<p></p><pre class="listing tilde"><code><span class="line"></span>    <span class="hljs-keyword">return</span> attenuation * ray_color(scattered, depth-<span class="hljs-number">1</span>, world);</code></pre><p>

</p></div>

<p></p><p>

The treatment above is slightly non-standard because I want the same math to work for surfaces and
volumes. If you read the literature, you’ll see reflection defined by the <em class="underscore">Bidirectional Reflectance
Distribution Function</em> (BRDF). It relates pretty simply to our terms:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-324-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;pScatter&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3529" style="width: 23.04em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.011em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.467em, 1019.01em, 3.567em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-3530"><span class="mi" id="MathJax-Span-3531"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">B</span></span><span class="mi" id="MathJax-Span-3532"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">R</span></span><span class="mi" id="MathJax-Span-3533"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">D</span></span><span class="mi" id="MathJax-Span-3534"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">F</span></span><span class="mo" id="MathJax-Span-3535"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-3536"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3537"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3538" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3539"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-3540" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3541"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3542" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3543"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-3544" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">λ</span></span><span class="mo" id="MathJax-Span-3545"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-3546" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-3547" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 12.244em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.346em, 1012.14em, 2.792em, -999.997em); top: -3.097em; left: 50%; margin-left: -6.041em;"><span class="mrow" id="MathJax-Span-3548"><span class="mi" id="MathJax-Span-3549"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">A</span></span><span class="mo" id="MathJax-Span-3550"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="texatom" id="MathJax-Span-3551"><span class="mrow" id="MathJax-Span-3552"><span class="mi" id="MathJax-Span-3553"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span class="mo" id="MathJax-Span-3554"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-3555" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3556"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3557" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3558"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-3559" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3560"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3561" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3562"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-3563" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">λ</span></span><span class="mo" id="MathJax-Span-3564"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-3565" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mi" id="MathJax-Span-3566" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">S</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-3567"></span><span class="mo" id="MathJax-Span-3568"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="texatom" id="MathJax-Span-3569"><span class="mrow" id="MathJax-Span-3570"><span class="mi" id="MathJax-Span-3571"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span class="mo" id="MathJax-Span-3572"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-3573" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3574"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3575" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3576"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-3577" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3578"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3579" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3580"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-3581" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">λ</span></span><span class="mo" id="MathJax-Span-3582"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1002.43em, 2.74em, -999.997em); top: -1.444em; left: 50%; margin-left: -1.185em;"><span class="mrow" id="MathJax-Span-3583"><span class="mi" id="MathJax-Span-3584"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-3585"></span><span class="mo" id="MathJax-Span-3586"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-3587"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3588"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mi" id="MathJax-Span-3589" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3590"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1012.24em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 12.244em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.434em; border-left: 0px solid; width: 0px; height: 3.503em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>B</mi><mi>R</mi><mi>D</mi><mi>F</mi><mo stretchy="false">(</mo><msub><mi>ω</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ω</mi><mi>o</mi></msub><mo>,</mo><mi>λ</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>A</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><msub><mi>ω</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ω</mi><mi>o</mi></msub><mo>,</mo><mi>λ</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>pScatter</mi><mo>⁡</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><msub><mi>ω</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ω</mi><mi>o</mi></msub><mo>,</mo><mi>λ</mi><mo stretchy="false">)</mo></mrow><mrow><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mi>o</mi></msub><mo stretchy="false">)</mo></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-324"> BRDF(\omega_i, \omega_o, \lambda) = \frac{A(\mathbf{x}, \omega_i, \omega_o, \lambda) \cdot
        \operatorname{pScatter}(\mathbf{x}, \omega_i, \omega_o, \lambda)}{\cos(\theta_o)} </script>

</p><p>

So for a Lambertian surface for example, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-325-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3591" style="width: 5.478em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.496em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1004.5em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-3592"><span class="mi" id="MathJax-Span-3593"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">B</span></span><span class="mi" id="MathJax-Span-3594"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">R</span></span><span class="mi" id="MathJax-Span-3595"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">D</span></span><span class="mi" id="MathJax-Span-3596"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">F</span></span><span class="mo" id="MathJax-Span-3597" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-3598" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">A</span></span><span class="texatom" id="MathJax-Span-3599"><span class="mrow" id="MathJax-Span-3600"><span class="mo" id="MathJax-Span-3601"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="mi" id="MathJax-Span-3602"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi><mi>R</mi><mi>D</mi><mi>F</mi><mo>=</mo><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-325">BRDF = A / \pi</script>. Translation between our terms and BRDF is
easy. For participating media (volumes), our albedo is usually called the <em class="underscore">scattering albedo</em>, and
our scattering PDF is usually called the <em class="underscore">phase function</em>.

</p><p>

All that we've done here is outline the PDF for the Lambertian scattering of a material. However,
we'll need to generalize so that we can send extra rays in important directions, such as toward the
lights.

</p>
<a class="target" name="playingwithimportancesampling">&nbsp;</a><a class="target" name="playingwithimportancesampling">&nbsp;</a><a class="target" name="toc6">&nbsp;</a><h1>Playing with Importance Sampling</h1>
<p>

Our goal over the next several chapters is to instrument our program to send a bunch of extra rays
toward light sources so that our picture is less noisy. Let’s assume we can send a bunch of rays
toward the light source using a PDF <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-326-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;pLight&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3603" style="width: 4.445em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.67em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1003.67em, 2.74em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3604"><span class="mi" id="MathJax-Span-3605"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">L</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">g</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">h</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span></span><span class="mo" id="MathJax-Span-3606"></span><span class="mo" id="MathJax-Span-3607"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-3608"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3609"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3610" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3611"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>pLight</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>ω</mi><mi>o</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-326">\operatorname{pLight}(\omega_o)</script>. Let’s also assume we have a
PDF related to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-327-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;pScatter&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3612" style="width: 3.308em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.74em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1002.74em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3613"><span class="mi" id="MathJax-Span-3614"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">S</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>pScatter</mi></math></span></span><script type="math/tex" id="MathJax-Element-327">\operatorname{pScatter}</script>, and let’s call that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-328-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;pSurface&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3615" style="width: 5.323em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.393em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1004.39em, 2.74em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3616"><span class="mi" id="MathJax-Span-3617"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">S</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">u</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span><span class="mo" id="MathJax-Span-3618"></span><span class="mo" id="MathJax-Span-3619"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-3620"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3621"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3622" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3623"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>pSurface</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>ω</mi><mi>o</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-328">\operatorname{pSurface}(\omega_o)</script>. A
great thing about PDFs is that you can just use linear mixtures of them to form mixture densities
that are also PDFs. For example, the simplest would be:

</p><p>

  <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-329-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;pSurface&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;pLight&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3624" style="width: 16.273em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.432em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1013.43em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-3625"><span class="mi" id="MathJax-Span-3626"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-3627"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-3628"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3629"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3630" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3631"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-3632" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-3633" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-3634"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-3635"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.52em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.519em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mi" id="MathJax-Span-3636"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">S</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">u</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span><span class="mo" id="MathJax-Span-3637"></span><span class="mo" id="MathJax-Span-3638"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-3639"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3640"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3641" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3642"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-3643" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">+</span></span><span class="mfrac" id="MathJax-Span-3644" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-3645"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-3646"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.52em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.519em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mi" id="MathJax-Span-3647"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">L</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">g</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">h</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span></span><span class="mo" id="MathJax-Span-3648"></span><span class="mo" id="MathJax-Span-3649"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-3650"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3651"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3652" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3653"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>p</mi><mo stretchy="false">(</mo><msub><mi>ω</mi><mi>o</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>pSurface</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>ω</mi><mi>o</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>pLight</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>ω</mi><mi>o</mi></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-329"> p(\omega_o) = \frac{1}{2} \operatorname{pSurface}(\omega_o) +  \frac{1}{2}
      \operatorname{pLight}(\omega_o)</script>

</p><p>

As long as the weights are positive and add up to one, any such mixture of PDFs is a PDF. Remember,
we can use any PDF: <em class="underscore">all PDFs eventually converge to the correct answer</em>. So, the game is to figure
out how to make the PDF larger where the product

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-330-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;pScatter&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Color&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3654" style="width: 13.122em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.85em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1010.85em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-3655"><span class="mi" id="MathJax-Span-3656"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">S</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-3657"></span><span class="mo" id="MathJax-Span-3658"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="texatom" id="MathJax-Span-3659"><span class="mrow" id="MathJax-Span-3660"><span class="mi" id="MathJax-Span-3661"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span class="mo" id="MathJax-Span-3662"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-3663" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3664"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3665" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3666"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-3667" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3668"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3669" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3670"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-3671" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="msubsup" id="MathJax-Span-3672" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 2.12em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1001.91em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3673"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.599em; left: 1.914em;"><span class="mi" id="MathJax-Span-3674" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3675"></span><span class="mo" id="MathJax-Span-3676"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="texatom" id="MathJax-Span-3677"><span class="mrow" id="MathJax-Span-3678"><span class="mi" id="MathJax-Span-3679"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span class="mo" id="MathJax-Span-3680"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-3681" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3682"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3683" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3684"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>pScatter</mi><mo>⁡</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><msub><mi>ω</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ω</mi><mi>o</mi></msub><mo stretchy="false">)</mo><mo>⋅</mo><msub><mi>Color</mi><mi>i</mi></msub><mo>⁡</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><msub><mi>ω</mi><mi>i</mi></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-330"> \operatorname{pScatter}(\mathbf{x}, \omega_i, \omega_o) \cdot
        \operatorname{Color}_i(\mathbf{x}, \omega_i) </script>

</p><p>

is largest. For diffuse surfaces, this is mainly a matter of guessing where
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-331-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;Color&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3685" style="width: 5.065em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.186em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1004.19em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-3686"><span class="msubsup" id="MathJax-Span-3687"><span style="display: inline-block; position: relative; width: 2.12em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1001.91em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3688"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.599em; left: 1.914em;"><span class="mi" id="MathJax-Span-3689" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3690"></span><span class="mo" id="MathJax-Span-3691"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="texatom" id="MathJax-Span-3692"><span class="mrow" id="MathJax-Span-3693"><span class="mi" id="MathJax-Span-3694"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span class="mo" id="MathJax-Span-3695"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-3696" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3697"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3698" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3699"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>Color</mi><mi>i</mi></msub><mo>⁡</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><msub><mi>ω</mi><mi>i</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-331">\operatorname{Color}_i(\mathbf{x}, \omega_i)</script> is largest. Which is equivalent to guessing where the
most light is coming from.

</p><p>

For a mirror, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-332-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;pScatter&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3700" style="width: 3.98em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.257em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1003.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3701"><span class="mi" id="MathJax-Span-3702"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">S</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-3703"></span><span class="mo" id="MathJax-Span-3704"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mo" id="MathJax-Span-3705"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>pScatter</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-332">\operatorname{pScatter}()</script> is huge only near one direction, so
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-333-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;pScatter&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3706" style="width: 3.98em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.257em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1003.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3707"><span class="mi" id="MathJax-Span-3708"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">S</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-3709"></span><span class="mo" id="MathJax-Span-3710"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mo" id="MathJax-Span-3711"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>pScatter</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-333">\operatorname{pScatter}()</script> matters a lot more. In fact, most renderers just make mirrors a special
case, and make the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-334-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;pScatter&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3712" style="width: 5.478em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.496em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1004.5em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3713"><span class="mi" id="MathJax-Span-3714"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">S</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-3715"></span><span class="mo" id="MathJax-Span-3716"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mo" id="MathJax-Span-3717"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="texatom" id="MathJax-Span-3718"><span class="mrow" id="MathJax-Span-3719"><span class="mo" id="MathJax-Span-3720"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="mi" id="MathJax-Span-3721"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-3722"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mo" id="MathJax-Span-3723"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>pScatter</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>p</mi><mo stretchy="false">(</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-334">\operatorname{pScatter}()/p()</script> implicit — our code currently does that.

</p>
<a class="target" name="returningtothecornellbox">&nbsp;</a><a class="target" name="playingwithimportancesampling/returningtothecornellbox">&nbsp;</a><a class="target" name="toc6.1">&nbsp;</a><h2>Returning to the Cornell Box</h2>
<p>

Let’s adjust some parameters for the Cornell box:

</p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
<span class="line"></span>    ...<div class=" highlight"><span class="line"></span>    cam.samples_per_pixel = <span class="hljs-number">100</span>;</div><span class="line"></span>    ...
<span class="line"></span>}</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_cornell-box">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;17:</b> <kbd>[main.cc]</kbd> Cornell box, refactored</div></center>
<p>


</p><div class="together">
At 600×600 my code produces this image in 15min on 1 core of my Macbook:

<p></p><p>

  </p><center><div class="image" style=""><a href="./input_files/img-3.03-cornell-refactor1.jpg" target="_blank"><img class="markdeep pixel" src="./input_files/img-3.03-cornell-refactor1.jpg"></a><center><span class="imagecaption"><span class="num">Image 3:</span> Cornell box, refactored
  </span></center></div></center>

<p></p><p>

</p></div>

<p></p><p>

Reducing that noise is our goal. We’ll do that by constructing a PDF that sends more rays to the
light.

</p><p>

First, let’s instrument the code so that it explicitly samples some PDF and then normalizes for
that. Remember Monte Carlo basics: <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-335-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3724" style="width: 7.699em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.356em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.397em, 1006.36em, 2.74em, -999.997em); top: -2.322em; left: 0em;"><span class="mrow" id="MathJax-Span-3725"><span class="mo" id="MathJax-Span-3726" style="vertical-align: -0.049em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∫</span></span><span class="mi" id="MathJax-Span-3727" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-3728"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-3729"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-3730"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-3731" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">≈</span></span><span class="mo" id="MathJax-Span-3732" style="vertical-align: -0.049em; padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∑</span></span><span class="mi" id="MathJax-Span-3733" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-3734"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-3735"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-3736"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="texatom" id="MathJax-Span-3737"><span class="mrow" id="MathJax-Span-3738"><span class="mo" id="MathJax-Span-3739"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="mi" id="MathJax-Span-3740"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-3741"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-3742"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-3743"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.327em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>∫</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>≈</mo><mo>∑</mo><mi>f</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>p</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-335">\int f(x) \approx \sum f(r)/p(r)</script>. For the Lambertian material,
let’s sample like we do now: <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-336-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3744" style="width: 7.337em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.046em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1006.05em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-3745"><span class="mi" id="MathJax-Span-3746"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-3747"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-3748"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3749"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3750" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3751"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-3752" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-3753" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-3754"></span><span class="mo" id="MathJax-Span-3755"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-3756"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3757"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mi" id="MathJax-Span-3758" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3759"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="texatom" id="MathJax-Span-3760"><span class="mrow" id="MathJax-Span-3761"><span class="mo" id="MathJax-Span-3762"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="mi" id="MathJax-Span-3763"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><msub><mi>ω</mi><mi>o</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mi>o</mi></msub><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-336">p(\omega_o) = \cos(\theta_o) / \pi</script>.

</p><p>

</p><div class="together">
We modify the base-class <code>material</code> to enable this importance sampling:

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">material</span> {
<span class="line"></span>  <span class="hljs-keyword">public</span>:
<span class="line"></span>    ...
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">double</span> <span class="hljs-title">scattering_pdf</span><span class="hljs-params">(<span class="hljs-type">const</span> ray&amp; r_in, <span class="hljs-type">const</span> hit_record&amp; rec, <span class="hljs-type">const</span> ray&amp; scattered)</span>
<span class="line"></span>    <span class="hljs-type">const</span> </span>{
<span class="line"></span>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
<span class="line"></span>    }</div><span class="line"></span>};</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_class-material">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;18:</b> <kbd>[material.h]</kbd>
        The material class, adding importance sampling
    </div></center>
<p>


</p></div>

<p></p><p>

</p><div class="together">
And the <code>lambertian</code> material becomes:

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">lambertian</span> : <span class="hljs-keyword">public</span> material {
<span class="line"></span>  <span class="hljs-keyword">public</span>:
<span class="line"></span>    <span class="hljs-built_in">lambertian</span>(<span class="hljs-type">const</span> color&amp; albedo) : <span class="hljs-built_in">tex</span>(<span class="hljs-built_in">make_shared</span>&lt;solid_color&gt;(albedo)) {}
<span class="line"></span>    <span class="hljs-built_in">lambertian</span>(shared_ptr&lt;texture&gt; tex) : <span class="hljs-built_in">tex</span>(tex) {}
<span class="line"></span>
<span class="line"></span>    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">scatter</span><span class="hljs-params">(<span class="hljs-type">const</span> ray&amp; r_in, <span class="hljs-type">const</span> hit_record&amp; rec, color&amp; attenuation, ray&amp; scattered)</span>
<span class="line"></span>    <span class="hljs-type">const</span> <span class="hljs-keyword">override</span> </span>{
<span class="line"></span>        <span class="hljs-keyword">auto</span> scatter_direction = rec.normal + <span class="hljs-built_in">random_unit_vector</span>();
<span class="line"></span>
<span class="line"></span>        <span class="hljs-comment">// Catch degenerate scatter direction</span>
<span class="line"></span>        <span class="hljs-keyword">if</span> (scatter_direction.<span class="hljs-built_in">near_zero</span>())
<span class="line"></span>            scatter_direction = rec.normal;
<span class="line"></span>
<span class="line"></span>        scattered = <span class="hljs-built_in">ray</span>(rec.p, scatter_direction, r_in.<span class="hljs-built_in">time</span>());
<span class="line"></span>        attenuation = tex-&gt;<span class="hljs-built_in">value</span>(rec.u, rec.v, rec.p);
<span class="line"></span>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
<span class="line"></span>    }
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>    <span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">scattering_pdf</span><span class="hljs-params">(<span class="hljs-type">const</span> ray&amp; r_in, <span class="hljs-type">const</span> hit_record&amp; rec, <span class="hljs-type">const</span> ray&amp; scattered)</span> <span class="hljs-type">const</span> </span>{
<span class="line"></span>        <span class="hljs-keyword">auto</span> cos_theta = <span class="hljs-built_in">dot</span>(rec.normal, <span class="hljs-built_in">unit_vector</span>(scattered.<span class="hljs-built_in">direction</span>()));
<span class="line"></span>        <span class="hljs-keyword">return</span> cos_theta &lt; <span class="hljs-number">0</span> ? <span class="hljs-number">0</span> : cos_theta/pi;
<span class="line"></span>    }</div><span class="line"></span>
<span class="line"></span>  <span class="hljs-keyword">private</span>:
<span class="line"></span>    shared_ptr&lt;texture&gt; tex;
<span class="line"></span>};</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_class-lambertian-impsample">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;19:</b> <kbd>[material.h]</kbd>
        Lambertian material, modified for importance sampling
    </div></center>
<p>


</p></div>

<p></p><p>

</p><div class="together">
And the <code>camera::ray_color</code> function gets a minor modification:

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">camera</span> {
<span class="line"></span>  ...
<span class="line"></span>  <span class="hljs-keyword">private</span>:
<span class="line"></span>    ...
<span class="line"></span>    <span class="hljs-function">color <span class="hljs-title">ray_color</span><span class="hljs-params">(<span class="hljs-type">const</span> ray&amp; r, <span class="hljs-type">int</span> depth, <span class="hljs-type">const</span> hittable&amp; world)</span> <span class="hljs-type">const</span> </span>{
<span class="line"></span>        <span class="hljs-comment">// If we've exceeded the ray bounce limit, no more light is gathered.</span>
<span class="line"></span>        <span class="hljs-keyword">if</span> (depth &lt;= <span class="hljs-number">0</span>)
<span class="line"></span>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">color</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>);
<span class="line"></span>
<span class="line"></span>        hit_record rec;
<span class="line"></span>
<span class="line"></span>        <span class="hljs-comment">// If the ray hits nothing, return the background color.</span>
<span class="line"></span>        <span class="hljs-keyword">if</span> (!world.<span class="hljs-built_in">hit</span>(r, <span class="hljs-built_in">interval</span>(<span class="hljs-number">0.001</span>, infinity), rec))
<span class="line"></span>            <span class="hljs-keyword">return</span> background;
<span class="line"></span>
<span class="line"></span>        ray scattered;
<span class="line"></span>        color attenuation;
<span class="line"></span>        color color_from_emission = rec.mat-&gt;<span class="hljs-built_in">emitted</span>(rec.u, rec.v, rec.p);
<span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">if</span> (!rec.mat-&gt;<span class="hljs-built_in">scatter</span>(r, rec, attenuation, scattered))
<span class="line"></span>            <span class="hljs-keyword">return</span> color_from_emission;
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>        <span class="hljs-type">double</span> scattering_pdf = rec.mat-&gt;<span class="hljs-built_in">scattering_pdf</span>(r, rec, scattered);
<span class="line"></span>        <span class="hljs-type">double</span> pdf = scattering_pdf;
<span class="line"></span>
<span class="line"></span>        color color_from_scatter =
<span class="line"></span>            (attenuation * scattering_pdf * <span class="hljs-built_in">ray_color</span>(scattered, depth<span class="hljs-number">-1</span>, world)) / pdf;</div><span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">return</span> color_from_emission + color_from_scatter;
<span class="line"></span>    }
<span class="line"></span>};</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_ray-color-impsample">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;20:</b> <kbd>[camera.h]</kbd>
        The ray_color function, modified for importance sampling
    </div></center>
<p>


</p></div>

<p></p><p>

You should get exactly the same picture. Which <em class="underscore">should make sense</em>, as the scattered part of
<code>ray_color</code> is getting multiplied by <code>scattering_pdf / pdf</code>, and as <code>pdf</code> is equal to
<code>scattering_pdf</code> is just the same as multiplying by one.

</p>
<a class="target" name="usingauniformpdfinsteadofaperfectmatch">&nbsp;</a><a class="target" name="playingwithimportancesampling/usingauniformpdfinsteadofaperfectmatch">&nbsp;</a><a class="target" name="toc6.2">&nbsp;</a><h2>Using a Uniform PDF Instead of a Perfect Match</h2>
<p>

Now, just for the experience, let's try using a different sampling PDF. We'll continue to have our
reflected rays weighted by Lambertian, so <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-337-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3764" style="width: 2.947em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.43em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1002.43em, 2.74em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3765"><span class="mi" id="MathJax-Span-3766"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-3767"></span><span class="mo" id="MathJax-Span-3768"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-3769"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3770"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mi" id="MathJax-Span-3771" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3772"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mi>o</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-337">\cos(\theta_o)</script>, and we'll keep the scattering PDF as is,
but we'll use a different PDF in the denominator. We will sample using a uniform PDF about the
hemisphere, so we'll set the denominator to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-338-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3773" style="width: 1.81em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.501em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.5em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3774"><span class="mn" id="MathJax-Span-3775"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="texatom" id="MathJax-Span-3776"><span class="mrow" id="MathJax-Span-3777"><span class="mo" id="MathJax-Span-3778"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="mn" id="MathJax-Span-3779"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-3780"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-338">1/2\pi</script>. This will still converge on the correct
answer, as all we've done is change the PDF, but since the PDF is now less of a perfect match for
the real distribution, it will take longer to converge. Which, for the same number of samples means
a noisier image:

</p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">camera</span> {
<span class="line"></span>  ...
<span class="line"></span>  <span class="hljs-keyword">private</span>:
<span class="line"></span>    ...
<span class="line"></span>    <span class="hljs-function">color <span class="hljs-title">ray_color</span><span class="hljs-params">(<span class="hljs-type">const</span> ray&amp; r, <span class="hljs-type">int</span> depth, <span class="hljs-type">const</span> hittable&amp; world)</span> <span class="hljs-type">const</span> </span>{
<span class="line"></span>        hit_record rec;
<span class="line"></span>
<span class="line"></span>        <span class="hljs-comment">// If we've exceeded the ray bounce limit, no more light is gathered.</span>
<span class="line"></span>        <span class="hljs-keyword">if</span> (depth &lt;= <span class="hljs-number">0</span>)
<span class="line"></span>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">color</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>);
<span class="line"></span>
<span class="line"></span>        <span class="hljs-comment">// If the ray hits nothing, return the background color.</span>
<span class="line"></span>        <span class="hljs-keyword">if</span> (!world.<span class="hljs-built_in">hit</span>(r, <span class="hljs-built_in">interval</span>(<span class="hljs-number">0.001</span>, infinity), rec))
<span class="line"></span>            <span class="hljs-keyword">return</span> background;
<span class="line"></span>
<span class="line"></span>        ray scattered;
<span class="line"></span>        color attenuation;
<span class="line"></span>        color color_from_emission = rec.mat-&gt;<span class="hljs-built_in">emitted</span>(rec.u, rec.v, rec.p);
<span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">if</span> (!rec.mat-&gt;<span class="hljs-built_in">scatter</span>(r, rec, attenuation, scattered))
<span class="line"></span>            <span class="hljs-keyword">return</span> color_from_emission;
<span class="line"></span>
<span class="line"></span>        <span class="hljs-type">double</span> scattering_pdf = rec.mat-&gt;<span class="hljs-built_in">scattering_pdf</span>(r, rec, scattered);<div class=" highlight"><span class="line"></span>        <span class="hljs-type">double</span> pdf = <span class="hljs-number">1</span> / (<span class="hljs-number">2</span>*pi);</div><span class="line"></span>
<span class="line"></span>        color color_from_scatter =
<span class="line"></span>            (attenuation * scattering_pdf * <span class="hljs-built_in">ray_color</span>(scattered, depth<span class="hljs-number">-1</span>, world)) / pdf;
<span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">return</span> color_from_emission + color_from_scatter;
<span class="line"></span>    }</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_ray-color-uniform">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;21:</b> <kbd>[camera.h]</kbd>
        The ray_color function, now with a uniform PDF in the denominator
    </div></center>
<p>


You should get a very similar result to before, only with slightly more noise, it may be hard to
see.

</p><p>

  </p><center><div class="image" style=""><a href="./input_files/img-3.04-cornell-refactor2.jpg" target="_blank"><img class="markdeep pixel" src="./input_files/img-3.04-cornell-refactor2.jpg"></a><center><span class="imagecaption"><span class="num">Image 4:</span> Cornell box, with imperfect PDF
  </span></center></div></center>

<p></p><p>

Make sure to return the PDF to the scattering PDF.

</p><pre class="listing tilde"><code><span class="line"></span>        ...
<span class="line"></span>
<span class="line"></span>        <span class="hljs-type">double</span> scattering_pdf = rec.mat-&gt;<span class="hljs-built_in">scattering_pdf</span>(r, rec, scattered);<div class=" highlight"><span class="line"></span>        <span class="hljs-type">double</span> pdf = scattering_pdf;</div><span class="line"></span>
<span class="line"></span>        ...</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_ray-color-return">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;22:</b> <kbd>[camera.h]</kbd> Return the PDF to the same as scattering PDF</div></center>

<a class="target" name="randomhemisphericalsampling">&nbsp;</a><a class="target" name="playingwithimportancesampling/randomhemisphericalsampling">&nbsp;</a><a class="target" name="toc6.3">&nbsp;</a><h2>Random Hemispherical Sampling</h2>
<p>

To confirm our understanding, let's try a different scattering distribution. For this one, we'll
attempt to repeat the uniform hemispherical scattering from the first book. There's nothing wrong
with this technique, but we are no longer treating our objects as Lambertian. Lambertian is a
specific type of diffuse material that requires a <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-339-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3781" style="width: 2.947em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.43em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1002.43em, 2.74em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3782"><span class="mi" id="MathJax-Span-3783"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-3784"></span><span class="mo" id="MathJax-Span-3785"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-3786"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3787"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mi" id="MathJax-Span-3788" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3789"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mi>o</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-339">\cos(\theta_o)</script> scattering distribution. Uniform
hemispherical scattering is a different diffuse material. If we keep the material the same but
change the PDF, as we did in last section, we will still converge on the same answer, but our
convergence may take more or less samples. However, if we change the material, we will have
fundamentally changed the render and the algorithm will converge on a different answer. So when we
replace Lambertian diffuse with uniform hemispherical diffuse we should expect the outcome of our
render to be <em class="underscore">materially</em> different. We're going to adjust our scattering direction and scattering
PDF:

</p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">lambertian</span> : <span class="hljs-keyword">public</span> material {
<span class="line"></span>  <span class="hljs-keyword">public</span>:
<span class="line"></span>    <span class="hljs-built_in">lambertian</span>(<span class="hljs-type">const</span> color&amp; albedo) : <span class="hljs-built_in">tex</span>(<span class="hljs-built_in">make_shared</span>&lt;solid_color&gt;(albedo)) {}
<span class="line"></span>    <span class="hljs-built_in">lambertian</span>(shared_ptr&lt;texture&gt; tex) : <span class="hljs-built_in">tex</span>(tex) {}
<span class="line"></span>
<span class="line"></span>    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">scatter</span><span class="hljs-params">(<span class="hljs-type">const</span> ray&amp; r_in, <span class="hljs-type">const</span> hit_record&amp; rec, color&amp; attenuation, ray&amp; scattered)</span>
<span class="line"></span>    <span class="hljs-type">const</span> <span class="hljs-keyword">override</span> </span>{<div class=" highlight"><span class="line"></span>        <span class="hljs-keyword">auto</span> scatter_direction = <span class="hljs-built_in">random_on_hemisphere</span>(rec.normal);</div><span class="line"></span>
<span class="line"></span>        <span class="hljs-comment">// Catch degenerate scatter direction</span>
<span class="line"></span>        <span class="hljs-keyword">if</span> (scatter_direction.<span class="hljs-built_in">near_zero</span>())
<span class="line"></span>            scatter_direction = rec.normal;
<span class="line"></span>
<span class="line"></span>        scattered = <span class="hljs-built_in">ray</span>(rec.p, scatter_direction, r_in.<span class="hljs-built_in">time</span>());
<span class="line"></span>        attenuation = tex-&gt;<span class="hljs-built_in">value</span>(rec.u, rec.v, rec.p);
<span class="line"></span>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
<span class="line"></span>    }
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>    <span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">scattering_pdf</span><span class="hljs-params">(<span class="hljs-type">const</span> ray&amp; r_in, <span class="hljs-type">const</span> hit_record&amp; rec, <span class="hljs-type">const</span> ray&amp; scattered)</span> <span class="hljs-type">const</span> </span>{<div class=" highlight"><span class="line"></span>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span> / (<span class="hljs-number">2</span>*pi);</div><span class="line"></span>    }
<span class="line"></span>
<span class="line"></span>    ...</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_scatter-mod">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;23:</b> <kbd>[material.h]</kbd> Modified PDF and scatter function</div></center>
<p>


This new diffuse material is actually just <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-340-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3790" style="width: 4.651em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.825em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.984em, 1003.83em, 3.05em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-3791"><span class="mi" id="MathJax-Span-3792"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-3793"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-3794"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3795"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-3796" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-3797"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-3798" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-3799" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.139em, 1000.31em, 2.172em, -999.997em); top: -2.425em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-3800" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.57em, 2.172em, -999.997em); top: -1.392em; left: 50%; margin-left: -0.256em;"><span class="mrow" id="MathJax-Span-3801"><span class="mn" id="MathJax-Span-3802" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-3803" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.67em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.674em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.809em; border-left: 0px solid; width: 0px; height: 2.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><msub><mi>ω</mi><mi>o</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mi>π</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-340">p(\omega_o) = \frac{1}{2\pi}</script> for the scattering PDF. So
our uniform PDF that was an imperfect match for Lambertian diffuse is actually a perfect match for
our uniform hemispherical diffuse. When rendering, we should get a slightly different image.

</p><p>

  </p><center><div class="image" style=""><a href="./input_files/img-3.04-cornell-refactor2.jpg" target="_blank"><img class="markdeep pixel" src="./input_files/img-3.04-cornell-refactor2.jpg"></a><center><span class="imagecaption"><span class="num">Image 5:</span> Cornell box, with uniform hemispherical sampling
  </span></center></div></center>

<p></p><p>

It’s pretty close to our old picture, but there are differences that are not just noise. The front
of the tall box is much more uniform in color. If you aren't sure what the best sampling pattern for
your material is, it's pretty reasonable to just go ahead and assume a uniform PDF, and while that
might converge slowly, it's not going to ruin your render. That said, if you're not sure what the
correct sampling pattern for your material is, your choice of PDF is not going to be your biggest
concern, as incorrectly choosing your scattering function <em class="underscore">will</em> ruin your render. At the very least
it will produce an incorrect result. You may find yourself with the most difficult kind of bug to
find in a Monte Carlo program — a bug that produces a reasonable looking image! You won’t know if
the bug is in the first version of the program, or the second, or both!

</p><p>

Let’s build some infrastructure to address this.

</p>
<a class="target" name="generatingrandomdirections">&nbsp;</a><a class="target" name="generatingrandomdirections">&nbsp;</a><a class="target" name="toc7">&nbsp;</a><h1>Generating Random Directions</h1>
<p>

In this and the next two chapters, we'll harden our understanding and our tools.

</p>
<a class="target" name="randomdirectionsrelativetothezaxis">&nbsp;</a><a class="target" name="generatingrandomdirections/randomdirectionsrelativetothezaxis">&nbsp;</a><a class="target" name="toc7.1">&nbsp;</a><h2>Random Directions Relative to the Z Axis</h2>
<p>

Let’s first figure out how to generate random directions. We already have a method to generate
random directions using the rejection method, so let's create one using the inversion method. To
simplify things, assume the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-341-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3804" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.364em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3805"><span class="mi" id="MathJax-Span-3806"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">z</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-341">z</script> axis is the surface normal, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-342-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3807" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3808"><span class="mi" id="MathJax-Span-3809"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-342">\theta</script> is the angle from the
normal. We'll set everything up in terms of the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-343-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3810" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.364em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3811"><span class="mi" id="MathJax-Span-3812"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">z</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-343">z</script> axis this chapter. Next chapter we’ll get them
oriented to the surface normal vector. We will only deal with distributions that are rotationally
symmetric about <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-344-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3813" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.364em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3814"><span class="mi" id="MathJax-Span-3815"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">z</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-344">z</script>. So <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-345-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3816" style="width: 4.651em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.825em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1003.83em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-3817"><span class="mi" id="MathJax-Span-3818"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-3819"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-3820"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span class="mo" id="MathJax-Span-3821"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-3822" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-3823" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-3824"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-3825"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-3826"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-345">p(\omega) = f(\theta)</script>.

</p><p>

Given a directional PDF on the sphere (where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-346-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3827" style="width: 4.651em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.825em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1003.83em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-3828"><span class="mi" id="MathJax-Span-3829"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-3830"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-3831"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span class="mo" id="MathJax-Span-3832"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-3833" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-3834" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-3835"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-3836"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-3837"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-346">p(\omega) = f(\theta)</script>), the one dimensional PDFs on
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-347-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3838" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3839"><span class="mi" id="MathJax-Span-3840"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-347">\theta</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-348-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3841" style="width: 0.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3842"><span class="mi" id="MathJax-Span-3843"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ϕ</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϕ</mi></math></span></span><script type="math/tex" id="MathJax-Element-348">\phi</script> are:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-349-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3844" style="width: 4.445em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.67em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1003.67em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-3845"><span class="mi" id="MathJax-Span-3846"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mo" id="MathJax-Span-3847"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-3848"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ϕ</span></span><span class="mo" id="MathJax-Span-3849"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-3850" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-3851" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-3852"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.83em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.411em;"><span class="mrow" id="MathJax-Span-3853"><span class="mn" id="MathJax-Span-3854"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-3855"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.93em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.932em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>a</mi><mo stretchy="false">(</mo><mi>ϕ</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mi>π</mi></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-349"> a(\phi) = \frac{1}{2\pi} </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-350-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3856" style="width: 8.009em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.614em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1006.61em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-3857"><span class="mi" id="MathJax-Span-3858"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">b</span></span><span class="mo" id="MathJax-Span-3859"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-3860"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-3861"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-3862" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-3863" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-3864"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span class="mi" id="MathJax-Span-3865"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-3866"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-3867"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-3868"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mi" id="MathJax-Span-3869" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mo" id="MathJax-Span-3870"></span><span class="mo" id="MathJax-Span-3871"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-3872"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-3873"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>b</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mn>2</mn><mi>π</mi><mi>f</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-350"> b(\theta) = 2\pi f(\theta)\sin(\theta) </script>

</p><p>

For uniform random numbers <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-351-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3874" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.054em, 1000.62em, 1.501em, -999.997em); top: -0.979em; left: 0em;"><span class="mrow" id="MathJax-Span-3875"><span class="msubsup" id="MathJax-Span-3876"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3877"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-3878" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.984em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>r</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-351">r_1</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-352-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3879" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.054em, 1000.62em, 1.501em, -999.997em); top: -0.979em; left: 0em;"><span class="mrow" id="MathJax-Span-3880"><span class="msubsup" id="MathJax-Span-3881"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3882"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-3883" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.984em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>r</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-352">r_2</script>, we solve for the CDF of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-353-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3884" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3885"><span class="mi" id="MathJax-Span-3886"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-353">\theta</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-354-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3887" style="width: 0.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3888"><span class="mi" id="MathJax-Span-3889"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ϕ</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϕ</mi></math></span></span><script type="math/tex" id="MathJax-Element-354">\phi</script> so that we
can invert the CDF to derive the random number generator.

</p><p>

    <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Error" id="MathJax-Element-355-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>r</mi><mn>1</mn></msub><mo>=</mo><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>ϕ</mi></mrow></msubsup><mi>a</mi><mo stretchy="false">(</mo><msup><mi>ϕ</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mi>d</mi><msup><mi>ϕ</mi><mo>′</mo></msup></math></span></span><script type="math/tex; mode=display" id="MathJax-Element-355"> r_1 = \int_{0}^{\phi} a(\phi') d\phi' </script>
    <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Error" id="MathJax-Element-356-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>=</mo><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>ϕ</mi></mrow></msubsup><mfrac><mn>1</mn><mrow><mn>2</mn><mi>π</mi></mrow></mfrac><mi>d</mi><msup><mi>ϕ</mi><mo>′</mo></msup></math></span></span><script type="math/tex; mode=display" id="MathJax-Element-356"> = \int_{0}^{\phi} \frac{1}{2\pi} d\phi' </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-357-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3929" style="width: 2.379em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.965em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1001.97em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-3930"><span class="mo" id="MathJax-Span-3931"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-3932" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.256em;"><span class="mi" id="MathJax-Span-3933"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ϕ</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.83em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.411em;"><span class="mrow" id="MathJax-Span-3934"><span class="mn" id="MathJax-Span-3935"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-3936"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.93em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.932em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>=</mo><mfrac><mi>ϕ</mi><mrow><mn>2</mn><mi>π</mi></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-357"> = \frac{\phi}{2\pi} </script>

</p><p>

Invert to solve for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-358-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3937" style="width: 0.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3938"><span class="mi" id="MathJax-Span-3939"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ϕ</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϕ</mi></math></span></span><script type="math/tex" id="MathJax-Element-358">\phi</script>:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-359-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3940" style="width: 4.496em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.722em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1003.72em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-3941"><span class="mi" id="MathJax-Span-3942"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ϕ</span></span><span class="mo" id="MathJax-Span-3943" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-3944" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-3945"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span class="mo" id="MathJax-Span-3946" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="msubsup" id="MathJax-Span-3947" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-3948"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-3949" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>ϕ</mi><mo>=</mo><mn>2</mn><mi>π</mi><mo>⋅</mo><msub><mi>r</mi><mn>1</mn></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-359"> \phi = 2 \pi \cdot r_1 </script>

</p><p>

This should match with your intuition. To solve for a random <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-360-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3950" style="width: 0.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3951"><span class="mi" id="MathJax-Span-3952"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ϕ</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϕ</mi></math></span></span><script type="math/tex" id="MathJax-Element-360">\phi</script> you can take a uniform random
number in the interval [0,1] and multiply by <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-361-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3953" style="width: 1.036em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.83em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3954"><span class="mn" id="MathJax-Span-3955"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-3956"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-361">2\pi</script> to cover the full range of all possible <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-362-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3957" style="width: 0.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3958"><span class="mi" id="MathJax-Span-3959"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ϕ</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϕ</mi></math></span></span><script type="math/tex" id="MathJax-Element-362">\phi</script>
values, which is just [0,<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-363-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3960" style="width: 1.036em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.83em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3961"><span class="mn" id="MathJax-Span-3962"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-3963"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-363">2\pi</script>]. You may not have a fully formed intuition for how to solve for a
random value of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-364-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3964" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3965"><span class="mi" id="MathJax-Span-3966"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-364">\theta</script>, so let's walk through the math to help you get set up. We rewrite <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-365-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3967" style="width: 0.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3968"><span class="mi" id="MathJax-Span-3969"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ϕ</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϕ</mi></math></span></span><script type="math/tex" id="MathJax-Element-365">\phi</script>
as <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_Error" id="MathJax-Element-366-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>ϕ</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-366">\phi'</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-367-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3975" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3976"><span class="mi" id="MathJax-Span-3977"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-367">\theta</script> as <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_Error" id="MathJax-Element-368-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>θ</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-368">\theta'</script> just like before, as a formality. For <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-369-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3983" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-3984"><span class="mi" id="MathJax-Span-3985"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-369">\theta</script> we have:

</p><p>

    <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Error" id="MathJax-Element-370-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>r</mi><mn>2</mn></msub><mo>=</mo><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>θ</mi></mrow></msubsup><mi>b</mi><mo stretchy="false">(</mo><msup><mi>θ</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mi>d</mi><msup><mi>θ</mi><mo>′</mo></msup></math></span></span><script type="math/tex; mode=display" id="MathJax-Element-370"> r_2 = \int_{0}^{\theta} b(\theta') d\theta' </script>
    <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Error" id="MathJax-Element-371-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>=</mo><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>θ</mi></mrow></msubsup><mn>2</mn><mi>π</mi><mi>f</mi><mo stretchy="false">(</mo><msup><mi>θ</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><msup><mi>θ</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mi>d</mi><msup><mi>θ</mi><mo>′</mo></msup></math></span></span><script type="math/tex; mode=display" id="MathJax-Element-371"> = \int_{0}^{\theta} 2 \pi f(\theta') \sin(\theta') d\theta' </script>

</p><p>

Let’s try some different functions for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-372-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4023" style="width: 1.036em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.83em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-4024"><span class="mi" id="MathJax-Span-4025"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-4026"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mo" id="MathJax-Span-4027"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-372">f()</script>. Let’s first try a uniform density on the sphere. The
area of the unit sphere is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-373-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4028" style="width: 1.036em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.83em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-4029"><span class="mn" id="MathJax-Span-4030"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">4</span></span><span class="mi" id="MathJax-Span-4031"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>4</mn><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-373">4\pi</script>, so a uniform <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-374-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4032" style="width: 4.186em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.463em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.984em, 1003.46em, 3.05em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4033"><span class="mi" id="MathJax-Span-4034"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-4035"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4036"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span class="mo" id="MathJax-Span-4037"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-4038" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-4039" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.139em, 1000.31em, 2.172em, -999.997em); top: -2.425em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-4040" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.57em, 2.172em, -999.997em); top: -1.392em; left: 50%; margin-left: -0.256em;"><span class="mrow" id="MathJax-Span-4041"><span class="mn" id="MathJax-Span-4042" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">4</span></span><span class="mi" id="MathJax-Span-4043" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.67em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.674em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.809em; border-left: 0px solid; width: 0px; height: 2.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>4</mn><mi>π</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-374">p(\omega) = \frac{1}{4\pi}</script> on the unit sphere.

</p><p>

    <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Error" id="MathJax-Element-375-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>r</mi><mn>2</mn></msub><mo>=</mo><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>θ</mi></mrow></msubsup><mn>2</mn><mi>π</mi><mfrac><mn>1</mn><mrow><mn>4</mn><mi>π</mi></mrow></mfrac><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><msup><mi>θ</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mi>d</mi><msup><mi>θ</mi><mo>′</mo></msup></math></span></span><script type="math/tex; mode=display" id="MathJax-Element-375"> r_2 = \int_{0}^{\theta} 2 \pi \frac{1}{4\pi} \sin(\theta') d\theta' </script>
    <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Error" id="MathJax-Element-376-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>=</mo><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>θ</mi></mrow></msubsup><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><msup><mi>θ</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mi>d</mi><msup><mi>θ</mi><mo>′</mo></msup></math></span></span><script type="math/tex; mode=display" id="MathJax-Element-376"> = \int_{0}^{\theta} \frac{1}{2} \sin(\theta') d\theta' </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-377-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4091" style="width: 9.713em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.009em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1008.01em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4092"><span class="mo" id="MathJax-Span-4093"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-4094" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 2.895em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.346em, 1002.79em, 2.637em, -999.997em); top: -2.942em; left: 50%; margin-left: -1.392em;"><span class="mrow" id="MathJax-Span-4095"><span class="mo" id="MathJax-Span-4096"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mi" id="MathJax-Span-4097" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-4098"></span><span class="mo" id="MathJax-Span-4099"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4100"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-4101"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-4102"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1002.89em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.895em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mo" id="MathJax-Span-4103" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mfrac" id="MathJax-Span-4104" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 2.895em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.346em, 1002.79em, 2.637em, -999.997em); top: -2.942em; left: 50%; margin-left: -1.392em;"><span class="mrow" id="MathJax-Span-4105"><span class="mo" id="MathJax-Span-4106"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mi" id="MathJax-Span-4107" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-4108"></span><span class="mo" id="MathJax-Span-4109"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-4110"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span class="mo" id="MathJax-Span-4111"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-4112"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1002.89em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.895em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>=</mo><mfrac><mrow><mo>−</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><mn>2</mn></mfrac><mo>−</mo><mfrac><mrow><mo>−</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><mn>2</mn></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-377"> = \frac{-\cos(\theta)}{2} - \frac{-\cos(0)}{2} </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-378-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4113" style="width: 5.581em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.6em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1004.6em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4114"><span class="mo" id="MathJax-Span-4115"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-4116" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 3.567em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.346em, 1003.46em, 2.637em, -999.997em); top: -2.942em; left: 50%; margin-left: -1.702em;"><span class="mrow" id="MathJax-Span-4117"><span class="mn" id="MathJax-Span-4118"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-4119" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mi" id="MathJax-Span-4120" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-4121"></span><span class="mo" id="MathJax-Span-4122"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4123"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-4124"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-4125"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1003.57em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.567em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>=</mo><mfrac><mrow><mn>1</mn><mo>−</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><mn>2</mn></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-378"> = \frac{1 - \cos(\theta)}{2} </script>

</p><p>

Solving for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-379-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4126" style="width: 2.534em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.069em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1002.07em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-4127"><span class="mi" id="MathJax-Span-4128"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-4129"></span><span class="mo" id="MathJax-Span-4130"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4131"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-4132"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-379">\cos(\theta)</script> gives:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-380-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4133" style="width: 6.769em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.581em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1005.58em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4134"><span class="mi" id="MathJax-Span-4135"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-4136"></span><span class="mo" id="MathJax-Span-4137"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4138"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-4139"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-4140" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-4141" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-4142" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mn" id="MathJax-Span-4143" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="msubsup" id="MathJax-Span-4144"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4145"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-4146" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>−</mo><mn>2</mn><msub><mi>r</mi><mn>2</mn></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-380"> \cos(\theta) = 1 - 2 r_2 </script>

</p><p>

We don’t solve for theta because we probably only need to know <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-381-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4147" style="width: 2.534em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.069em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1002.07em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-4148"><span class="mi" id="MathJax-Span-4149"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-4150"></span><span class="mo" id="MathJax-Span-4151"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4152"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-4153"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-381">\cos(\theta)</script> anyway, and don’t want
needless <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-382-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;arccos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4154" style="width: 3.257em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.689em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1002.69em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-4155"><span class="mi" id="MathJax-Span-4156"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-4157"></span><span class="mo" id="MathJax-Span-4158"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mo" id="MathJax-Span-4159"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>arccos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-382">\arccos()</script> calls running around.

</p><p>

To generate a unit vector direction toward <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-383-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4160" style="width: 2.275em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.862em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1001.86em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4161"><span class="mo" id="MathJax-Span-4162"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4163"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-4164"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-4165" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ϕ</span></span><span class="mo" id="MathJax-Span-4166"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>θ</mi><mo>,</mo><mi>ϕ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-383">(\theta,\phi)</script> we convert to Cartesian coordinates:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-384-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4167" style="width: 7.596em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.253em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1006.25em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4168"><span class="mi" id="MathJax-Span-4169"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-4170" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-4171" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-4172"></span><span class="mo" id="MathJax-Span-4173"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4174"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ϕ</span></span><span class="mo" id="MathJax-Span-4175"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-4176" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mi" id="MathJax-Span-4177" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mo" id="MathJax-Span-4178"></span><span class="mo" id="MathJax-Span-4179"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4180"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-4181"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>x</mi><mo>=</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>ϕ</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-384"> x = \cos(\phi) \cdot \sin(\theta) </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-385-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4182" style="width: 7.441em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.149em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1006.15em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4183"><span class="mi" id="MathJax-Span-4184"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">y</span></span><span class="mo" id="MathJax-Span-4185" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-4186" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mo" id="MathJax-Span-4187"></span><span class="mo" id="MathJax-Span-4188"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4189"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ϕ</span></span><span class="mo" id="MathJax-Span-4190"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-4191" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mi" id="MathJax-Span-4192" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mo" id="MathJax-Span-4193"></span><span class="mo" id="MathJax-Span-4194"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4195"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-4196"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>y</mi><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>ϕ</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-385"> y = \sin(\phi) \cdot \sin(\theta) </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-386-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4197" style="width: 4.29em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.515em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1003.51em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4198"><span class="mi" id="MathJax-Span-4199"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">z</span></span><span class="mo" id="MathJax-Span-4200" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-4201" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-4202"></span><span class="mo" id="MathJax-Span-4203"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4204"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-4205"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>z</mi><mo>=</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-386"> z = \cos(\theta) </script>

</p><p>

And using the identity <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-387-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4206" style="width: 6.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.168em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.036em, 1005.17em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4207"><span class="msubsup" id="MathJax-Span-4208"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1001.09em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4209"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.373em; left: 1.087em;"><span class="mn" id="MathJax-Span-4210" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-4211" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">+</span></span><span class="msubsup" id="MathJax-Span-4212" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.346em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.98em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4213"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.373em; left: 0.984em;"><span class="mn" id="MathJax-Span-4214" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-4215" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-4216" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>cos</mi><mn>2</mn></msup><mo>+</mo><msup><mi>sin</mi><mn>2</mn></msup><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-387">\cos^2 + \sin^2 = 1</script>, we get the following in terms of random <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-388-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4217" style="width: 2.637em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.172em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1002.17em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4218"><span class="mo" id="MathJax-Span-4219"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-4220"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4221"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-4222" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-4223"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-4224" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4225"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-4226" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-4227"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>r</mi><mn>1</mn></msub><mo>,</mo><msub><mi>r</mi><mn>2</mn></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-388">(r_1,r_2)</script>:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-389-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msqrt&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/msqrt&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4228" style="width: 13.071em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.798em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.932em, 1010.8em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4229"><span class="mi" id="MathJax-Span-4230"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-4231" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-4232" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-4233"></span><span class="mo" id="MathJax-Span-4234"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-4235"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-4236"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span class="mo" id="MathJax-Span-4237" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="msubsup" id="MathJax-Span-4238" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4239"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-4240" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-4241"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="msqrt" id="MathJax-Span-4242"><span style="display: inline-block; position: relative; width: 5.529em; height: 0px;"><span style="position: absolute; clip: rect(1.139em, 1004.75em, 2.792em, -999.997em); top: -2.27em; left: 0.777em;"><span class="mrow" id="MathJax-Span-4243"><span class="mn" id="MathJax-Span-4244"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-4245" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mo" id="MathJax-Span-4246" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-4247"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-4248" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mn" id="MathJax-Span-4249" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="msubsup" id="MathJax-Span-4250"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4251"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-4252" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4253"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mo" id="MathJax-Span-4254"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.27em; left: 0.261em;"><span class="mn" id="MathJax-Span-4255" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(0.984em, 1004.75em, 1.294em, -999.997em); top: -2.322em; left: 0.777em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 4.755em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span><span style="position: absolute; clip: rect(3.05em, 1000.78em, 4.341em, -999.997em); top: -4.388em; left: 0em;"><span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">√</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 2.003em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>x</mi><mo>=</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><mo>⋅</mo><msub><mi>r</mi><mn>1</mn></msub><mo stretchy="false">)</mo><msqrt><mn>1</mn><mo>−</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mn>2</mn><msub><mi>r</mi><mn>2</mn></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></msqrt></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-389"> x = \cos(2\pi \cdot r_1)\sqrt{1 - (1-2 r_2)^2} </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-390-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msqrt&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/msqrt&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4256" style="width: 12.916em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.643em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.932em, 1010.64em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4257"><span class="mi" id="MathJax-Span-4258"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">y</span></span><span class="mo" id="MathJax-Span-4259" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-4260" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mo" id="MathJax-Span-4261"></span><span class="mo" id="MathJax-Span-4262"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-4263"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-4264"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span class="mo" id="MathJax-Span-4265" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="msubsup" id="MathJax-Span-4266" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4267"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-4268" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-4269"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="msqrt" id="MathJax-Span-4270"><span style="display: inline-block; position: relative; width: 5.529em; height: 0px;"><span style="position: absolute; clip: rect(1.139em, 1004.75em, 2.792em, -999.997em); top: -2.27em; left: 0.777em;"><span class="mrow" id="MathJax-Span-4271"><span class="mn" id="MathJax-Span-4272"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-4273" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mo" id="MathJax-Span-4274" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-4275"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-4276" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mn" id="MathJax-Span-4277" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="msubsup" id="MathJax-Span-4278"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4279"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-4280" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4281"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mo" id="MathJax-Span-4282"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.27em; left: 0.261em;"><span class="mn" id="MathJax-Span-4283" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(0.984em, 1004.75em, 1.294em, -999.997em); top: -2.322em; left: 0.777em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 4.755em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span><span style="position: absolute; clip: rect(3.05em, 1000.78em, 4.341em, -999.997em); top: -4.388em; left: 0em;"><span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">√</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 2.003em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>y</mi><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><mo>⋅</mo><msub><mi>r</mi><mn>1</mn></msub><mo stretchy="false">)</mo><msqrt><mn>1</mn><mo>−</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mn>2</mn><msub><mi>r</mi><mn>2</mn></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></msqrt></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-390"> y = \sin(2\pi \cdot r_1)\sqrt{1 - (1-2 r_2)^2} </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-391-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4284" style="width: 4.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.877em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1003.88em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4285"><span class="mi" id="MathJax-Span-4286"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">z</span></span><span class="mo" id="MathJax-Span-4287" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-4288" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-4289" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mn" id="MathJax-Span-4290" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="msubsup" id="MathJax-Span-4291"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4292"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-4293" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>z</mi><mo>=</mo><mn>1</mn><mo>−</mo><mn>2</mn><msub><mi>r</mi><mn>2</mn></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-391"> z = 1 - 2  r_2 </script>

</p><p>

Simplifying a little, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-392-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;msubsup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4294" style="width: 10.746em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.887em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.087em, 1008.89em, 2.998em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4295"><span class="mo" id="MathJax-Span-4296"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-4297"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-4298" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mn" id="MathJax-Span-4299" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="msubsup" id="MathJax-Span-4300"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4301"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-4302" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4303"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mo" id="MathJax-Span-4304"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.218em; left: 0.261em;"><span class="mn" id="MathJax-Span-4305" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-4306" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-4307" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-4308" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mn" id="MathJax-Span-4309" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">4</span></span><span class="msubsup" id="MathJax-Span-4310"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4311"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-4312" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-4313" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">+</span></span><span class="mn" id="MathJax-Span-4314" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">4</span></span><span class="msubsup" id="MathJax-Span-4315"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4316"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -2.322em; left: 0.261em;"><span class="mn" id="MathJax-Span-4317" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -1.444em; left: 0.261em;"><span class="mn" id="MathJax-Span-4318" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.747em; border-left: 0px solid; width: 0px; height: 2.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mn>2</mn><msub><mi>r</mi><mn>2</mn></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>=</mo><mn>1</mn><mo>−</mo><mn>4</mn><msub><mi>r</mi><mn>2</mn></msub><mo>+</mo><mn>4</mn><msubsup><mi>r</mi><mn>2</mn><mn>2</mn></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-392">(1 - 2 r_2)^2 = 1 - 4r_2 + 4r_2^2</script>, so:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-393-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;msqrt&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/msqrt&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4319" style="width: 11.728em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.662em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.087em, 1009.66em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4320"><span class="mi" id="MathJax-Span-4321"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-4322" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-4323" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-4324"></span><span class="mo" id="MathJax-Span-4325"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-4326"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-4327"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span class="msubsup" id="MathJax-Span-4328"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4329"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-4330" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-4331"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-4332" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mn" id="MathJax-Span-4333" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="msqrt" id="MathJax-Span-4334"><span style="display: inline-block; position: relative; width: 3.98em; height: 0px;"><span style="position: absolute; clip: rect(1.346em, 1003.21em, 2.792em, -999.997em); top: -2.27em; left: 0.777em;"><span class="mrow" id="MathJax-Span-4335"><span class="msubsup" id="MathJax-Span-4336"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4337"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-4338" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-4339"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-4340"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-4341" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="msubsup" id="MathJax-Span-4342" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4343"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-4344" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-4345"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(0.984em, 1003.21em, 1.294em, -999.997em); top: -2.167em; left: 0.777em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 3.205em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span><span style="position: absolute; clip: rect(3.05em, 1000.78em, 4.341em, -999.997em); top: -4.181em; left: 0em;"><span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">√</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.816em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>x</mi><mo>=</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><msub><mi>r</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>⋅</mo><mn>2</mn><msqrt><msub><mi>r</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>r</mi><mn>2</mn></msub><mo stretchy="false">)</mo></msqrt></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-393"> x = \cos(2 \pi r_1) \cdot 2 \sqrt{r_2(1 - r_2)} </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-394-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;msqrt&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/msqrt&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4346" style="width: 11.573em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.558em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.087em, 1009.56em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4347"><span class="mi" id="MathJax-Span-4348"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">y</span></span><span class="mo" id="MathJax-Span-4349" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-4350" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mo" id="MathJax-Span-4351"></span><span class="mo" id="MathJax-Span-4352"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-4353"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-4354"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span class="msubsup" id="MathJax-Span-4355"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4356"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-4357" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-4358"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-4359" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mn" id="MathJax-Span-4360" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="msqrt" id="MathJax-Span-4361"><span style="display: inline-block; position: relative; width: 3.98em; height: 0px;"><span style="position: absolute; clip: rect(1.346em, 1003.21em, 2.792em, -999.997em); top: -2.27em; left: 0.777em;"><span class="mrow" id="MathJax-Span-4362"><span class="msubsup" id="MathJax-Span-4363"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4364"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-4365" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-4366"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-4367"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-4368" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="msubsup" id="MathJax-Span-4369" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4370"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-4371" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-4372"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(0.984em, 1003.21em, 1.294em, -999.997em); top: -2.167em; left: 0.777em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 3.205em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span><span style="position: absolute; clip: rect(3.05em, 1000.78em, 4.341em, -999.997em); top: -4.181em; left: 0em;"><span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">√</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.816em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>y</mi><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><msub><mi>r</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>⋅</mo><mn>2</mn><msqrt><msub><mi>r</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>r</mi><mn>2</mn></msub><mo stretchy="false">)</mo></msqrt></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-394"> y = \sin(2 \pi r_1) \cdot 2 \sqrt{r_2(1 - r_2)} </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-395-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4373" style="width: 4.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.877em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1003.88em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4374"><span class="mi" id="MathJax-Span-4375"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">z</span></span><span class="mo" id="MathJax-Span-4376" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-4377" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-4378" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mn" id="MathJax-Span-4379" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="msubsup" id="MathJax-Span-4380"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4381"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-4382" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>z</mi><mo>=</mo><mn>1</mn><mo>−</mo><mn>2</mn><msub><mi>r</mi><mn>2</mn></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-395"> z = 1 - 2 r_2 </script>

</p><p>

</p><div class="together">
We can output some of these:

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"rtweekend.h"</span></span>
<span class="line"></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;math.h&gt;</span></span>
<span class="line"></span>
<span class="line"></span><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
<span class="line"></span>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">200</span>; i++) {
<span class="line"></span>        <span class="hljs-keyword">auto</span> r1 = <span class="hljs-built_in">random_double</span>();
<span class="line"></span>        <span class="hljs-keyword">auto</span> r2 = <span class="hljs-built_in">random_double</span>();
<span class="line"></span>        <span class="hljs-keyword">auto</span> x = <span class="hljs-built_in">cos</span>(<span class="hljs-number">2</span>*pi*r1)*<span class="hljs-number">2</span>*<span class="hljs-built_in">sqrt</span>(r2*(<span class="hljs-number">1</span>-r2));
<span class="line"></span>        <span class="hljs-keyword">auto</span> y = <span class="hljs-built_in">sin</span>(<span class="hljs-number">2</span>*pi*r1)*<span class="hljs-number">2</span>*<span class="hljs-built_in">sqrt</span>(r2*(<span class="hljs-number">1</span>-r2));
<span class="line"></span>        <span class="hljs-keyword">auto</span> z = <span class="hljs-number">1</span> - <span class="hljs-number">2</span>*r2;
<span class="line"></span>        std::cout &lt;&lt; x &lt;&lt; <span class="hljs-string">" "</span> &lt;&lt; y &lt;&lt; <span class="hljs-string">" "</span> &lt;&lt; z &lt;&lt; <span class="hljs-string">'\n'</span>;
<span class="line"></span>    }
<span class="line"></span>}</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_rand-unit-sphere-plot">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;24:</b> <kbd>[sphere_plot.cc]</kbd> Random points on the unit sphere</div></center>
<p>


</p></div>

<p></p><p>

</p><div class="together">
And plot them for free on plot.ly (a great site with 3D scatterplot support):

<p></p><p>

  </p><center><div class="image" style=""><a href="./input_files/fig-3.10-rand-pts-sphere.jpg" target="_blank"><img class="markdeep" src="./input_files/fig-3.10-rand-pts-sphere.jpg"></a><center><span class="imagecaption"><a class="target" name="figure_rand-pts-sphere">&nbsp;</a><b style="font-style:normal;">Figure&nbsp;10:</b> Random points on the unit sphere
  </span></center></div></center>

<p></p><p>

On the plot.ly website you can rotate that around and see that it appears uniform.

</p><p>

</p></div>

<p></p>
<a class="target" name="uniformsamplingahemisphere">&nbsp;</a><a class="target" name="generatingrandomdirections/uniformsamplingahemisphere">&nbsp;</a><a class="target" name="toc7.2">&nbsp;</a><h2>Uniform Sampling a Hemisphere</h2>
<p>

Now let’s derive uniform on the hemisphere. The density being uniform on the hemisphere means
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-396-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4383" style="width: 7.027em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.788em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.984em, 1005.79em, 3.05em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4384"><span class="mi" id="MathJax-Span-4385"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-4386"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4387"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span class="mo" id="MathJax-Span-4388"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-4389" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-4390" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-4391"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4392"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-4393"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-4394" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-4395" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.139em, 1000.31em, 2.172em, -999.997em); top: -2.425em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-4396" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.57em, 2.172em, -999.997em); top: -1.392em; left: 50%; margin-left: -0.256em;"><span class="mrow" id="MathJax-Span-4397"><span class="mn" id="MathJax-Span-4398" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-4399" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.67em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.674em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.809em; border-left: 0px solid; width: 0px; height: 2.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mi>π</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-396">p(\omega) = f(\theta) = \frac{1}{2\pi}</script>. Just changing the constant in the theta equations yields:

</p><p>

    <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Error" id="MathJax-Element-397-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>r</mi><mn>2</mn></msub><mo>=</mo><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>θ</mi></mrow></msubsup><mi>b</mi><mo stretchy="false">(</mo><msup><mi>θ</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mi>d</mi><msup><mi>θ</mi><mo>′</mo></msup></math></span></span><script type="math/tex; mode=display" id="MathJax-Element-397"> r_2 = \int_{0}^{\theta} b(\theta') d\theta' </script>
    <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Error" id="MathJax-Element-398-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>=</mo><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>θ</mi></mrow></msubsup><mn>2</mn><mi>π</mi><mi>f</mi><mo stretchy="false">(</mo><msup><mi>θ</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><msup><mi>θ</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mi>d</mi><msup><mi>θ</mi><mo>′</mo></msup></math></span></span><script type="math/tex; mode=display" id="MathJax-Element-398"> = \int_{0}^{\theta} 2 \pi f(\theta') \sin(\theta') d\theta' </script>
    <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Error" id="MathJax-Element-399-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>=</mo><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>θ</mi></mrow></msubsup><mn>2</mn><mi>π</mi><mfrac><mn>1</mn><mrow><mn>2</mn><mi>π</mi></mrow></mfrac><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><msup><mi>θ</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mi>d</mi><msup><mi>θ</mi><mo>′</mo></msup></math></span></span><script type="math/tex; mode=display" id="MathJax-Element-399"> = \int_{0}^{\theta} 2 \pi \frac{1}{2\pi} \sin(\theta') d\theta' </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-400-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4461" style="width: 1.036em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.83em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-4462"><span class="mo" id="MathJax-Span-4463"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">…</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>…</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-400"> \ldots </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-401-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4464" style="width: 6.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.168em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1005.17em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4465"><span class="mi" id="MathJax-Span-4466"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-4467"></span><span class="mo" id="MathJax-Span-4468"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4469"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-4470"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-4471" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-4472" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-4473" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="msubsup" id="MathJax-Span-4474" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4475"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-4476" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>−</mo><msub><mi>r</mi><mn>2</mn></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-401"> \cos(\theta) = 1 - r_2 </script>

</p><p>

This means that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-402-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4477" style="width: 2.534em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.069em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1002.07em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-4478"><span class="mi" id="MathJax-Span-4479"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-4480"></span><span class="mo" id="MathJax-Span-4481"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4482"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-4483"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-402">\cos(\theta)</script> will vary from 1 to 0, so <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-403-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4484" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-4485"><span class="mi" id="MathJax-Span-4486"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-403">\theta</script> will vary from 0 to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-404-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4487" style="width: 1.346em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.087em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.09em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-4488"><span class="mi" id="MathJax-Span-4489"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span class="texatom" id="MathJax-Span-4490"><span class="mrow" id="MathJax-Span-4491"><span class="mo" id="MathJax-Span-4492"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="mn" id="MathJax-Span-4493"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-404">\pi/2</script>, which
means that nothing will go below the horizon. Rather than plot it, we'll solve for a 2D integral
with a known solution. Let’s integrate cosine cubed over the hemisphere (just picking something
arbitrary with a known solution). First we'll solve the integral by hand:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-405-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4494" style="width: 5.271em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.341em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.036em, 1004.34em, 2.843em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4495"><span class="msubsup" id="MathJax-Span-4496"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.637em, -999.997em); top: -2.218em; left: 0em;"><span class="mo" id="MathJax-Span-4497" style="vertical-align: -0.049em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∫</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.547em; left: 0.364em;"><span class="mi" id="MathJax-Span-4498" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4499" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1001.09em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4500"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.373em; left: 1.087em;"><span class="mn" id="MathJax-Span-4501" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">3</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-4502"></span><span class="mo" id="MathJax-Span-4503"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4504"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-4505"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mi" id="MathJax-Span-4506"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-4507"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">A</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left: 0px solid; width: 0px; height: 1.941em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mo>∫</mo><mi>ω</mi></msub><msup><mi>cos</mi><mn>3</mn></msup><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mi>d</mi><mi>A</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-405"> \int_\omega \cos^3(\theta) dA </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-406-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;msup&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4508" style="width: 11.624em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.61em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.036em, 1009.61em, 2.998em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4509"><span class="mo" id="MathJax-Span-4510"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="msubsup" id="MathJax-Span-4511" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.637em, -999.997em); top: -2.218em; left: 0em;"><span class="mo" id="MathJax-Span-4512" style="vertical-align: -0.049em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∫</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.62em, 2.172em, -999.997em); top: -2.322em; left: 0.364em;"><span class="texatom" id="MathJax-Span-4513"><span class="mrow" id="MathJax-Span-4514"><span class="mn" id="MathJax-Span-4515" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-4516" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -1.444em; left: 0.364em;"><span class="texatom" id="MathJax-Span-4517"><span class="mrow" id="MathJax-Span-4518"><span class="mn" id="MathJax-Span-4519" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4520" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.191em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.637em, -999.997em); top: -2.218em; left: 0em;"><span class="mo" id="MathJax-Span-4521" style="vertical-align: -0.049em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∫</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.83em, 2.172em, -999.997em); top: -2.322em; left: 0.364em;"><span class="texatom" id="MathJax-Span-4522"><span class="mrow" id="MathJax-Span-4523"><span class="mi" id="MathJax-Span-4524" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span class="texatom" id="MathJax-Span-4525"><span class="mrow" id="MathJax-Span-4526"><span class="mo" id="MathJax-Span-4527" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="mn" id="MathJax-Span-4528" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -1.444em; left: 0.364em;"><span class="texatom" id="MathJax-Span-4529"><span class="mrow" id="MathJax-Span-4530"><span class="mn" id="MathJax-Span-4531" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4532" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1001.09em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4533"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.373em; left: 1.087em;"><span class="mn" id="MathJax-Span-4534" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">3</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-4535"></span><span class="mo" id="MathJax-Span-4536"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4537"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-4538"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mi" id="MathJax-Span-4539" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mo" id="MathJax-Span-4540"></span><span class="mo" id="MathJax-Span-4541"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4542"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-4543"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mi" id="MathJax-Span-4544"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-4545"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mi" id="MathJax-Span-4546"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-4547"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ϕ</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.747em; border-left: 0px solid; width: 0px; height: 2.128em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>=</mo><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mn>2</mn><mi>π</mi></mrow></msubsup><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>π</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn></mrow></msubsup><msup><mi>cos</mi><mn>3</mn></msup><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mi>d</mi><mi>θ</mi><mi>d</mi><mi>ϕ</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-406"> = \int_{0}^{2 \pi} \int_{0}^{\pi /2} \cos^3(\theta) \sin(\theta) d\theta d\phi </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-407-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;msup&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4548" style="width: 12.503em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.333em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1010.33em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4549"><span class="mo" id="MathJax-Span-4550"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-4551" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-4552"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span class="msubsup" id="MathJax-Span-4553" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.191em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.637em, -999.997em); top: -2.218em; left: 0em;"><span class="mo" id="MathJax-Span-4554" style="vertical-align: -0.049em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∫</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.83em, 2.172em, -999.997em); top: -2.322em; left: 0.364em;"><span class="texatom" id="MathJax-Span-4555"><span class="mrow" id="MathJax-Span-4556"><span class="mi" id="MathJax-Span-4557" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span class="texatom" id="MathJax-Span-4558"><span class="mrow" id="MathJax-Span-4559"><span class="mo" id="MathJax-Span-4560" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="mn" id="MathJax-Span-4561" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -1.444em; left: 0.364em;"><span class="texatom" id="MathJax-Span-4562"><span class="mrow" id="MathJax-Span-4563"><span class="mn" id="MathJax-Span-4564" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4565" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1001.09em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4566"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.373em; left: 1.087em;"><span class="mn" id="MathJax-Span-4567" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">3</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-4568"></span><span class="mo" id="MathJax-Span-4569"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4570"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-4571"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mi" id="MathJax-Span-4572" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mo" id="MathJax-Span-4573"></span><span class="mo" id="MathJax-Span-4574"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4575"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-4576"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mi" id="MathJax-Span-4577"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-4578"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-4579" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-4580" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mi" id="MathJax-Span-4581"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-4582"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.52em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.519em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>=</mo><mn>2</mn><mi>π</mi><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>π</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn></mrow></msubsup><msup><mi>cos</mi><mn>3</mn></msup><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mi>d</mi><mi>θ</mi><mo>=</mo><mfrac><mi>π</mi><mn>2</mn></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-407"> = 2 \pi \int_{0}^{\pi/2} \cos^3(\theta) \sin(\theta) d\theta = \frac{\pi}{2} </script>

</p><p>

</p><div class="together">
Now for integration with importance sampling. <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-408-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4583" style="width: 4.186em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.463em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.984em, 1003.46em, 3.05em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4584"><span class="mi" id="MathJax-Span-4585"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-4586"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4587"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span class="mo" id="MathJax-Span-4588"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-4589" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-4590" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.139em, 1000.31em, 2.172em, -999.997em); top: -2.425em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-4591" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.57em, 2.172em, -999.997em); top: -1.392em; left: 50%; margin-left: -0.256em;"><span class="mrow" id="MathJax-Span-4592"><span class="mn" id="MathJax-Span-4593" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-4594" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.67em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.674em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.809em; border-left: 0px solid; width: 0px; height: 2.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mi>π</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-408">p(\omega) = \frac{1}{2\pi}</script>, so we average
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-409-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4595" style="width: 8.06em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.666em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.984em, 1006.67em, 3.05em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4596"><span class="mi" id="MathJax-Span-4597"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-4598"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mo" id="MathJax-Span-4599"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="texatom" id="MathJax-Span-4600"><span class="mrow" id="MathJax-Span-4601"><span class="mo" id="MathJax-Span-4602"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="mi" id="MathJax-Span-4603"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-4604"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mo" id="MathJax-Span-4605"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-4606" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="msubsup" id="MathJax-Span-4607" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1001.09em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4608"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.373em; left: 1.087em;"><span class="mn" id="MathJax-Span-4609" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">3</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-4610"></span><span class="mo" id="MathJax-Span-4611"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4612"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-4613"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="texatom" id="MathJax-Span-4614"><span class="mrow" id="MathJax-Span-4615"><span class="mo" id="MathJax-Span-4616"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="mfrac" id="MathJax-Span-4617"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.139em, 1000.31em, 2.172em, -999.997em); top: -2.425em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-4618" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.57em, 2.172em, -999.997em); top: -1.392em; left: 50%; margin-left: -0.256em;"><span class="mrow" id="MathJax-Span-4619"><span class="mn" id="MathJax-Span-4620" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-4621" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.67em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.674em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.809em; border-left: 0px solid; width: 0px; height: 2.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>p</mi><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo>=</mo><msup><mi>cos</mi><mn>3</mn></msup><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mfrac><mn>1</mn><mrow><mn>2</mn><mi>π</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-409">f()/p() = \cos^3(\theta) / \frac{1}{2\pi}</script>, and we can test this:

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"rtweekend.h"</span></span>
<span class="line"></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iomanip&gt;</span></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;math.h&gt;</span></span>
<span class="line"></span>
<span class="line"></span><span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">f</span><span class="hljs-params">(<span class="hljs-type">double</span> r2)</span> </span>{
<span class="line"></span>    <span class="hljs-comment">// auto x = cos(2*pi*r1)*2*sqrt(r2*(1-r2));</span>
<span class="line"></span>    <span class="hljs-comment">// auto y = sin(2*pi*r1)*2*sqrt(r2*(1-r2));</span>
<span class="line"></span>    <span class="hljs-keyword">auto</span> z = <span class="hljs-number">1</span> - r2;
<span class="line"></span>    <span class="hljs-type">double</span> cos_theta = z;
<span class="line"></span>    <span class="hljs-keyword">return</span> cos_theta*cos_theta*cos_theta;
<span class="line"></span>}
<span class="line"></span>
<span class="line"></span><span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">pdf</span><span class="hljs-params">()</span> </span>{
<span class="line"></span>    <span class="hljs-keyword">return</span> <span class="hljs-number">1.0</span> / (<span class="hljs-number">2.0</span>*pi);
<span class="line"></span>}
<span class="line"></span>
<span class="line"></span><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
<span class="line"></span>    <span class="hljs-type">int</span> N = <span class="hljs-number">1000000</span>;
<span class="line"></span>
<span class="line"></span>    <span class="hljs-keyword">auto</span> sum = <span class="hljs-number">0.0</span>;
<span class="line"></span>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; N; i++) {
<span class="line"></span>        <span class="hljs-keyword">auto</span> r2 = <span class="hljs-built_in">random_double</span>();
<span class="line"></span>        sum += <span class="hljs-built_in">f</span>(r2) / <span class="hljs-built_in">pdf</span>();
<span class="line"></span>    }
<span class="line"></span>
<span class="line"></span>    std::cout &lt;&lt; std::fixed &lt;&lt; std::<span class="hljs-built_in">setprecision</span>(<span class="hljs-number">12</span>);
<span class="line"></span>    std::cout &lt;&lt; <span class="hljs-string">"PI/2 = "</span> &lt;&lt; pi / <span class="hljs-number">2.0</span> &lt;&lt; <span class="hljs-string">'\n'</span>;
<span class="line"></span>    std::cout &lt;&lt; <span class="hljs-string">"Estimate = "</span> &lt;&lt; sum / N &lt;&lt; <span class="hljs-string">'\n'</span>;
<span class="line"></span>}</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_cos-cubed">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;25:</b> <kbd>[cos_cubed.cc]</kbd> Integration using <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-410-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4622" style="width: 2.947em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.43em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.139em, 1002.43em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-4623"><span class="mi" id="MathJax-Span-4624"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span></span><span class="mi" id="MathJax-Span-4625"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span class="msubsup" id="MathJax-Span-4626"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.31em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4627"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.218em; left: 0.313em;"><span class="mn" id="MathJax-Span-4628" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">3</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-4629"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4630"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-4631"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mi>o</mi><msup><mi>s</mi><mn>3</mn></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-410">cos^3(x)</script></div></center>
<p>


</p></div>

<p></p>
<a class="target" name="cosinesamplingahemisphere">&nbsp;</a><a class="target" name="generatingrandomdirections/cosinesamplingahemisphere">&nbsp;</a><a class="target" name="toc7.3">&nbsp;</a><h2>Cosine Sampling a Hemisphere</h2>
<p>

We'll now continue trying to solve for cosine cubed over the horizon, but we'll change our PDF to
generate directions with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-411-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4632" style="width: 9.248em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.647em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1007.65em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4633"><span class="mi" id="MathJax-Span-4634"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-4635"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4636"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span class="mo" id="MathJax-Span-4637"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-4638" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-4639" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-4640"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4641"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-4642"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-4643" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-4644" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-4645"></span><span class="mo" id="MathJax-Span-4646"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4647"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-4648"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="texatom" id="MathJax-Span-4649"><span class="mrow" id="MathJax-Span-4650"><span class="mo" id="MathJax-Span-4651"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="mi" id="MathJax-Span-4652"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-411">p(\omega) =  f(\theta) = \cos(\theta) / \pi</script>.

</p><p>

    <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Error" id="MathJax-Element-412-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>r</mi><mn>2</mn></msub><mo>=</mo><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>θ</mi></mrow></msubsup><mi>b</mi><mo stretchy="false">(</mo><msup><mi>θ</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mi>d</mi><msup><mi>θ</mi><mo>′</mo></msup></math></span></span><script type="math/tex; mode=display" id="MathJax-Element-412"> r_2 = \int_{0}^{\theta} b(\theta') d\theta' </script>
    <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Error" id="MathJax-Element-413-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>=</mo><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>θ</mi></mrow></msubsup><mn>2</mn><mi>π</mi><mi>f</mi><mo stretchy="false">(</mo><msup><mi>θ</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><msup><mi>θ</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mi>d</mi><msup><mi>θ</mi><mo>′</mo></msup></math></span></span><script type="math/tex; mode=display" id="MathJax-Element-413"> = \int_{0}^{\theta} 2 \pi f(\theta') \sin(\theta') d\theta' </script>
    <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Error" id="MathJax-Element-414-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/mfrac&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>=</mo><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>θ</mi></mrow></msubsup><mn>2</mn><mi>π</mi><mfrac><mrow><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><msup><mi>θ</mi><mo>′</mo></msup><mo stretchy="false">)</mo></mrow><mi>π</mi></mfrac><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><msup><mi>θ</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mi>d</mi><msup><mi>θ</mi><mo>′</mo></msup></math></span></span><script type="math/tex; mode=display" id="MathJax-Element-414"> = \int_{0}^{\theta} 2 \pi \frac{\cos(\theta')}{\pi} \sin(\theta') d\theta' </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-415-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4711" style="width: 5.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.651em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.036em, 1004.65em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4712"><span class="mo" id="MathJax-Span-4713"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-4714" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-4715" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="msubsup" id="MathJax-Span-4716" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1001.09em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4717"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.373em; left: 1.087em;"><span class="mn" id="MathJax-Span-4718" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-4719"></span><span class="mo" id="MathJax-Span-4720"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4721"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-4722"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.691em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>=</mo><mn>1</mn><mo>−</mo><msup><mi>cos</mi><mn>2</mn></msup><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-415"> = 1 - \cos^2(\theta) </script>

</p><p>

So,

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-416-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msqrt&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/msqrt&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4723" style="width: 7.182em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.943em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.087em, 1005.94em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4724"><span class="mi" id="MathJax-Span-4725"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-4726"></span><span class="mo" id="MathJax-Span-4727"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4728"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-4729"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-4730" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="msqrt" id="MathJax-Span-4731" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 2.792em; height: 0px;"><span style="position: absolute; clip: rect(1.346em, 1002.02em, 2.792em, -999.997em); top: -2.27em; left: 0.777em;"><span class="mrow" id="MathJax-Span-4732"><span class="mn" id="MathJax-Span-4733"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-4734" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="msubsup" id="MathJax-Span-4735" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4736"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-4737" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(0.984em, 1002.02em, 1.294em, -999.997em); top: -2.167em; left: 0.777em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 2.017em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span><span style="position: absolute; clip: rect(3.05em, 1000.78em, 4.341em, -999.997em); top: -4.181em; left: 0em;"><span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">√</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.816em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><msqrt><mn>1</mn><mo>−</mo><msub><mi>r</mi><mn>2</mn></msub></msqrt></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-416"> \cos(\theta) = \sqrt{1 - r_2} </script>

</p><p>

We can save a little algebra on specific cases by noting

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-417-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msqrt&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/msqrt&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4738" style="width: 9.042em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.441em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.087em, 1007.44em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4739"><span class="mi" id="MathJax-Span-4740"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">z</span></span><span class="mo" id="MathJax-Span-4741" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-4742" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-4743"></span><span class="mo" id="MathJax-Span-4744"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4745"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-4746"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-4747" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="msqrt" id="MathJax-Span-4748" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 2.792em; height: 0px;"><span style="position: absolute; clip: rect(1.346em, 1002.02em, 2.792em, -999.997em); top: -2.27em; left: 0.777em;"><span class="mrow" id="MathJax-Span-4749"><span class="mn" id="MathJax-Span-4750"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-4751" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="msubsup" id="MathJax-Span-4752" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4753"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-4754" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(0.984em, 1002.02em, 1.294em, -999.997em); top: -2.167em; left: 0.777em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 2.017em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span><span style="position: absolute; clip: rect(3.05em, 1000.78em, 4.341em, -999.997em); top: -4.181em; left: 0em;"><span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">√</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.816em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>z</mi><mo>=</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><msqrt><mn>1</mn><mo>−</mo><msub><mi>r</mi><mn>2</mn></msub></msqrt></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-417"> z = \cos(\theta) = \sqrt{1 - r_2} </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-418-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msqrt&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/msqrt&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msqrt&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/msqrt&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4755" style="width: 22.368em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.494em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.932em, 1018.49em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4756"><span class="mi" id="MathJax-Span-4757"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-4758" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-4759" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-4760"></span><span class="mo" id="MathJax-Span-4761"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4762"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ϕ</span></span><span class="mo" id="MathJax-Span-4763"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mi" id="MathJax-Span-4764" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mo" id="MathJax-Span-4765"></span><span class="mo" id="MathJax-Span-4766"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4767"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-4768"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-4769" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-4770" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-4771"></span><span class="mo" id="MathJax-Span-4772"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-4773"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-4774"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span class="msubsup" id="MathJax-Span-4775"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4776"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-4777" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-4778"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="msqrt" id="MathJax-Span-4779"><span style="display: inline-block; position: relative; width: 2.895em; height: 0px;"><span style="position: absolute; clip: rect(1.139em, 1002.12em, 2.637em, -999.997em); top: -2.27em; left: 0.777em;"><span class="mrow" id="MathJax-Span-4780"><span class="mn" id="MathJax-Span-4781"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-4782" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="msubsup" id="MathJax-Span-4783" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4784"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">z</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.27em; left: 0.364em;"><span class="mn" id="MathJax-Span-4785" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(0.984em, 1002.12em, 1.294em, -999.997em); top: -2.322em; left: 0.777em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 2.12em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span><span style="position: absolute; clip: rect(3.05em, 1000.78em, 4.341em, -999.997em); top: -4.388em; left: 0em;"><span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">√</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-4786" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-4787" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-4788"></span><span class="mo" id="MathJax-Span-4789"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-4790"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-4791"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span class="msubsup" id="MathJax-Span-4792"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4793"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-4794" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-4795"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="msqrt" id="MathJax-Span-4796"><span style="display: inline-block; position: relative; width: 1.397em; height: 0px;"><span style="position: absolute; clip: rect(3.05em, 1000.62em, 4.496em, -999.997em); top: -3.975em; left: 0.777em;"><span class="mrow" id="MathJax-Span-4797"><span class="msubsup" id="MathJax-Span-4798"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4799"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-4800" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.984em, 1000.62em, 1.294em, -999.997em); top: -2.167em; left: 0.777em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 0.622em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span><span style="position: absolute; clip: rect(3.05em, 1000.78em, 4.341em, -999.997em); top: -4.181em; left: 0em;"><span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">√</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 2.003em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>x</mi><mo>=</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>ϕ</mi><mo stretchy="false">)</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><msub><mi>r</mi><mn>1</mn></msub><mo stretchy="false">)</mo><msqrt><mn>1</mn><mo>−</mo><msup><mi>z</mi><mn>2</mn></msup></msqrt><mo>=</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><msub><mi>r</mi><mn>1</mn></msub><mo stretchy="false">)</mo><msqrt><msub><mi>r</mi><mn>2</mn></msub></msqrt></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-418"> x = \cos(\phi) \sin(\theta) = \cos(2 \pi r_1) \sqrt{1 - z^2} = \cos(2 \pi r_1) \sqrt{r_2} </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-419-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msqrt&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/msqrt&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msqrt&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/msqrt&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4801" style="width: 21.903em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.081em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.932em, 1018.08em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4802"><span class="mi" id="MathJax-Span-4803"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">y</span></span><span class="mo" id="MathJax-Span-4804" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-4805" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mo" id="MathJax-Span-4806"></span><span class="mo" id="MathJax-Span-4807"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4808"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ϕ</span></span><span class="mo" id="MathJax-Span-4809"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mi" id="MathJax-Span-4810" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mo" id="MathJax-Span-4811"></span><span class="mo" id="MathJax-Span-4812"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4813"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-4814"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-4815" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-4816" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mo" id="MathJax-Span-4817"></span><span class="mo" id="MathJax-Span-4818"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-4819"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-4820"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span class="msubsup" id="MathJax-Span-4821"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4822"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-4823" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-4824"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="msqrt" id="MathJax-Span-4825"><span style="display: inline-block; position: relative; width: 2.895em; height: 0px;"><span style="position: absolute; clip: rect(1.139em, 1002.12em, 2.637em, -999.997em); top: -2.27em; left: 0.777em;"><span class="mrow" id="MathJax-Span-4826"><span class="mn" id="MathJax-Span-4827"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-4828" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="msubsup" id="MathJax-Span-4829" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4830"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">z</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.27em; left: 0.364em;"><span class="mn" id="MathJax-Span-4831" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(0.984em, 1002.12em, 1.294em, -999.997em); top: -2.322em; left: 0.777em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 2.12em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span><span style="position: absolute; clip: rect(3.05em, 1000.78em, 4.341em, -999.997em); top: -4.388em; left: 0em;"><span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">√</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-4832" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-4833" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mo" id="MathJax-Span-4834"></span><span class="mo" id="MathJax-Span-4835"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-4836"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-4837"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span class="msubsup" id="MathJax-Span-4838"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4839"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-4840" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-4841"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="msqrt" id="MathJax-Span-4842"><span style="display: inline-block; position: relative; width: 1.397em; height: 0px;"><span style="position: absolute; clip: rect(3.05em, 1000.62em, 4.496em, -999.997em); top: -3.975em; left: 0.777em;"><span class="mrow" id="MathJax-Span-4843"><span class="msubsup" id="MathJax-Span-4844"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-4845"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-4846" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.984em, 1000.62em, 1.294em, -999.997em); top: -2.167em; left: 0.777em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 0.622em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span><span style="position: absolute; clip: rect(3.05em, 1000.78em, 4.341em, -999.997em); top: -4.181em; left: 0em;"><span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">√</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 2.003em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>y</mi><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>ϕ</mi><mo stretchy="false">)</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><msub><mi>r</mi><mn>1</mn></msub><mo stretchy="false">)</mo><msqrt><mn>1</mn><mo>−</mo><msup><mi>z</mi><mn>2</mn></msup></msqrt><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><msub><mi>r</mi><mn>1</mn></msub><mo stretchy="false">)</mo><msqrt><msub><mi>r</mi><mn>2</mn></msub></msqrt></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-419"> y = \sin(\phi) \sin(\theta) = \sin(2 \pi r_1) \sqrt{1 - z^2} = \sin(2 \pi r_1) \sqrt{r_2} </script>

</p><p>

</p><div class="together">
Here's a function that generates random vectors weighted by this PDF:

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-function"><span class="hljs-keyword">inline</span> vec3 <span class="hljs-title">random_cosine_direction</span><span class="hljs-params">()</span> </span>{
<span class="line"></span>    <span class="hljs-keyword">auto</span> r1 = <span class="hljs-built_in">random_double</span>();
<span class="line"></span>    <span class="hljs-keyword">auto</span> r2 = <span class="hljs-built_in">random_double</span>();
<span class="line"></span>
<span class="line"></span>    <span class="hljs-keyword">auto</span> phi = <span class="hljs-number">2</span>*pi*r1;
<span class="line"></span>    <span class="hljs-keyword">auto</span> x = <span class="hljs-built_in">cos</span>(phi)*<span class="hljs-built_in">sqrt</span>(r2);
<span class="line"></span>    <span class="hljs-keyword">auto</span> y = <span class="hljs-built_in">sin</span>(phi)*<span class="hljs-built_in">sqrt</span>(r2);
<span class="line"></span>    <span class="hljs-keyword">auto</span> z = <span class="hljs-built_in">sqrt</span>(<span class="hljs-number">1</span>-r2);
<span class="line"></span>
<span class="line"></span>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">vec3</span>(x, y, z);
<span class="line"></span>}</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_random-cosine-direction">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;26:</b> <kbd>[vec3.h]</kbd>
        Random cosine direction utility function
    </div></center>
<p>


</p></div>

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"rtweekend.h"</span></span>
<span class="line"></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iomanip&gt;</span></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;math.h&gt;</span></span>
<span class="line"></span>
<span class="line"></span><span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">f</span><span class="hljs-params">(<span class="hljs-type">const</span> vec3&amp; d)</span> </span>{
<span class="line"></span>    <span class="hljs-keyword">auto</span> cos_theta = d.<span class="hljs-built_in">z</span>();
<span class="line"></span>    <span class="hljs-keyword">return</span> cos_theta*cos_theta*cos_theta;
<span class="line"></span>}
<span class="line"></span>
<span class="line"></span><span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">pdf</span><span class="hljs-params">(<span class="hljs-type">const</span> vec3&amp; d)</span> </span>{
<span class="line"></span>    <span class="hljs-keyword">return</span> d.<span class="hljs-built_in">z</span>() / pi;
<span class="line"></span>}
<span class="line"></span>
<span class="line"></span><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
<span class="line"></span>    <span class="hljs-type">int</span> N = <span class="hljs-number">1000000</span>;
<span class="line"></span>
<span class="line"></span>    <span class="hljs-keyword">auto</span> sum = <span class="hljs-number">0.0</span>;
<span class="line"></span>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; N; i++) {
<span class="line"></span>        vec3 d = <span class="hljs-built_in">random_cosine_direction</span>();
<span class="line"></span>        sum += <span class="hljs-built_in">f</span>(d) / <span class="hljs-built_in">pdf</span>(d);
<span class="line"></span>    }
<span class="line"></span>
<span class="line"></span>    std::cout &lt;&lt; std::fixed &lt;&lt; std::<span class="hljs-built_in">setprecision</span>(<span class="hljs-number">12</span>);
<span class="line"></span>    std::cout &lt;&lt; <span class="hljs-string">"PI/2 = "</span> &lt;&lt; pi / <span class="hljs-number">2.0</span> &lt;&lt; <span class="hljs-string">'\n'</span>;
<span class="line"></span>    std::cout &lt;&lt; <span class="hljs-string">"Estimate = "</span> &lt;&lt; sum / N &lt;&lt; <span class="hljs-string">'\n'</span>;
<span class="line"></span>}</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_cos-density">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;27:</b> <kbd>[cos_density.cc]</kbd> Integration with cosine density function</div></center>
<p>


We can generate other densities later as we need them. This <code>random_cosine_direction()</code> function
produces a random direction weighted by <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-420-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4847" style="width: 2.534em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.069em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1002.07em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-4848"><span class="mi" id="MathJax-Span-4849"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-4850"></span><span class="mo" id="MathJax-Span-4851"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4852"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-4853"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-420">\cos(\theta)</script> where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-421-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4854" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-4855"><span class="mi" id="MathJax-Span-4856"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-421">\theta</script> is the angle from the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-422-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4857" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.364em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-4858"><span class="mi" id="MathJax-Span-4859"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">z</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-422">z</script>
axis.

</p>
<a class="target" name="orthonormalbases">&nbsp;</a><a class="target" name="orthonormalbases">&nbsp;</a><a class="target" name="toc8">&nbsp;</a><h1>Orthonormal Bases</h1>
<p>

In the last chapter we developed methods to generate random directions relative to the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-423-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4860" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.364em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-4861"><span class="mi" id="MathJax-Span-4862"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">z</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-423">z</script> axis. If
we want to be able to produce reflections off of any surface, we are going to need to make this more
general: Not all normals are going to be perfectly aligned with the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-424-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4863" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.364em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-4864"><span class="mi" id="MathJax-Span-4865"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">z</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-424">z</script> axis. So in this chapter we
are going to generalize our methods so that they support arbitrary surface normal vectors.

</p>
<a class="target" name="relativecoordinates">&nbsp;</a><a class="target" name="orthonormalbases/relativecoordinates">&nbsp;</a><a class="target" name="toc8.1">&nbsp;</a><h2>Relative Coordinates</h2>
<p>

An <em class="underscore">orthonormal basis</em> (ONB) is a collection of three mutually orthogonal unit vectors. It is a
strict subtype of coordinate system. The Cartesian <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-425-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4866" style="width: 1.449em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.191em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.19em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-4867"><span class="mi" id="MathJax-Span-4868"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mi" id="MathJax-Span-4869"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">y</span></span><span class="mi" id="MathJax-Span-4870"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">z</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mi>y</mi><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-425">xyz</script> axes are one example of an orthonormal
basis. All of our renders are the result of the relative positions and orientations of the objects
in a scene projected onto the image plane of the camera. The camera and objects must be described in
the same coordinate system, so that the projection onto the image plane is logically defined,
otherwise the camera has no definitive means of correctly rendering the objects. Either the camera
must be redefined in the objects' coordinate system, or the objects must be redefined in the
camera's coordinate system. It's best to start with both in the same coordinate system, so no
redefinition is necessary. So long as the camera and scene are described in the same coordinate
system, all is well. The orthonormal basis defines how distances and orientations are represented in
the space, but an orthonormal basis alone is not enough. The objects and the camera need to
described by their displacement from a mutually defined location. This is just the origin
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-426-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4871" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.62em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-4872"><span class="texatom" id="MathJax-Span-4873"><span class="mrow" id="MathJax-Span-4874"><span class="mi" id="MathJax-Span-4875"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">O</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">O</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-426">\mathbf{O}</script> of the scene; it represents the center of the universe for everything to displace from.

</p><p>

Suppose we have an origin <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-427-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4876" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.62em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-4877"><span class="texatom" id="MathJax-Span-4878"><span class="mrow" id="MathJax-Span-4879"><span class="mi" id="MathJax-Span-4880"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">O</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">O</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-427">\mathbf{O}</script> and Cartesian unit vectors <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-428-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4881" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-4882"><span class="texatom" id="MathJax-Span-4883"><span class="mrow" id="MathJax-Span-4884"><span class="mi" id="MathJax-Span-4885"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-428">\mathbf{x}</script>, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-429-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4886" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-4887"><span class="texatom" id="MathJax-Span-4888"><span class="mrow" id="MathJax-Span-4889"><span class="mi" id="MathJax-Span-4890"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">y</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">y</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-429">\mathbf{y}</script>, and
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-430-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4891" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.364em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-4892"><span class="texatom" id="MathJax-Span-4893"><span class="mrow" id="MathJax-Span-4894"><span class="mi" id="MathJax-Span-4895"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-430">\mathbf{z}</script>. When we say a location is (3,-2,7), we really are saying:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-431-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtext&gt;Location is&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4896" style="width: 12.038em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.92em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1009.92em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4897"><span class="mtext" id="MathJax-Span-4898"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">L</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;"> </span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">&nbsp;</span></span><span class="texatom" id="MathJax-Span-4899"><span class="mrow" id="MathJax-Span-4900"><span class="mi" id="MathJax-Span-4901"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">O</span></span></span></span><span class="mo" id="MathJax-Span-4902" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">+</span></span><span class="mn" id="MathJax-Span-4903" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">3</span></span><span class="texatom" id="MathJax-Span-4904"><span class="mrow" id="MathJax-Span-4905"><span class="mi" id="MathJax-Span-4906"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span class="mo" id="MathJax-Span-4907" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mn" id="MathJax-Span-4908" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="texatom" id="MathJax-Span-4909"><span class="mrow" id="MathJax-Span-4910"><span class="mi" id="MathJax-Span-4911"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">y</span></span></span></span><span class="mo" id="MathJax-Span-4912" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">+</span></span><span class="mn" id="MathJax-Span-4913" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">7</span></span><span class="texatom" id="MathJax-Span-4914"><span class="mrow" id="MathJax-Span-4915"><span class="mi" id="MathJax-Span-4916"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>Location is&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">O</mi></mrow><mo>+</mo><mn>3</mn><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>−</mo><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">y</mi></mrow><mo>+</mo><mn>7</mn><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-431"> \text{Location is } \mathbf{O} + 3\mathbf{x} - 2\mathbf{y} + 7\mathbf{z} </script>

</p><p>

If we want to measure coordinates in another coordinate system with origin <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_Error" id="MathJax-Element-432-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">O</mi></mrow><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-432">\mathbf{O}'</script> and basis
vectors <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-433-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;u&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4924" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-4925"><span class="texatom" id="MathJax-Span-4926"><span class="mrow" id="MathJax-Span-4927"><span class="mi" id="MathJax-Span-4928"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">u</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">u</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-433">\mathbf{u}</script>, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-434-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4929" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-4930"><span class="texatom" id="MathJax-Span-4931"><span class="mrow" id="MathJax-Span-4932"><span class="mi" id="MathJax-Span-4933"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">v</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-434">\mathbf{v}</script>, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-435-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4934" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.62em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-4935"><span class="texatom" id="MathJax-Span-4936"><span class="mrow" id="MathJax-Span-4937"><span class="mi" id="MathJax-Span-4938"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">w</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">w</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-435">\mathbf{w}</script>, we can just find the numbers <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-436-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4939" style="width: 3.308em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.74em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1002.74em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4940"><span class="mo" id="MathJax-Span-4941"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-4942"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">u</span></span><span class="mo" id="MathJax-Span-4943"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-4944" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">v</span></span><span class="mo" id="MathJax-Span-4945"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-4946" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">w</span></span><span class="mo" id="MathJax-Span-4947"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo>,</mo><mi>w</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-436">(u,v,w)</script> such
that:

</p><p>

    <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Error" id="MathJax-Element-437-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtext&gt;Location is&amp;#xA0;&lt;/mtext&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;u&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>Location is&nbsp;</mtext><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">O</mi></mrow><mo>′</mo></msup><mo>+</mo><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">u</mi></mrow><mo>+</mo><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo>+</mo><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">w</mi></mrow></math></span></span><script type="math/tex; mode=display" id="MathJax-Element-437"> \text{Location is } \mathbf{O}' + u\mathbf{u} + v\mathbf{v} + w\mathbf{w} </script>

</p>
<a class="target" name="generatinganorthonormalbasis">&nbsp;</a><a class="target" name="orthonormalbases/generatinganorthonormalbasis">&nbsp;</a><a class="target" name="toc8.2">&nbsp;</a><h2>Generating an Orthonormal Basis</h2>
<p>

If you take an intro to graphics course, there will be a lot of time spent on coordinate systems and
4×4 coordinate transformation matrices. Pay attention, it’s really important stuff! But we won’t be
needing it for this book and we'll make do without it. What we do need is to generate random
directions with a set distribution relative to the surface normal vector <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-438-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4956" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-4957"><span class="texatom" id="MathJax-Span-4958"><span class="mrow" id="MathJax-Span-4959"><span class="mi" id="MathJax-Span-4960"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">n</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-438">\mathbf{n}</script>. We won’t be
needing an origin for this because a direction is relative and has no specific origin. To start off
with, we need two cotangent vectors that are each perpendicular to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-439-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4961" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-4962"><span class="texatom" id="MathJax-Span-4963"><span class="mrow" id="MathJax-Span-4964"><span class="mi" id="MathJax-Span-4965"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">n</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-439">\mathbf{n}</script> and that are also
perpendicular to each other.

</p><p>

Some 3D object models will come with one or more cotangent vectors for each vertex. If our model has
only one cotangent vector, then the process of making an ONB is a nontrivial one. Suppose we have
any vector <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-440-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4966" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.364em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-4967"><span class="texatom" id="MathJax-Span-4968"><span class="mrow" id="MathJax-Span-4969"><span class="mi" id="MathJax-Span-4970"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">a</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-440">\mathbf{a}</script> that is of nonzero length and nonparallel with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-441-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4971" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-4972"><span class="texatom" id="MathJax-Span-4973"><span class="mrow" id="MathJax-Span-4974"><span class="mi" id="MathJax-Span-4975"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">n</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-441">\mathbf{n}</script>. We can get
vectors <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-442-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4976" style="width: 0.416em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.313em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.31em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-4977"><span class="texatom" id="MathJax-Span-4978"><span class="mrow" id="MathJax-Span-4979"><span class="mi" id="MathJax-Span-4980"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">s</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-442">\mathbf{s}</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-443-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4981" style="width: 0.261em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.209em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.21em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-4982"><span class="texatom" id="MathJax-Span-4983"><span class="mrow" id="MathJax-Span-4984"><span class="mi" id="MathJax-Span-4985"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">t</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-443">\mathbf{t}</script> perpendicular to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-444-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4986" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-4987"><span class="texatom" id="MathJax-Span-4988"><span class="mrow" id="MathJax-Span-4989"><span class="mi" id="MathJax-Span-4990"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">n</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-444">\mathbf{n}</script> by using the property of the
cross product that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-445-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4991" style="width: 2.12em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.759em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1001.76em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4992"><span class="texatom" id="MathJax-Span-4993"><span class="mrow" id="MathJax-Span-4994"><span class="mi" id="MathJax-Span-4995"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span></span></span><span class="mo" id="MathJax-Span-4996" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">×</span></span><span class="texatom" id="MathJax-Span-4997" style="padding-left: 0.209em;"><span class="mrow" id="MathJax-Span-4998"><span class="mi" id="MathJax-Span-4999"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">n</mi></mrow><mo>×</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">a</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-445">\mathbf{n} \times \mathbf{a}</script> is perpendicular to both <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-446-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5000" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5001"><span class="texatom" id="MathJax-Span-5002"><span class="mrow" id="MathJax-Span-5003"><span class="mi" id="MathJax-Span-5004"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">n</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-446">\mathbf{n}</script> and
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-447-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5005" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.364em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5006"><span class="texatom" id="MathJax-Span-5007"><span class="mrow" id="MathJax-Span-5008"><span class="mi" id="MathJax-Span-5009"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">a</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-447">\mathbf{a}</script>:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-448-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;u&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x005F;&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;v&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;c&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;o&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5010" style="width: 9.093em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.492em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1007.49em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5011"><span class="texatom" id="MathJax-Span-5012"><span class="mrow" id="MathJax-Span-5013"><span class="mi" id="MathJax-Span-5014"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span></span></span><span class="mo" id="MathJax-Span-5015" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="texatom" id="MathJax-Span-5016" style="padding-left: 0.261em;"><span class="mrow" id="MathJax-Span-5017"><span class="mi" id="MathJax-Span-5018"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">u</span></span><span class="mi" id="MathJax-Span-5019"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mi" id="MathJax-Span-5020"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span class="mi" id="MathJax-Span-5021"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span></span><span class="mi" id="MathJax-Span-5022"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">_</span></span><span class="mi" id="MathJax-Span-5023"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">v</span></span><span class="mi" id="MathJax-Span-5024"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span><span class="mi" id="MathJax-Span-5025"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span></span><span class="mi" id="MathJax-Span-5026"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span></span><span class="mi" id="MathJax-Span-5027"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span class="mi" id="MathJax-Span-5028"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span></span></span><span class="mo" id="MathJax-Span-5029"></span><span class="mo" id="MathJax-Span-5030"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="texatom" id="MathJax-Span-5031"><span class="mrow" id="MathJax-Span-5032"><span class="mi" id="MathJax-Span-5033"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span></span></span><span class="mo" id="MathJax-Span-5034" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">×</span></span><span class="texatom" id="MathJax-Span-5035" style="padding-left: 0.209em;"><span class="mrow" id="MathJax-Span-5036"><span class="mi" id="MathJax-Span-5037"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span></span></span><span class="mo" id="MathJax-Span-5038"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">s</mi></mrow><mo>=</mo><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><mi mathvariant="normal">u</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">_</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi></mrow><mo>⁡</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">n</mi></mrow><mo>×</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">a</mi></mrow><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-448"> \mathbf{s} = \operatorname{unit\_vector}(\mathbf{n} \times \mathbf{a}) </script>

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-449-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5039" style="width: 3.618em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.998em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1003em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5040"><span class="texatom" id="MathJax-Span-5041"><span class="mrow" id="MathJax-Span-5042"><span class="mi" id="MathJax-Span-5043"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span></span></span></span><span class="mo" id="MathJax-Span-5044" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="texatom" id="MathJax-Span-5045" style="padding-left: 0.261em;"><span class="mrow" id="MathJax-Span-5046"><span class="mi" id="MathJax-Span-5047"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span></span></span><span class="mo" id="MathJax-Span-5048" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">×</span></span><span class="texatom" id="MathJax-Span-5049" style="padding-left: 0.209em;"><span class="mrow" id="MathJax-Span-5050"><span class="mi" id="MathJax-Span-5051"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">t</mi></mrow><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">n</mi></mrow><mo>×</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">s</mi></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-449"> \mathbf{t} = \mathbf{n} \times \mathbf{s} </script>

</p><p>

</p><div class="together">
This is all well and good, but the catch is that we may not be given an <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-450-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5052" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.364em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5053"><span class="texatom" id="MathJax-Span-5054"><span class="mrow" id="MathJax-Span-5055"><span class="mi" id="MathJax-Span-5056"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">a</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-450">\mathbf{a}</script> when we load a
model, and our current program doesn't have a way to generate one. If we went ahead and picked an
arbitrary <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-451-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5057" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.364em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5058"><span class="texatom" id="MathJax-Span-5059"><span class="mrow" id="MathJax-Span-5060"><span class="mi" id="MathJax-Span-5061"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">a</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-451">\mathbf{a}</script> to use as an initial vector we may get an <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-452-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5062" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.364em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5063"><span class="texatom" id="MathJax-Span-5064"><span class="mrow" id="MathJax-Span-5065"><span class="mi" id="MathJax-Span-5066"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">a</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-452">\mathbf{a}</script> that is parallel to
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-453-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5067" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5068"><span class="texatom" id="MathJax-Span-5069"><span class="mrow" id="MathJax-Span-5070"><span class="mi" id="MathJax-Span-5071"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">n</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-453">\mathbf{n}</script>. So a common method is to pick an arbitrary axis and check to see if it's parallel to
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-454-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5072" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5073"><span class="texatom" id="MathJax-Span-5074"><span class="mrow" id="MathJax-Span-5075"><span class="mi" id="MathJax-Span-5076"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">n</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-454">\mathbf{n}</script> (which we assume to be of unit length), if it is, just use another axis:

<p></p><pre class="listing tilde"><code><span class="line"></span>if (<span class="hljs-name">fabs</span>(<span class="hljs-name">n</span>.x()) &gt; <span class="hljs-number">0.9</span>)
<span class="line"></span>    a = vec3(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>)
<span class="line"></span>else
<span class="line"></span>    a = vec3(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)</code></pre><p>

</p></div>

<p></p><p>

</p><div class="together">
We then take the cross product to get <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-455-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5077" style="width: 0.416em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.313em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.31em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5078"><span class="texatom" id="MathJax-Span-5079"><span class="mrow" id="MathJax-Span-5080"><span class="mi" id="MathJax-Span-5081"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">s</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-455">\mathbf{s}</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-456-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5082" style="width: 0.261em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.209em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.21em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5083"><span class="texatom" id="MathJax-Span-5084"><span class="mrow" id="MathJax-Span-5085"><span class="mi" id="MathJax-Span-5086"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">t</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-456">\mathbf{t}</script>

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-type">vec3</span> s = unit_vector(<span class="hljs-built_in">cross</span>(n, a));
<span class="line"></span><span class="hljs-type">vec3</span> t = <span class="hljs-built_in">cross</span>(n, s);</code></pre><p>

</p></div>

<p></p><p>

Note that we don't need to take the unit vector for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-457-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5087" style="width: 0.261em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.209em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.21em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5088"><span class="texatom" id="MathJax-Span-5089"><span class="mrow" id="MathJax-Span-5090"><span class="mi" id="MathJax-Span-5091"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">t</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-457">\mathbf{t}</script>. Since <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-458-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5092" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5093"><span class="texatom" id="MathJax-Span-5094"><span class="mrow" id="MathJax-Span-5095"><span class="mi" id="MathJax-Span-5096"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">n</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-458">\mathbf{n}</script> and
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-459-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5097" style="width: 0.416em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.313em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.31em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5098"><span class="texatom" id="MathJax-Span-5099"><span class="mrow" id="MathJax-Span-5100"><span class="mi" id="MathJax-Span-5101"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">s</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-459">\mathbf{s}</script> are both unit vectors, their cross product <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-460-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5102" style="width: 0.261em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.209em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.21em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5103"><span class="texatom" id="MathJax-Span-5104"><span class="mrow" id="MathJax-Span-5105"><span class="mi" id="MathJax-Span-5106"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">t</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-460">\mathbf{t}</script> will be also. Once we have an
ONB of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-461-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5107" style="width: 0.416em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.313em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.31em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5108"><span class="texatom" id="MathJax-Span-5109"><span class="mrow" id="MathJax-Span-5110"><span class="mi" id="MathJax-Span-5111"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">s</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-461">\mathbf{s}</script>, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-462-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5112" style="width: 0.261em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.209em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.21em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5113"><span class="texatom" id="MathJax-Span-5114"><span class="mrow" id="MathJax-Span-5115"><span class="mi" id="MathJax-Span-5116"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">t</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-462">\mathbf{t}</script>, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-463-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5117" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5118"><span class="texatom" id="MathJax-Span-5119"><span class="mrow" id="MathJax-Span-5120"><span class="mi" id="MathJax-Span-5121"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">n</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-463">\mathbf{n}</script>, and we have a random <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-464-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5122" style="width: 2.998em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.482em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1002.48em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5123"><span class="mo" id="MathJax-Span-5124"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-5125"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-5126"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-5127" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">y</span></span><span class="mo" id="MathJax-Span-5128"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-5129" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">z</span></span><span class="mo" id="MathJax-Span-5130"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-464">(x,y,z)</script> relative to the
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-465-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5131" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.364em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5132"><span class="mi" id="MathJax-Span-5133"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">z</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-465">z</script> axis, we can get the vector relative to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-466-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5134" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5135"><span class="texatom" id="MathJax-Span-5136"><span class="mrow" id="MathJax-Span-5137"><span class="mi" id="MathJax-Span-5138"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">n</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-466">\mathbf{n}</script> with:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-467-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;R&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;d&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;o&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;m&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;v&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;e&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;c&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;o&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5139" style="width: 12.244em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.127em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1010.13em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5140"><span class="texatom" id="MathJax-Span-5141"><span class="mrow" id="MathJax-Span-5142"><span class="mi" id="MathJax-Span-5143"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">R</span></span><span class="mi" id="MathJax-Span-5144"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mi" id="MathJax-Span-5145"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mi" id="MathJax-Span-5146"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-5147"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span class="mi" id="MathJax-Span-5148"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">m</span></span><span class="mi" id="MathJax-Span-5149"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">v</span></span><span class="mi" id="MathJax-Span-5150"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span><span class="mi" id="MathJax-Span-5151"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span></span><span class="mi" id="MathJax-Span-5152"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span></span><span class="mi" id="MathJax-Span-5153"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span class="mi" id="MathJax-Span-5154"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span></span></span><span class="mo" id="MathJax-Span-5155" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-5156" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="texatom" id="MathJax-Span-5157"><span class="mrow" id="MathJax-Span-5158"><span class="mi" id="MathJax-Span-5159"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span></span></span><span class="mo" id="MathJax-Span-5160" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">+</span></span><span class="mi" id="MathJax-Span-5161" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">y</span></span><span class="texatom" id="MathJax-Span-5162"><span class="mrow" id="MathJax-Span-5163"><span class="mi" id="MathJax-Span-5164"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span></span></span></span><span class="mo" id="MathJax-Span-5165" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">+</span></span><span class="mi" id="MathJax-Span-5166" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">z</span></span><span class="texatom" id="MathJax-Span-5167"><span class="mrow" id="MathJax-Span-5168"><span class="mi" id="MathJax-Span-5169"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">R</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">n</mi><mi class="MJX-tex-mathit" mathvariant="italic">d</mi><mi class="MJX-tex-mathit" mathvariant="italic">o</mi><mi class="MJX-tex-mathit" mathvariant="italic">m</mi><mi class="MJX-tex-mathit" mathvariant="italic">v</mi><mi class="MJX-tex-mathit" mathvariant="italic">e</mi><mi class="MJX-tex-mathit" mathvariant="italic">c</mi><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">o</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi></mrow><mo>=</mo><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">s</mi></mrow><mo>+</mo><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">t</mi></mrow><mo>+</mo><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">n</mi></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-467"> \mathit{Random vector} = x \mathbf{s} + y \mathbf{t} + z \mathbf{n} </script>

</p><p>

If you remember, we used similar math to produce rays from a camera. You can think of that as a
change to the camera’s natural coordinate system.

</p>
<a class="target" name="theonbclass">&nbsp;</a><a class="target" name="orthonormalbases/theonbclass">&nbsp;</a><a class="target" name="toc8.3">&nbsp;</a><h2>The ONB Class</h2>
<p>

Should we make a class for ONBs, or are utility functions enough? I’m not sure, but let’s make a
class because it won't really be more complicated than utility functions:

</p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">ifndef</span> ONB_H</span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">define</span> ONB_H</span>
<span class="line"></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"rtweekend.h"</span></span>
<span class="line"></span>
<span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">onb</span> {
<span class="line"></span>  <span class="hljs-keyword">public</span>:
<span class="line"></span>    <span class="hljs-built_in">onb</span>() {}
<span class="line"></span>
<span class="line"></span>    vec3 <span class="hljs-keyword">operator</span>[](<span class="hljs-type">int</span> i) <span class="hljs-type">const</span> { <span class="hljs-keyword">return</span> axis[i]; }
<span class="line"></span>    vec3&amp; <span class="hljs-keyword">operator</span>[](<span class="hljs-type">int</span> i) { <span class="hljs-keyword">return</span> axis[i]; }
<span class="line"></span>
<span class="line"></span>    <span class="hljs-function">vec3 <span class="hljs-title">u</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>{ <span class="hljs-keyword">return</span> axis[<span class="hljs-number">0</span>]; }
<span class="line"></span>    <span class="hljs-function">vec3 <span class="hljs-title">v</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>{ <span class="hljs-keyword">return</span> axis[<span class="hljs-number">1</span>]; }
<span class="line"></span>    <span class="hljs-function">vec3 <span class="hljs-title">w</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>{ <span class="hljs-keyword">return</span> axis[<span class="hljs-number">2</span>]; }
<span class="line"></span>
<span class="line"></span>    <span class="hljs-function">vec3 <span class="hljs-title">local</span><span class="hljs-params">(<span class="hljs-type">double</span> a, <span class="hljs-type">double</span> b, <span class="hljs-type">double</span> c)</span> <span class="hljs-type">const</span> </span>{
<span class="line"></span>        <span class="hljs-keyword">return</span> a*<span class="hljs-built_in">u</span>() + b*<span class="hljs-built_in">v</span>() + c*<span class="hljs-built_in">w</span>();
<span class="line"></span>    }
<span class="line"></span>
<span class="line"></span>    <span class="hljs-function">vec3 <span class="hljs-title">local</span><span class="hljs-params">(<span class="hljs-type">const</span> vec3&amp; a)</span> <span class="hljs-type">const</span> </span>{
<span class="line"></span>        <span class="hljs-keyword">return</span> a.<span class="hljs-built_in">x</span>()*<span class="hljs-built_in">u</span>() + a.<span class="hljs-built_in">y</span>()*<span class="hljs-built_in">v</span>() + a.<span class="hljs-built_in">z</span>()*<span class="hljs-built_in">w</span>();
<span class="line"></span>    }
<span class="line"></span>
<span class="line"></span>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">build_from_w</span><span class="hljs-params">(<span class="hljs-type">const</span> vec3&amp; w)</span> </span>{
<span class="line"></span>        vec3 unit_w = <span class="hljs-built_in">unit_vector</span>(w);
<span class="line"></span>        vec3 a = (<span class="hljs-built_in">fabs</span>(unit_w.<span class="hljs-built_in">x</span>()) &gt; <span class="hljs-number">0.9</span>) ? <span class="hljs-built_in">vec3</span>(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>) : <span class="hljs-built_in">vec3</span>(<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>);
<span class="line"></span>        vec3 v = <span class="hljs-built_in">unit_vector</span>(<span class="hljs-built_in">cross</span>(unit_w, a));
<span class="line"></span>        vec3 u = <span class="hljs-built_in">cross</span>(unit_w, v);
<span class="line"></span>        axis[<span class="hljs-number">0</span>] = u;
<span class="line"></span>        axis[<span class="hljs-number">1</span>] = v;
<span class="line"></span>        axis[<span class="hljs-number">2</span>] = unit_w;
<span class="line"></span>    }
<span class="line"></span>
<span class="line"></span>  <span class="hljs-keyword">public</span>:
<span class="line"></span>    vec3 axis[<span class="hljs-number">3</span>];
<span class="line"></span>};
<span class="line"></span>
<span class="line"></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">endif</span></span></code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_class-onb">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;28:</b> <kbd>[onb.h]</kbd> Orthonormal basis class</div></center>
<p>


</p><div class="together">
We can rewrite our Lambertian material using this to get:

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">lambertian</span> : <span class="hljs-keyword">public</span> material {
<span class="line"></span>  <span class="hljs-keyword">public</span>:
<span class="line"></span>    ...<div class=" highlight"><span class="line"></span>    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">scatter</span><span class="hljs-params">(
<span class="line"></span>        <span class="hljs-type">const</span> ray&amp; r_in, <span class="hljs-type">const</span> hit_record&amp; rec, color&amp; attenuation, ray&amp; scattered, <span class="hljs-type">double</span>&amp; pdf
<span class="line"></span>    )</span> <span class="hljs-type">const</span> <span class="hljs-keyword">override</span> </span>{
<span class="line"></span>        onb uvw;
<span class="line"></span>        uvw.<span class="hljs-built_in">build_from_w</span>(rec.normal);
<span class="line"></span>        <span class="hljs-keyword">auto</span> scatter_direction = uvw.<span class="hljs-built_in">local</span>(<span class="hljs-built_in">random_cosine_direction</span>());
<span class="line"></span>
<span class="line"></span>        scattered = <span class="hljs-built_in">ray</span>(rec.p, <span class="hljs-built_in">unit_vector</span>(scatter_direction), r_in.<span class="hljs-built_in">time</span>());</div><span class="line"></span>        attenuation = tex-&gt;<span class="hljs-built_in">value</span>(rec.u, rec.v, rec.p);<div class=" highlight"><span class="line"></span>        pdf = <span class="hljs-built_in">dot</span>(uvw.<span class="hljs-built_in">w</span>(), scattered.<span class="hljs-built_in">direction</span>()) / pi;</div><span class="line"></span>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
<span class="line"></span>    }
<span class="line"></span>
<span class="line"></span>    ...
<span class="line"></span>};</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_scatter-onb">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;29:</b> <kbd>[material.h]</kbd> Scatter function, with orthonormal basis</div></center>
<p>


</p></div>

<p></p><p>

</p><div class="together">
Which produces:

<p></p><p>

  </p><center><div class="image" style=""><a href="./input_files/img-3.06-cornell-ortho.jpg" target="_blank"><img class="markdeep pixel" src="./input_files/img-3.06-cornell-ortho.jpg"></a><center><span class="imagecaption"><span class="num">Image 6:</span> Cornell box, with orthonormal basis scatter function
  </span></center></div></center>

<p></p><p>

</p></div>

<p></p><p>

</p><div class="together">
Let’s get rid of some of that noise.

<p></p><p>

But first, let's quickly update the <code>isotropic</code> material:

</p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">isotropic</span> : <span class="hljs-keyword">public</span> material {
<span class="line"></span>  <span class="hljs-keyword">public</span>:
<span class="line"></span>    <span class="hljs-built_in">isotropic</span>(<span class="hljs-type">const</span> color&amp; albedo) : <span class="hljs-built_in">tex</span>(<span class="hljs-built_in">make_shared</span>&lt;solid_color&gt;(albedo)) {}
<span class="line"></span>    <span class="hljs-built_in">isotropic</span>(shared_ptr&lt;texture&gt; tex) : <span class="hljs-built_in">tex</span>(tex) {}
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">scatter</span><span class="hljs-params">(
<span class="line"></span>        <span class="hljs-type">const</span> ray&amp; r_in, <span class="hljs-type">const</span> hit_record&amp; rec, color&amp; attenuation, ray&amp; scattered, <span class="hljs-type">double</span>&amp; pdf
<span class="line"></span>    )</span> <span class="hljs-type">const</span> <span class="hljs-keyword">override</span> </span>{</div><span class="line"></span>        attenuation = tex-&gt;<span class="hljs-built_in">value</span>(rec.u, rec.v, rec.p);
<span class="line"></span>        scattered = <span class="hljs-built_in">ray</span>(rec.p, <span class="hljs-built_in">random_unit_vector</span>(), r_in.<span class="hljs-built_in">time</span>());<div class=" highlight"><span class="line"></span>        pdf = <span class="hljs-number">1</span> / (<span class="hljs-number">4</span> * pi);</div><span class="line"></span>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
<span class="line"></span>    }
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>    <span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">scattering_pdf</span><span class="hljs-params">(<span class="hljs-type">const</span> ray&amp; r_in, <span class="hljs-type">const</span> hit_record&amp; rec, <span class="hljs-type">const</span> ray&amp; scattered)</span>
<span class="line"></span>    <span class="hljs-type">const</span> <span class="hljs-keyword">override</span> </span>{
<span class="line"></span>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span> / (<span class="hljs-number">4</span> * pi);
<span class="line"></span>    }</div><span class="line"></span>
<span class="line"></span>  <span class="hljs-keyword">private</span>:
<span class="line"></span>    shared_ptr&lt;texture&gt; tex;
<span class="line"></span>};</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_class-isotropic-impsample">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;30:</b> <kbd>[material.h]</kbd>
        Isotropic material, modified for importance sampling
    </div></center>
<p>


</p></div>

<p></p>
<a class="target" name="samplinglightsdirectly">&nbsp;</a><a class="target" name="samplinglightsdirectly">&nbsp;</a><a class="target" name="toc9">&nbsp;</a><h1>Sampling Lights Directly</h1>
<p>

The problem with sampling uniformly over all directions is that lights are no more likely to be
sampled than any arbirary or unimportant direction. We could use shadow rays to solve for the direct
lighting at any given point. Instead, I’ll just use a PDF that sends more rays to the light. We can
then turn around and change that PDF to send more rays in whatever direction we want.

</p><p>

It’s really easy to pick a random direction toward the light; just pick a random point on the light
and send a ray in that direction. But we'll need to know the PDF, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-468-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5170" style="width: 1.81em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.501em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.5em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5171"><span class="mi" id="MathJax-Span-5172"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-5173"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-5174"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span class="mo" id="MathJax-Span-5175"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-468">p(\omega)</script>, so that we're not
biasing our render. But what is that?

</p>
<a class="target" name="gettingthepdfofalight">&nbsp;</a><a class="target" name="samplinglightsdirectly/gettingthepdfofalight">&nbsp;</a><a class="target" name="toc9.1">&nbsp;</a><h2>Getting the PDF of a Light</h2>
<p>

For a light with a surface area of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-469-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5176" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.62em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5177"><span class="mi" id="MathJax-Span-5178"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">A</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-469">A</script>, if we sample uniformly on that light, the PDF on the surface
is just <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-470-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5179" style="width: 0.881em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(-0.307em, 1000.73em, 1.759em, -999.997em); top: -0.979em; left: 0em;"><span class="mrow" id="MathJax-Span-5180"><span class="mfrac" id="MathJax-Span-5181"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.139em, 1000.31em, 2.172em, -999.997em); top: -2.425em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-5182" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.42em, 2.172em, -999.997em); top: -1.392em; left: 50%; margin-left: -0.204em;"><span class="mi" id="MathJax-Span-5183" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">A</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.52em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.519em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.984em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.809em; border-left: 0px solid; width: 0px; height: 2.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mn>1</mn><mi>A</mi></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-470">\frac{1}{A}</script>. How much area does the entire surface of the light take up if its projected
back onto the unit sphere? Fortunately, there is a simple correspondence, as outlined in this
diagram:

</p><p>

  </p><center><div class="image" style=""><a href="./input_files/fig-3.11-shape-onto-pdf.jpg" target="_blank"><img class="markdeep" src="./input_files/fig-3.11-shape-onto-pdf.jpg"></a><center><span class="imagecaption"><a class="target" name="figure_shape-onto-pdf">&nbsp;</a><b style="font-style:normal;">Figure&nbsp;11:</b> Projection of light shape onto PDF
  </span></center></div></center>

<p></p><p>

If we look at a small area <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-471-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5184" style="width: 1.294em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.04em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5185"><span class="mi" id="MathJax-Span-5186"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-5187"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">A</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-471">dA</script> on the light, the probability of sampling it is
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-472-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;q&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5188" style="width: 4.135em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.412em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1003.41em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5189"><span class="texatom" id="MathJax-Span-5190"><span class="mrow" id="MathJax-Span-5191"><span class="msubsup" id="MathJax-Span-5192"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5193"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mi" id="MathJax-Span-5194" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">q</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-5195"></span><span class="mo" id="MathJax-Span-5196"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-5197"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">q</span></span><span class="mo" id="MathJax-Span-5198"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-5199" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mi" id="MathJax-Span-5200" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-5201"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">A</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><msub><mi mathvariant="normal">p</mi><mi mathvariant="normal">q</mi></msub></mrow><mo>⁡</mo><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>d</mi><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-472">\operatorname{p_q}(q) \cdot dA</script>. On the sphere, the probability of sampling the small area
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-473-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5202" style="width: 1.139em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.93em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5203"><span class="mi" id="MathJax-Span-5204"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-5205"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mi>ω</mi></math></span></span><script type="math/tex" id="MathJax-Element-473">d\omega</script> on the sphere is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-474-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5206" style="width: 3.773em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.102em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1003.1em, 2.637em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5207"><span class="mi" id="MathJax-Span-5208"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-5209"></span><span class="mo" id="MathJax-Span-5210"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-5211"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span class="mo" id="MathJax-Span-5212"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-5213" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mi" id="MathJax-Span-5214" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-5215"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">p</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>d</mi><mi>ω</mi></math></span></span><script type="math/tex" id="MathJax-Element-474">\operatorname{p}(\omega) \cdot d\omega</script>. There is a geometric
relationship between <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-475-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5216" style="width: 1.139em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.93em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5217"><span class="mi" id="MathJax-Span-5218"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-5219"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mi>ω</mi></math></span></span><script type="math/tex" id="MathJax-Element-475">d\omega</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-476-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5220" style="width: 1.294em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.04em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5221"><span class="mi" id="MathJax-Span-5222"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-5223"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">A</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-476">dA</script>:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-477-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi&gt;distance&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5224" style="width: 9.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.112em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1008.11em, 3.67em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5225"><span class="mi" id="MathJax-Span-5226"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-5227"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span class="mo" id="MathJax-Span-5228" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-5229" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 5.891em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.346em, 1003.72em, 2.637em, -999.997em); top: -2.942em; left: 50%; margin-left: -1.857em;"><span class="mrow" id="MathJax-Span-5230"><span class="mi" id="MathJax-Span-5231"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-5232"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">A</span></span><span class="mo" id="MathJax-Span-5233" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mi" id="MathJax-Span-5234" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-5235"></span><span class="mo" id="MathJax-Span-5236"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-5237"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-5238"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(2.74em, 1005.79em, 4.341em, -999.997em); top: -2.89em; left: 50%; margin-left: -2.89em;"><span class="mrow" id="MathJax-Span-5239"><span class="msubsup" id="MathJax-Span-5240"><span style="display: inline-block; position: relative; width: 3.102em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1002.74em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5241"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.373em; left: 2.74em;"><span class="mn" id="MathJax-Span-5242" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-5243"></span><span class="mo" id="MathJax-Span-5244"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-5245"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-5246"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-5247" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">q</span></span><span class="mo" id="MathJax-Span-5248"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1005.89em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.891em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.441em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>d</mi><mi>ω</mi><mo>=</mo><mfrac><mrow><mi>d</mi><mi>A</mi><mo>⋅</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><mrow><msup><mi>distance</mi><mn>2</mn></msup><mo>⁡</mo><mo stretchy="false">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false">)</mo></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-477"> d\omega = \frac{dA \cdot \cos(\theta)}{\operatorname{distance}^2(p,q)} </script>

</p><p>

Since the probability of sampling <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-478-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5249" style="width: 1.139em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.93em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5250"><span class="mi" id="MathJax-Span-5251"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-5252"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mi>ω</mi></math></span></span><script type="math/tex" id="MathJax-Element-478">d\omega</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-479-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5253" style="width: 1.294em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.04em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5254"><span class="mi" id="MathJax-Span-5255"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-5256"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">A</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-479">dA</script> must be the same, then

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-480-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;q&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5257" style="width: 9.197em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.596em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1007.6em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5258"><span class="mi" id="MathJax-Span-5259"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-5260"></span><span class="mo" id="MathJax-Span-5261"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-5262"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span class="mo" id="MathJax-Span-5263"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-5264" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mi" id="MathJax-Span-5265" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-5266"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span class="mo" id="MathJax-Span-5267" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="texatom" id="MathJax-Span-5268" style="padding-left: 0.261em;"><span class="mrow" id="MathJax-Span-5269"><span class="msubsup" id="MathJax-Span-5270"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5271"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mi" id="MathJax-Span-5272" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">q</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-5273"></span><span class="mo" id="MathJax-Span-5274"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-5275"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">q</span></span><span class="mo" id="MathJax-Span-5276"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-5277" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mi" id="MathJax-Span-5278" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-5279"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">A</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi mathvariant="normal">p</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>d</mi><mi>ω</mi><mo>=</mo><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><msub><mi mathvariant="normal">p</mi><mi mathvariant="normal">q</mi></msub></mrow><mo>⁡</mo><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>d</mi><mi>A</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-480"> \operatorname{p}(\omega) \cdot d\omega = \operatorname{p_q}(q) \cdot dA </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-481-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi&gt;distance&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;q&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5280" style="width: 15.447em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.761em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1012.76em, 3.67em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5281"><span class="mi" id="MathJax-Span-5282"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-5283"></span><span class="mo" id="MathJax-Span-5284"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-5285"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span class="mo" id="MathJax-Span-5286"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-5287" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mfrac" id="MathJax-Span-5288" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 5.891em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.346em, 1003.72em, 2.637em, -999.997em); top: -2.942em; left: 50%; margin-left: -1.857em;"><span class="mrow" id="MathJax-Span-5289"><span class="mi" id="MathJax-Span-5290"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-5291"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">A</span></span><span class="mo" id="MathJax-Span-5292" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mi" id="MathJax-Span-5293" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-5294"></span><span class="mo" id="MathJax-Span-5295"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-5296"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-5297"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(2.74em, 1005.79em, 4.341em, -999.997em); top: -2.89em; left: 50%; margin-left: -2.89em;"><span class="mrow" id="MathJax-Span-5298"><span class="msubsup" id="MathJax-Span-5299"><span style="display: inline-block; position: relative; width: 3.102em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1002.74em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5300"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.373em; left: 2.74em;"><span class="mn" id="MathJax-Span-5301" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-5302"></span><span class="mo" id="MathJax-Span-5303"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-5304"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-5305"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-5306" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">q</span></span><span class="mo" id="MathJax-Span-5307"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1005.89em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.891em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mo" id="MathJax-Span-5308" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="texatom" id="MathJax-Span-5309" style="padding-left: 0.261em;"><span class="mrow" id="MathJax-Span-5310"><span class="msubsup" id="MathJax-Span-5311"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5312"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mi" id="MathJax-Span-5313" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">q</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-5314"></span><span class="mo" id="MathJax-Span-5315"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-5316"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">q</span></span><span class="mo" id="MathJax-Span-5317"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-5318" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mi" id="MathJax-Span-5319" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-5320"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">A</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.441em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi mathvariant="normal">p</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo><mo>⋅</mo><mfrac><mrow><mi>d</mi><mi>A</mi><mo>⋅</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><mrow><msup><mi>distance</mi><mn>2</mn></msup><mo>⁡</mo><mo stretchy="false">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><msub><mi mathvariant="normal">p</mi><mi mathvariant="normal">q</mi></msub></mrow><mo>⁡</mo><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>d</mi><mi>A</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-481"> \operatorname{p}(\omega)
       \cdot \frac{dA \cdot \cos(\theta)}{\operatorname{distance}^2(p,q)}
       = \operatorname{p_q}(q) \cdot dA </script>

</p><p>

We know that if we sample uniformly on the light the PDF on the surface is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-482-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5321" style="width: 0.881em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(-0.307em, 1000.73em, 1.759em, -999.997em); top: -0.979em; left: 0em;"><span class="mrow" id="MathJax-Span-5322"><span class="mfrac" id="MathJax-Span-5323"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.139em, 1000.31em, 2.172em, -999.997em); top: -2.425em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-5324" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.42em, 2.172em, -999.997em); top: -1.392em; left: 50%; margin-left: -0.204em;"><span class="mi" id="MathJax-Span-5325" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">A</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.52em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.519em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.984em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.809em; border-left: 0px solid; width: 0px; height: 2.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mn>1</mn><mi>A</mi></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-482">\frac{1}{A}</script>:

</p><p>

    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-483-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;q&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5326" style="width: 4.6em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.773em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1003.77em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5327"><span class="texatom" id="MathJax-Span-5328"><span class="mrow" id="MathJax-Span-5329"><span class="msubsup" id="MathJax-Span-5330"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5331"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mi" id="MathJax-Span-5332" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">q</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-5333"></span><span class="mo" id="MathJax-Span-5334"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-5335"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">q</span></span><span class="mo" id="MathJax-Span-5336"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-5337" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-5338" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-5339"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.62em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.307em;"><span class="mi" id="MathJax-Span-5340"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">A</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.73em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.726em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><msub><mi mathvariant="normal">p</mi><mi mathvariant="normal">q</mi></msub></mrow><mo>⁡</mo><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>A</mi></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-483"> \operatorname{p_q}(q) = \frac{1}{A} </script>
    <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-484-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi&gt;distance&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5341" style="width: 12.967em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.695em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1010.7em, 3.67em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5342"><span class="mi" id="MathJax-Span-5343"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-5344"></span><span class="mo" id="MathJax-Span-5345"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-5346"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span class="mo" id="MathJax-Span-5347"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-5348" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mfrac" id="MathJax-Span-5349" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 5.891em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.346em, 1003.72em, 2.637em, -999.997em); top: -2.942em; left: 50%; margin-left: -1.857em;"><span class="mrow" id="MathJax-Span-5350"><span class="mi" id="MathJax-Span-5351"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-5352"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">A</span></span><span class="mo" id="MathJax-Span-5353" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mi" id="MathJax-Span-5354" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-5355"></span><span class="mo" id="MathJax-Span-5356"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-5357"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-5358"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(2.74em, 1005.79em, 4.341em, -999.997em); top: -2.89em; left: 50%; margin-left: -2.89em;"><span class="mrow" id="MathJax-Span-5359"><span class="msubsup" id="MathJax-Span-5360"><span style="display: inline-block; position: relative; width: 3.102em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1002.74em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5361"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.373em; left: 2.74em;"><span class="mn" id="MathJax-Span-5362" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-5363"></span><span class="mo" id="MathJax-Span-5364"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-5365"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-5366"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-5367" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">q</span></span><span class="mo" id="MathJax-Span-5368"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1005.89em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.891em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mo" id="MathJax-Span-5369" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-5370" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.139em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1001.04em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.514em;"><span class="mrow" id="MathJax-Span-5371"><span class="mi" id="MathJax-Span-5372"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span></span><span class="mi" id="MathJax-Span-5373"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">A</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.62em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.307em;"><span class="mi" id="MathJax-Span-5374"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">A</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1001.14em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.139em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.441em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi mathvariant="normal">p</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo><mo>⋅</mo><mfrac><mrow><mi>d</mi><mi>A</mi><mo>⋅</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><mrow><msup><mi>distance</mi><mn>2</mn></msup><mo>⁡</mo><mo stretchy="false">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>d</mi><mi>A</mi></mrow><mi>A</mi></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-484"> \operatorname{p}(\omega) \cdot \frac{dA \cdot \cos(\theta)}{\operatorname{distance}^2(p,q)}
       =  \frac{dA}{A} </script>

</p><p>

So

</p><p>

  <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-485-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi&gt;distance&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5375" style="width: 10.54em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.68em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.364em, 1008.68em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5376"><span class="mi" id="MathJax-Span-5377"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-5378"></span><span class="mo" id="MathJax-Span-5379"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-5380"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span class="mo" id="MathJax-Span-5381"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-5382" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-5383" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 5.891em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(2.74em, 1005.79em, 4.341em, -999.997em); top: -4.646em; left: 50%; margin-left: -2.89em;"><span class="mrow" id="MathJax-Span-5384"><span class="msubsup" id="MathJax-Span-5385"><span style="display: inline-block; position: relative; width: 3.102em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1002.74em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5386"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.373em; left: 2.74em;"><span class="mn" id="MathJax-Span-5387" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-5388"></span><span class="mo" id="MathJax-Span-5389"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-5390"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-5391"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-5392" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">q</span></span><span class="mo" id="MathJax-Span-5393"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(1.346em, 1003.31em, 2.637em, -999.997em); top: -1.495em; left: 50%; margin-left: -1.65em;"><span class="mrow" id="MathJax-Span-5394"><span class="mi" id="MathJax-Span-5395"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-5396"></span><span class="mo" id="MathJax-Span-5397"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-5398"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-5399"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-5400" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mi" id="MathJax-Span-5401" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">A</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1005.89em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.891em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.441em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi mathvariant="normal">p</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><msup><mi>distance</mi><mn>2</mn></msup><mo>⁡</mo><mo stretchy="false">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false">)</mo></mrow><mrow><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>A</mi></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-485"> \operatorname{p}(\omega) = \frac{\operatorname{distance}^2(p,q)}{\cos(\theta) \cdot A} </script>

</p>
<a class="target" name="lightsampling">&nbsp;</a><a class="target" name="samplinglightsdirectly/lightsampling">&nbsp;</a><a class="target" name="toc9.2">&nbsp;</a><h2>Light Sampling</h2>
<p>

We can hack our <code>ray_color()</code> function to sample the light in a very hard-coded fashion just to
check that we got the math and concept right:

</p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">camera</span> {
<span class="line"></span>  ...
<span class="line"></span>  <span class="hljs-keyword">private</span>:
<span class="line"></span>    <span class="hljs-function">color <span class="hljs-title">ray_color</span><span class="hljs-params">(<span class="hljs-type">const</span> ray&amp; r, <span class="hljs-type">int</span> depth, <span class="hljs-type">const</span> hittable&amp; world)</span> <span class="hljs-type">const</span> </span>{
<span class="line"></span>        <span class="hljs-comment">// If we've exceeded the ray bounce limit, no more light is gathered.</span>
<span class="line"></span>        <span class="hljs-keyword">if</span> (depth &lt;= <span class="hljs-number">0</span>)
<span class="line"></span>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">color</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>);
<span class="line"></span>
<span class="line"></span>        hit_record rec;
<span class="line"></span>
<span class="line"></span>        <span class="hljs-comment">// If the ray hits nothing, return the background color.</span>
<span class="line"></span>        <span class="hljs-keyword">if</span> (!world.<span class="hljs-built_in">hit</span>(r, <span class="hljs-built_in">interval</span>(<span class="hljs-number">0.001</span>, infinity), rec))
<span class="line"></span>            <span class="hljs-keyword">return</span> background;
<span class="line"></span>
<span class="line"></span>        ray scattered;
<span class="line"></span>        color attenuation;<div class=" highlight"><span class="line"></span>        <span class="hljs-type">double</span> pdf;</div><span class="line"></span>        color color_from_emission = rec.mat-&gt;<span class="hljs-built_in">emitted</span>(rec.u, rec.v, rec.p);
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>        <span class="hljs-keyword">if</span> (!rec.mat-&gt;<span class="hljs-built_in">scatter</span>(r, rec, attenuation, scattered, pdf))</div><span class="line"></span>            <span class="hljs-keyword">return</span> color_from_emission;
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>        <span class="hljs-keyword">auto</span> on_light = <span class="hljs-built_in">point3</span>(<span class="hljs-built_in">random_double</span>(<span class="hljs-number">213</span>,<span class="hljs-number">343</span>), <span class="hljs-number">554</span>, <span class="hljs-built_in">random_double</span>(<span class="hljs-number">227</span>,<span class="hljs-number">332</span>));
<span class="line"></span>        <span class="hljs-keyword">auto</span> to_light = on_light - rec.p;
<span class="line"></span>        <span class="hljs-keyword">auto</span> distance_squared = to_light.<span class="hljs-built_in">length_squared</span>();
<span class="line"></span>        to_light = <span class="hljs-built_in">unit_vector</span>(to_light);
<span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">dot</span>(to_light, rec.normal) &lt; <span class="hljs-number">0</span>)
<span class="line"></span>            <span class="hljs-keyword">return</span> color_from_emission;
<span class="line"></span>
<span class="line"></span>        <span class="hljs-type">double</span> light_area = (<span class="hljs-number">343</span><span class="hljs-number">-213</span>)*(<span class="hljs-number">332</span><span class="hljs-number">-227</span>);
<span class="line"></span>        <span class="hljs-keyword">auto</span> light_cosine = <span class="hljs-built_in">fabs</span>(to_light.<span class="hljs-built_in">y</span>());
<span class="line"></span>        <span class="hljs-keyword">if</span> (light_cosine &lt; <span class="hljs-number">0.000001</span>)
<span class="line"></span>            <span class="hljs-keyword">return</span> color_from_emission;
<span class="line"></span>
<span class="line"></span>        pdf = distance_squared / (light_cosine * light_area);
<span class="line"></span>        scattered = <span class="hljs-built_in">ray</span>(rec.p, to_light, r.<span class="hljs-built_in">time</span>());
<span class="line"></span>
<span class="line"></span>        <span class="hljs-type">double</span> scattering_pdf = rec.mat-&gt;<span class="hljs-built_in">scattering_pdf</span>(r, rec, scattered);</div><span class="line"></span>
<span class="line"></span>        color color_from_scatter =
<span class="line"></span>            (attenuation * scattering_pdf * <span class="hljs-built_in">ray_color</span>(scattered, depth<span class="hljs-number">-1</span>, world)) / pdf;
<span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">return</span> color_from_emission + color_from_scatter;
<span class="line"></span>    }
<span class="line"></span>};</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_ray-color-lights">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;31:</b> <kbd>[camera.h]</kbd> Ray color with light sampling</div></center>
<p>


</p><div class="together">
With 10 samples per pixel this yields:

<p></p><p>

  </p><center><div class="image" style=""><a href="./input_files/img-3.07-cornell-sample-light.jpg" target="_blank"><img class="markdeep pixel" src="./input_files/img-3.07-cornell-sample-light.jpg"></a><center><span class="imagecaption"><span class="num">Image 7:</span> Cornell box, sampling only the light, 10 samples per pixel
  </span></center></div></center>

<p></p><p>

This is about what we would expect from something that samples only the light sources, so this
appears to work.

</p><p>

</p></div>

<p></p>
<a class="target" name="switchingtounidirectionallight">&nbsp;</a><a class="target" name="samplinglightsdirectly/switchingtounidirectionallight">&nbsp;</a><a class="target" name="toc9.3">&nbsp;</a><h2>Switching to Unidirectional Light</h2>
<p>

The noisy pops around the light on the ceiling are because the light is two-sided and there is a
small space between light and ceiling. We probably want to have the light just emit down. We can do
that by letting the <code>hittable::emitted()</code> function take extra information:

</p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">material</span> {
<span class="line"></span>  <span class="hljs-keyword">public</span>:
<span class="line"></span>    ...
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> color <span class="hljs-title">emitted</span><span class="hljs-params">(
<span class="line"></span>        <span class="hljs-type">const</span> ray&amp; r_in, <span class="hljs-type">const</span> hit_record&amp; rec, <span class="hljs-type">double</span> u, <span class="hljs-type">double</span> v, <span class="hljs-type">const</span> point3&amp; p
<span class="line"></span>    )</span> <span class="hljs-type">const</span> </span>{</div><span class="line"></span>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">color</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>);
<span class="line"></span>    }
<span class="line"></span>    ...
<span class="line"></span>};
<span class="line"></span>
<span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">diffuse_light</span> : <span class="hljs-keyword">public</span> material {
<span class="line"></span>  <span class="hljs-keyword">public</span>:
<span class="line"></span>    ...
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>    <span class="hljs-function">color <span class="hljs-title">emitted</span><span class="hljs-params">(<span class="hljs-type">const</span> ray&amp; r_in, <span class="hljs-type">const</span> hit_record&amp; rec, <span class="hljs-type">double</span> u, <span class="hljs-type">double</span> v, <span class="hljs-type">const</span> point3&amp; p)</span>
<span class="line"></span>    <span class="hljs-type">const</span> <span class="hljs-keyword">override</span> </span>{
<span class="line"></span>        <span class="hljs-keyword">if</span> (!rec.front_face)
<span class="line"></span>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">color</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>);
<span class="line"></span>        <span class="hljs-keyword">return</span> emit-&gt;<span class="hljs-built_in">value</span>(u, v, p);
<span class="line"></span>    }</div><span class="line"></span>
<span class="line"></span>    ...
<span class="line"></span>};</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_emitted-directional">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;32:</b> <kbd>[material.h]</kbd> Material emission, directional</div></center>
<pre class="listing tilde"><code><span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">camera</span> {
<span class="line"></span>  ...
<span class="line"></span>  <span class="hljs-keyword">private</span>:
<span class="line"></span>    <span class="hljs-function">color <span class="hljs-title">ray_color</span><span class="hljs-params">(<span class="hljs-type">const</span> ray&amp; r, <span class="hljs-type">int</span> depth, <span class="hljs-type">const</span> hittable&amp; world)</span> <span class="hljs-type">const</span> </span>{
<span class="line"></span>        ...
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>        color color_from_emission = rec.mat-&gt;<span class="hljs-built_in">emitted</span>(r, rec, rec.u, rec.v, rec.p);</div><span class="line"></span>
<span class="line"></span>        ...
<span class="line"></span>    }
<span class="line"></span>};</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_emitted-ray-color">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;33:</b> <kbd>[camera.h]</kbd>
        Material emission, camera::ray_color() changes
    </div></center>
<p>



</p><div class="together">
This gives us:

<p></p><p>

  </p><center><div class="image" style=""><a href="./input_files/img-3.08-cornell-lightdown.jpg" target="_blank"><img class="markdeep pixel" src="./input_files/img-3.08-cornell-lightdown.jpg"></a><center><span class="imagecaption"><span class="num">Image 8:</span> Cornell box, light emitted only in the downward direction
  </span></center></div></center>

<p></p><p>

</p></div>

<p></p>
<a class="target" name="mixturedensities">&nbsp;</a><a class="target" name="mixturedensities">&nbsp;</a><a class="target" name="toc10">&nbsp;</a><h1>Mixture Densities</h1>
<p>

We have used a PDF related to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-486-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5402" style="width: 2.534em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.069em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1002.07em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5403"><span class="mi" id="MathJax-Span-5404"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-5405"></span><span class="mo" id="MathJax-Span-5406"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-5407"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-5408"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-486">\cos(\theta)</script>, and a PDF related to sampling the light. We would like
a PDF that combines these.

</p>
<a class="target" name="thepdfclass">&nbsp;</a><a class="target" name="mixturedensities/thepdfclass">&nbsp;</a><a class="target" name="toc10.1">&nbsp;</a><h2>The PDF Class</h2>
<p>

We've worked with PDFs in quite a lot of code already. I think that now is a good time to figure out
how we want to standardize our usage of PDFs. We already know that we are going to have a PDF for
the surface and a PDF for the light, so let's create a <code>pdf</code> base class. So far, we've had a <code>pdf()</code>
function that took a direction and returned the PDF's distribution value for that direction. This
value has so far been one of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-487-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5409" style="width: 1.81em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.501em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.5em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5410"><span class="mn" id="MathJax-Span-5411"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="texatom" id="MathJax-Span-5412"><span class="mrow" id="MathJax-Span-5413"><span class="mo" id="MathJax-Span-5414"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="mn" id="MathJax-Span-5415"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">4</span></span><span class="mi" id="MathJax-Span-5416"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>4</mn><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-487">1/4\pi</script>, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-488-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5417" style="width: 1.81em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.501em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.5em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5418"><span class="mn" id="MathJax-Span-5419"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="texatom" id="MathJax-Span-5420"><span class="mrow" id="MathJax-Span-5421"><span class="mo" id="MathJax-Span-5422"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="mn" id="MathJax-Span-5423"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-5424"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-488">1/2\pi</script>, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-489-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5425" style="width: 3.308em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.74em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1002.74em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5426"><span class="mi" id="MathJax-Span-5427"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-5428"></span><span class="mo" id="MathJax-Span-5429"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-5430"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-5431"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="texatom" id="MathJax-Span-5432"><span class="mrow" id="MathJax-Span-5433"><span class="mo" id="MathJax-Span-5434"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="mi" id="MathJax-Span-5435"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-489">\cos(\theta)/\pi</script>. In a couple of our examples
we generated the random direction using a different distribution than the distribution of the PDF.
We covered this quite a lot in the chapter <a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#playingwithimportancesampling">Playing with Importance Sampling</a>. In general, if we know
the distribution of our random directions, we should use a PDF with the same distribution. This will
lead to the fastest convergence. With that in mind, we'll create a <code>pdf</code> class that is responsible
for generating random directions and determining the value of the PDF.

</p><p>

From all of this, any <code>pdf</code> class should be responsible for

</p><p>

</p><ol start="1">
  <li class="number">returning a random direction weighted by the internal PDF distribution, and
</li>
  <li class="number">returning the corresponding PDF distribution value in that direction.</li></ol>

<p></p><p>

</p><div class="together">
The details of how this is done under the hood varies for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-490-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;pSurface&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5436" style="width: 3.567em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.947em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1002.95em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5437"><span class="mi" id="MathJax-Span-5438"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">S</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">u</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>pSurface</mi></math></span></span><script type="math/tex" id="MathJax-Element-490">\operatorname{pSurface}</script> and
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-491-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;pLight&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5439" style="width: 2.689em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.224em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1002.22em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5440"><span class="mi" id="MathJax-Span-5441"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">L</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">g</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">h</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>pLight</mi></math></span></span><script type="math/tex" id="MathJax-Element-491">\operatorname{pLight}</script>, but that is exactly what class hierarchies were invented for! It’s never
obvious what goes in an abstract class, so my approach is to be greedy and hope a minimal interface
works, and for <code>pdf</code> this implies:

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">ifndef</span> PDF_H</span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">define</span> PDF_H</span>
<span class="line"></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"rtweekend.h"</span></span>
<span class="line"></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"onb.h"</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">pdf</span> {
<span class="line"></span>  <span class="hljs-keyword">public</span>:
<span class="line"></span>    <span class="hljs-keyword">virtual</span> ~<span class="hljs-built_in">pdf</span>() {}
<span class="line"></span>
<span class="line"></span>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">double</span> <span class="hljs-title">value</span><span class="hljs-params">(<span class="hljs-type">const</span> vec3&amp; direction)</span> <span class="hljs-type">const</span> </span>= <span class="hljs-number">0</span>;
<span class="line"></span>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> vec3 <span class="hljs-title">generate</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>= <span class="hljs-number">0</span>;
<span class="line"></span>};
<span class="line"></span>
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">endif</span></span></code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_class-pdf">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;34:</b> <kbd>[pdf.h]</kbd> The abstract pdf class</div></center>
<p>


</p></div>

<p></p><p>

</p><div class="together">
We’ll see if we need to add anything else to <code>pdf</code> by fleshing out the subclasses. First, we'll
create a uniform density over the unit sphere:

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">sphere_pdf</span> : <span class="hljs-keyword">public</span> pdf {
<span class="line"></span>  <span class="hljs-keyword">public</span>:
<span class="line"></span>    <span class="hljs-built_in">sphere_pdf</span>() { }
<span class="line"></span>
<span class="line"></span>    <span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">value</span><span class="hljs-params">(<span class="hljs-type">const</span> vec3&amp; direction)</span> <span class="hljs-type">const</span> <span class="hljs-keyword">override</span> </span>{
<span class="line"></span>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>/ (<span class="hljs-number">4</span> * pi);
<span class="line"></span>    }
<span class="line"></span>
<span class="line"></span>    <span class="hljs-function">vec3 <span class="hljs-title">generate</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> <span class="hljs-keyword">override</span> </span>{
<span class="line"></span>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">random_unit_vector</span>();
<span class="line"></span>    }
<span class="line"></span>};</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_class-uni-pdf">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;35:</b> <kbd>[pdf.h]</kbd> The uniform_pdf class</div></center>
<p>


</p></div>

<p></p><p>

</p><div class="together">
Next, let’s try a cosine density:

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">cosine_pdf</span> : <span class="hljs-keyword">public</span> pdf {
<span class="line"></span>  <span class="hljs-keyword">public</span>:
<span class="line"></span>    <span class="hljs-built_in">cosine_pdf</span>(<span class="hljs-type">const</span> vec3&amp; w) { uvw.<span class="hljs-built_in">build_from_w</span>(w); }
<span class="line"></span>
<span class="line"></span>    <span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">value</span><span class="hljs-params">(<span class="hljs-type">const</span> vec3&amp; direction)</span> <span class="hljs-type">const</span> <span class="hljs-keyword">override</span> </span>{
<span class="line"></span>        <span class="hljs-keyword">auto</span> cosine_theta = <span class="hljs-built_in">dot</span>(<span class="hljs-built_in">unit_vector</span>(direction), uvw.<span class="hljs-built_in">w</span>());
<span class="line"></span>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">fmax</span>(<span class="hljs-number">0</span>, cosine_theta/pi);
<span class="line"></span>    }
<span class="line"></span>
<span class="line"></span>    <span class="hljs-function">vec3 <span class="hljs-title">generate</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> <span class="hljs-keyword">override</span> </span>{
<span class="line"></span>        <span class="hljs-keyword">return</span> uvw.<span class="hljs-built_in">local</span>(<span class="hljs-built_in">random_cosine_direction</span>());
<span class="line"></span>    }
<span class="line"></span>
<span class="line"></span>  <span class="hljs-keyword">private</span>:
<span class="line"></span>    onb uvw;
<span class="line"></span>};</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_class-cos-pdf">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;36:</b> <kbd>[pdf.h]</kbd> The cosine_pdf class</div></center>
<p>


</p></div>

<p></p><p>

</p><div class="together">
We can try this cosine PDF in the <code>ray_color()</code> function:

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">camera</span> {
<span class="line"></span>  ...
<span class="line"></span>  <span class="hljs-keyword">private</span>:
<span class="line"></span>    ...
<span class="line"></span>    <span class="hljs-function">color <span class="hljs-title">ray_color</span><span class="hljs-params">(<span class="hljs-type">const</span> ray&amp; r, <span class="hljs-type">int</span> depth, <span class="hljs-type">const</span> hittable&amp; world)</span> <span class="hljs-type">const</span> </span>{
<span class="line"></span>        <span class="hljs-comment">// If we've exceeded the ray bounce limit, no more light is gathered.</span>
<span class="line"></span>        <span class="hljs-keyword">if</span> (depth &lt;= <span class="hljs-number">0</span>)
<span class="line"></span>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">color</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>);
<span class="line"></span>
<span class="line"></span>        hit_record rec;
<span class="line"></span>
<span class="line"></span>        <span class="hljs-comment">// If the ray hits nothing, return the background color.</span>
<span class="line"></span>        <span class="hljs-keyword">if</span> (!world.<span class="hljs-built_in">hit</span>(r, <span class="hljs-built_in">interval</span>(<span class="hljs-number">0.001</span>, infinity), rec))
<span class="line"></span>            <span class="hljs-keyword">return</span> background;
<span class="line"></span>
<span class="line"></span>        ray scattered;
<span class="line"></span>        color attenuation;<div class=" highlight"><span class="line"></span>        <span class="hljs-type">double</span> pdf_val;
<span class="line"></span>        color color_from_emission = rec.mat-&gt;<span class="hljs-built_in">emitted</span>(r, rec, rec.u, rec.v, rec.p);</div><span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">if</span> (!rec.mat-&gt;<span class="hljs-built_in">scatter</span>(r, rec, attenuation, scattered, pdf_val))
<span class="line"></span>            <span class="hljs-keyword">return</span> color_from_emission;
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>        <span class="hljs-function">cosine_pdf <span class="hljs-title">surface_pdf</span><span class="hljs-params">(rec.normal)</span></span>;
<span class="line"></span>        scattered = <span class="hljs-built_in">ray</span>(rec.p, surface_pdf.<span class="hljs-built_in">generate</span>(), r.<span class="hljs-built_in">time</span>());
<span class="line"></span>        pdf_val = surface_pdf.<span class="hljs-built_in">value</span>(scattered.<span class="hljs-built_in">direction</span>());</div><span class="line"></span>
<span class="line"></span>        <span class="hljs-type">double</span> scattering_pdf = rec.mat-&gt;<span class="hljs-built_in">scattering_pdf</span>(r, rec, scattered);
<span class="line"></span>
<span class="line"></span>        color color_from_scatter =<div class=" highlight"><span class="line"></span>            (attenuation * scattering_pdf * <span class="hljs-built_in">ray_color</span>(scattered, depth<span class="hljs-number">-1</span>, world)) / pdf_val;</div><span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">return</span> color_from_emission + color_from_scatter;
<span class="line"></span>    }
<span class="line"></span>};</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_ray-color-cos-pdf">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;37:</b> <kbd>[camera.h]</kbd> The ray_color function, using cosine pdf</div></center>
<p>


</p></div>

<p></p><p>

</p><div class="together">
This yields an exactly matching result so all we’ve done so far is move some computation up into the
<code>cosine_pdf</code> class:

<p></p><p>

  </p><center><div class="image" style=""><a href="./input_files/img-3.09-cornell-cos-pdf.jpg" target="_blank"><img class="markdeep pixel" src="./input_files/img-3.09-cornell-cos-pdf.jpg"></a><center><span class="imagecaption"><span class="num">Image 9:</span> Cornell box with a cosine density PDF
  </span></center></div></center>

<p></p><p>

</p></div>

<p></p>
<a class="target" name="samplingdirectionstowardsahittable">&nbsp;</a><a class="target" name="mixturedensities/samplingdirectionstowardsahittable">&nbsp;</a><a class="target" name="toc10.2">&nbsp;</a><h2>Sampling Directions towards a Hittable</h2>
<p>

Now we can try sampling directions toward a <code>hittable</code>, like the light.

</p><pre class="listing tilde"><code><span class="line"></span>...
<span class="line"></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"hittable_list.h"</span></span>
<span class="line"></span>...
<span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">hittable_pdf</span> : <span class="hljs-keyword">public</span> pdf {
<span class="line"></span>  <span class="hljs-keyword">public</span>:
<span class="line"></span>    <span class="hljs-built_in">hittable_pdf</span>(<span class="hljs-type">const</span> hittable&amp; objects, <span class="hljs-type">const</span> point3&amp; origin)
<span class="line"></span>      : <span class="hljs-built_in">objects</span>(objects), <span class="hljs-built_in">origin</span>(origin)
<span class="line"></span>    {}
<span class="line"></span>
<span class="line"></span>    <span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">value</span><span class="hljs-params">(<span class="hljs-type">const</span> vec3&amp; direction)</span> <span class="hljs-type">const</span> <span class="hljs-keyword">override</span> </span>{
<span class="line"></span>        <span class="hljs-keyword">return</span> objects.<span class="hljs-built_in">pdf_value</span>(origin, direction);
<span class="line"></span>    }
<span class="line"></span>
<span class="line"></span>    <span class="hljs-function">vec3 <span class="hljs-title">generate</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> <span class="hljs-keyword">override</span> </span>{
<span class="line"></span>        <span class="hljs-keyword">return</span> objects.<span class="hljs-built_in">random</span>(origin);
<span class="line"></span>    }
<span class="line"></span>
<span class="line"></span>  <span class="hljs-keyword">private</span>:
<span class="line"></span>    <span class="hljs-type">const</span> hittable&amp; objects;
<span class="line"></span>    point3 origin;
<span class="line"></span>};</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_class-hittable-pdf">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;38:</b> <kbd>[pdf.h]</kbd> The hittable_pdf class</div></center>
<p>


If we want to sample the light, we will need <code>hittable</code> to answer some queries that it doesn’t yet
have an interface for. The above code assumes the existence of two as-of-yet unimplemented functions
in the <code>hittable</code> class: <code>pdf_value()</code> and <code>random()</code>. We need to add these functions for the
program to compile. We could go through all of the <code>hittable</code> subclasses and add these functions,
but that would be a hassle, so we’ll just add two trivial functions to the <code>hittable</code> base class.
This breaks our previously pure abstract implementation, but it saves work. Feel free to write these
functions through to subclasses if you want a purely abstract <code>hittable</code> interface class.

</p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">hittable</span> {
<span class="line"></span>  <span class="hljs-keyword">public</span>:
<span class="line"></span>    ...
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">double</span> <span class="hljs-title">pdf_value</span><span class="hljs-params">(<span class="hljs-type">const</span> point3&amp; origin, <span class="hljs-type">const</span> vec3&amp; direction)</span> <span class="hljs-type">const</span> </span>{
<span class="line"></span>        <span class="hljs-keyword">return</span> <span class="hljs-number">0.0</span>;
<span class="line"></span>    }
<span class="line"></span>
<span class="line"></span>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> vec3 <span class="hljs-title">random</span><span class="hljs-params">(<span class="hljs-type">const</span> point3&amp; origin)</span> <span class="hljs-type">const</span> </span>{
<span class="line"></span>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">vec3</span>(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
<span class="line"></span>    }</div><span class="line"></span>};</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_hittable-plus2">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;39:</b> <kbd>[hittable.h]</kbd> The hittable class, with two new methods</div></center>
<p>


</p><div class="together">
And then we change <code>quad</code> to implement those functions:

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">quad</span> : <span class="hljs-keyword">public</span> hittable {
<span class="line"></span>  <span class="hljs-keyword">public</span>:
<span class="line"></span>    <span class="hljs-built_in">quad</span>(<span class="hljs-type">const</span> point3&amp; Q, <span class="hljs-type">const</span> vec3&amp; u, <span class="hljs-type">const</span> vec3&amp; v, shared_ptr&lt;material&gt; mat)
<span class="line"></span>      : <span class="hljs-built_in">Q</span>(Q), <span class="hljs-built_in">u</span>(u), <span class="hljs-built_in">v</span>(v), <span class="hljs-built_in">mat</span>(mat)
<span class="line"></span>    {
<span class="line"></span>        <span class="hljs-keyword">auto</span> n = <span class="hljs-built_in">cross</span>(u, v);
<span class="line"></span>        normal = <span class="hljs-built_in">unit_vector</span>(n);
<span class="line"></span>        D = <span class="hljs-built_in">dot</span>(normal, Q);
<span class="line"></span>        w = n / <span class="hljs-built_in">dot</span>(n,n);
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>        area = n.<span class="hljs-built_in">length</span>();</div><span class="line"></span>
<span class="line"></span>        <span class="hljs-built_in">set_bounding_box</span>();
<span class="line"></span>    }
<span class="line"></span>    ...
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>    <span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">pdf_value</span><span class="hljs-params">(<span class="hljs-type">const</span> point3&amp; origin, <span class="hljs-type">const</span> vec3&amp; direction)</span> <span class="hljs-type">const</span> <span class="hljs-keyword">override</span> </span>{
<span class="line"></span>        hit_record rec;
<span class="line"></span>        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>-&gt;<span class="hljs-built_in">hit</span>(<span class="hljs-built_in">ray</span>(origin, direction), <span class="hljs-built_in">interval</span>(<span class="hljs-number">0.001</span>, infinity), rec))
<span class="line"></span>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
<span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">auto</span> distance_squared = rec.t * rec.t * direction.<span class="hljs-built_in">length_squared</span>();
<span class="line"></span>        <span class="hljs-keyword">auto</span> cosine = <span class="hljs-built_in">fabs</span>(<span class="hljs-built_in">dot</span>(direction, rec.normal) / direction.<span class="hljs-built_in">length</span>());
<span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">return</span> distance_squared / (cosine * area);
<span class="line"></span>    }
<span class="line"></span>
<span class="line"></span>    <span class="hljs-function">vec3 <span class="hljs-title">random</span><span class="hljs-params">(<span class="hljs-type">const</span> point3&amp; origin)</span> <span class="hljs-type">const</span> <span class="hljs-keyword">override</span> </span>{
<span class="line"></span>        <span class="hljs-keyword">auto</span> p = Q + (<span class="hljs-built_in">random_double</span>() * u) + (<span class="hljs-built_in">random_double</span>() * v);
<span class="line"></span>        <span class="hljs-keyword">return</span> p - origin;
<span class="line"></span>    }</div><span class="line"></span>
<span class="line"></span>  <span class="hljs-keyword">private</span>:
<span class="line"></span>    point3 Q;
<span class="line"></span>    vec3 u, v;
<span class="line"></span>    vec3 w;
<span class="line"></span>    shared_ptr&lt;material&gt; mat;
<span class="line"></span>    aabb bbox;
<span class="line"></span>    vec3 normal;
<span class="line"></span>    <span class="hljs-type">double</span> D;<div class=" highlight"><span class="line"></span>    <span class="hljs-type">double</span> area;</div><span class="line"></span>};</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_quad-pdf">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;40:</b> <kbd>[quad.h]</kbd> quad with pdf</div></center>
<p>


</p></div>

<p></p><p>

We only need to add <code>pdf_value()</code> and <code>random()</code> to <code>quad</code> because we're using this to importance
sample the light, and the only light we have in our scene is a <code>quad</code>. if you want other light
geometries, or want to use a PDF with other objects, you'll need to implement the above functions
for the corresponding classes.

</p><p>

</p><div class="together">
Add a <code>lights</code> parameter to the camera <code>render()</code> function:

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">camera</span> {
<span class="line"></span>  <span class="hljs-keyword">public</span>:
<span class="line"></span>    ...<div class=" highlight"><span class="line"></span>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">render</span><span class="hljs-params">(<span class="hljs-type">const</span> hittable&amp; world, <span class="hljs-type">const</span> hittable&amp; lights)</span> </span>{</div><span class="line"></span>        <span class="hljs-built_in">initialize</span>();
<span class="line"></span>
<span class="line"></span>        std::cout &lt;&lt; <span class="hljs-string">"P3\n"</span> &lt;&lt; image_width &lt;&lt; <span class="hljs-string">' '</span> &lt;&lt; image_height &lt;&lt; <span class="hljs-string">"\n255\n"</span>;
<span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; image_height; j++) {
<span class="line"></span>            std::clog &lt;&lt; <span class="hljs-string">"\rScanlines remaining: "</span> &lt;&lt; (image_height - j) &lt;&lt; <span class="hljs-string">' '</span> &lt;&lt; std::flush;
<span class="line"></span>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; image_width; i++) {
<span class="line"></span>                <span class="hljs-function">color <span class="hljs-title">pixel_color</span><span class="hljs-params">(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>)</span></span>;
<span class="line"></span>                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> s_j = <span class="hljs-number">0</span>; s_j &lt; sqrt_spp; s_j++) {
<span class="line"></span>                    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> s_i = <span class="hljs-number">0</span>; s_i &lt; sqrt_spp; s_i++) {
<span class="line"></span>                        ray r = <span class="hljs-built_in">get_ray</span>(i, j, s_i, s_j);<div class=" highlight"><span class="line"></span>                        pixel_color += <span class="hljs-built_in">ray_color</span>(r, max_depth, world, lights);</div><span class="line"></span>                    }
<span class="line"></span>                }
<span class="line"></span>                <span class="hljs-built_in">write_color</span>(std::cout, pixel_samples_scale * pixel_color);
<span class="line"></span>            }
<span class="line"></span>        }
<span class="line"></span>
<span class="line"></span>        std::clog &lt;&lt; <span class="hljs-string">"\rDone.                 \n"</span>;
<span class="line"></span>    }
<span class="line"></span>
<span class="line"></span>    ...
<span class="line"></span>  <span class="hljs-keyword">private</span>:
<span class="line"></span>    ...
<span class="line"></span>    <span class="hljs-function">color <span class="hljs-title">ray_color</span><span class="hljs-params">(<span class="hljs-type">const</span> ray&amp; r, <span class="hljs-type">int</span> depth, <span class="hljs-type">const</span> hittable&amp; world, <span class="hljs-type">const</span> hittable&amp; lights)</span>
<span class="line"></span>    <span class="hljs-type">const</span> </span>{
<span class="line"></span>        ...
<span class="line"></span>
<span class="line"></span>        ray scattered;
<span class="line"></span>        color attenuation;
<span class="line"></span>        <span class="hljs-type">double</span> pdf_val;
<span class="line"></span>        color color_from_emission = rec.mat-&gt;<span class="hljs-built_in">emitted</span>(r, rec, rec.u, rec.v, rec.p);
<span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">if</span> (!rec.mat-&gt;<span class="hljs-built_in">scatter</span>(r, rec, attenuation, scattered, pdf_val))
<span class="line"></span>            <span class="hljs-keyword">return</span> color_from_emission;
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>        <span class="hljs-function">hittable_pdf <span class="hljs-title">light_pdf</span><span class="hljs-params">(light_ptr, rec.p)</span></span>;
<span class="line"></span>        scattered = <span class="hljs-built_in">ray</span>(rec.p, light_pdf.<span class="hljs-built_in">generate</span>(), r.<span class="hljs-built_in">time</span>());
<span class="line"></span>        pdf_val = light_pdf.<span class="hljs-built_in">value</span>(scattered.<span class="hljs-built_in">direction</span>());</div><span class="line"></span>
<span class="line"></span>        <span class="hljs-type">double</span> scattering_pdf = rec.mat-&gt;<span class="hljs-built_in">scattering_pdf</span>(r, rec, scattered);
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>        color sample_color = <span class="hljs-built_in">ray_color</span>(scattered, depth<span class="hljs-number">-1</span>, world, lights);
<span class="line"></span>        color color_from_scatter = (attenuation * scattering_pdf * sample_color) / pdf_val;</div><span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">return</span> color_from_emission + color_from_scatter;
<span class="line"></span>    }
<span class="line"></span>};</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_ray-color-lights">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;41:</b> <kbd>[camera.h]</kbd> ray_color function with light PDF</div></center>
<p>


</p></div>

<p></p><p>

</p><div class="together">
Create a light in the middle of the ceiling:

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
<span class="line"></span>    ...
<span class="line"></span>
<span class="line"></span>    <span class="hljs-comment">// Box 2</span>
<span class="line"></span>    shared_ptr&lt;hittable&gt; box2 = <span class="hljs-built_in">box</span>(<span class="hljs-built_in">point3</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>), <span class="hljs-built_in">point3</span>(<span class="hljs-number">165</span>,<span class="hljs-number">165</span>,<span class="hljs-number">165</span>), white);
<span class="line"></span>    box2 = <span class="hljs-built_in">make_shared</span>&lt;rotate_y&gt;(box2, <span class="hljs-number">-18</span>);
<span class="line"></span>    box2 = <span class="hljs-built_in">make_shared</span>&lt;translate&gt;(box2, <span class="hljs-built_in">vec3</span>(<span class="hljs-number">130</span>,<span class="hljs-number">0</span>,<span class="hljs-number">65</span>));
<span class="line"></span>    world.<span class="hljs-built_in">add</span>(box2);
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>    <span class="hljs-comment">// Light Sources</span>
<span class="line"></span>    hittable_list lights;
<span class="line"></span>    <span class="hljs-keyword">auto</span> m = <span class="hljs-built_in">shared_ptr</span>&lt;material&gt;();
<span class="line"></span>    lights.<span class="hljs-built_in">add</span>(<span class="hljs-built_in">make_shared</span>&lt;quad&gt;(<span class="hljs-built_in">point3</span>(<span class="hljs-number">343</span>,<span class="hljs-number">554</span>,<span class="hljs-number">332</span>), <span class="hljs-built_in">vec3</span>(<span class="hljs-number">-130</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>), <span class="hljs-built_in">vec3</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">-105</span>), m));</div><span class="line"></span>
<span class="line"></span>    camera cam;
<span class="line"></span>    ...
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>    cam.<span class="hljs-built_in">render</span>(world, lights);</div><span class="line"></span>}</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_ray-color-hittable-pdf">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;42:</b> <kbd>[main.cc]</kbd> Adding a light to the Cornell box</div></center>
<p>


</p></div>

<p></p><p>

</p><div class="together">
At 10 samples per pixel we get:

<p></p><p>

  </p><center><div class="image" style=""><a href="./input_files/img-3.10-hittable-light.jpg" target="_blank"><img class="markdeep pixel" src="./input_files/img-3.10-hittable-light.jpg"></a><center><span class="imagecaption"><span class="num">Image 10:</span> Cornell box, sampling a hittable light, 10 samples per pixel
  </span></center></div></center>

<p></p><p>

</p></div>

<p></p>
<a class="target" name="themixturepdfclass">&nbsp;</a><a class="target" name="mixturedensities/themixturepdfclass">&nbsp;</a><a class="target" name="toc10.3">&nbsp;</a><h2>The Mixture PDF Class</h2>
<p>

As was briefly mentioned in the chapter <a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#playingwithimportancesampling">Playing with Importance Sampling</a>, we can create linear
mixtures of any PDFs to form mixture densities that are also PDFs. Any weighted average of PDFs is
also a PDF. As long as the weights are positive and add up to any one, we have a new PDF.

</p><p>

  <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-492-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;pMixture&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5442" style="width: 24.331em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.096em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1020.1em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5443"><span class="mi" id="MathJax-Span-5444"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">M</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">u</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span><span class="mo" id="MathJax-Span-5445"></span><span class="mo" id="MathJax-Span-5446"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mo" id="MathJax-Span-5447"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-5448" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="msubsup" id="MathJax-Span-5449" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.62em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5450"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">w</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.622em;"><span class="mn" id="MathJax-Span-5451" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-5452"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5453"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mn" id="MathJax-Span-5454" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-5455"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mo" id="MathJax-Span-5456"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-5457" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">+</span></span><span class="msubsup" id="MathJax-Span-5458" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.62em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5459"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">w</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.622em;"><span class="mn" id="MathJax-Span-5460" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-5461"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5462"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mn" id="MathJax-Span-5463" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-5464"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mo" id="MathJax-Span-5465"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-5466" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">+</span></span><span class="msubsup" id="MathJax-Span-5467" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.62em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5468"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">w</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.622em;"><span class="mn" id="MathJax-Span-5469" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-5470"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5471"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="mn" id="MathJax-Span-5472" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-5473"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mo" id="MathJax-Span-5474"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-5475" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">+</span></span><span class="mo" id="MathJax-Span-5476" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">…</span></span><span class="mo" id="MathJax-Span-5477" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">+</span></span><span class="msubsup" id="MathJax-Span-5478" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 1.655em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.62em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5479"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">w</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.622em;"><span class="texatom" id="MathJax-Span-5480"><span class="mrow" id="MathJax-Span-5481"><span class="mi" id="MathJax-Span-5482" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mo" id="MathJax-Span-5483" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mn" id="MathJax-Span-5484" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-5485"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5486"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="texatom" id="MathJax-Span-5487"><span class="mrow" id="MathJax-Span-5488"><span class="mi" id="MathJax-Span-5489" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mo" id="MathJax-Span-5490" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mn" id="MathJax-Span-5491" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-5492"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mo" id="MathJax-Span-5493"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>pMixture</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo>=</mo><msub><mi>w</mi><mn>0</mn></msub><msub><mi>p</mi><mn>0</mn></msub><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo>+</mo><msub><mi>w</mi><mn>1</mn></msub><msub><mi>p</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo>+</mo><msub><mi>w</mi><mn>2</mn></msub><msub><mi>p</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo>+</mo><mo>…</mo><mo>+</mo><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-492"> \operatorname{pMixture}() = w_0 p_0() + w_1 p_1() + w_2 p_2() + \ldots + w_{n-1} p_{n-1}() </script>

</p><p>

  <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-493-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5494" style="width: 13.226em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.901em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1010.9em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5495"><span class="mn" id="MathJax-Span-5496"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-5497" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="msubsup" id="MathJax-Span-5498" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.62em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5499"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">w</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.622em;"><span class="mn" id="MathJax-Span-5500" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-5501" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">+</span></span><span class="msubsup" id="MathJax-Span-5502" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.62em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5503"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">w</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.622em;"><span class="mn" id="MathJax-Span-5504" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-5505" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">+</span></span><span class="msubsup" id="MathJax-Span-5506" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.62em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5507"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">w</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.622em;"><span class="mn" id="MathJax-Span-5508" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-5509" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">+</span></span><span class="mo" id="MathJax-Span-5510" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">…</span></span><span class="mo" id="MathJax-Span-5511" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">+</span></span><span class="msubsup" id="MathJax-Span-5512" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 1.655em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.62em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5513"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">w</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.622em;"><span class="texatom" id="MathJax-Span-5514"><span class="mrow" id="MathJax-Span-5515"><span class="mi" id="MathJax-Span-5516" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mo" id="MathJax-Span-5517" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mn" id="MathJax-Span-5518" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mn>1</mn><mo>=</mo><msub><mi>w</mi><mn>0</mn></msub><mo>+</mo><msub><mi>w</mi><mn>1</mn></msub><mo>+</mo><msub><mi>w</mi><mn>2</mn></msub><mo>+</mo><mo>…</mo><mo>+</mo><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-493"> 1 = w_0 + w_1 + w_2 + \ldots + w_{n-1} </script>

</p><p>

For example, we could just average the two densities:

</p><p>

  <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-494-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;pMixture&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;pSurface&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;pLight&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5519" style="width: 19.527em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.118em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1016.12em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5520"><span class="mi" id="MathJax-Span-5521"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">M</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">u</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span><span class="mo" id="MathJax-Span-5522"></span><span class="mo" id="MathJax-Span-5523"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-5524"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5525"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-5526" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-5527"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-5528" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-5529" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-5530"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-5531"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.52em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.519em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mi" id="MathJax-Span-5532"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">S</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">u</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span><span class="mo" id="MathJax-Span-5533"></span><span class="mo" id="MathJax-Span-5534"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-5535"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5536"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-5537" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-5538"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-5539" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">+</span></span><span class="mfrac" id="MathJax-Span-5540" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-5541"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -1.444em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-5542"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.52em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.519em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mi" id="MathJax-Span-5543"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">L</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">g</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">h</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span></span><span class="mo" id="MathJax-Span-5544"></span><span class="mo" id="MathJax-Span-5545"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-5546"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5547"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.519em;"><span class="mi" id="MathJax-Span-5548" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-5549"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>pMixture</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>ω</mi><mi>o</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>pSurface</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>ω</mi><mi>o</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>pLight</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>ω</mi><mi>o</mi></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-494"> \operatorname{pMixture}(\omega_o)
     = \frac{1}{2} \operatorname{pSurface}(\omega_o) + \frac{1}{2} \operatorname{pLight}(\omega_o)
  </script>

</p><p>

</p><div class="together">
How would we instrument our code to do that? There is a very important detail that makes this not
quite as easy as one might expect. Generating the random direction for a mixture PDF is simple:

<p></p><pre class="listing tilde"><code><span class="line"></span>if (random_double() &lt; <span class="hljs-number">0.5</span>)
<span class="line"></span>    pick <span class="hljs-attribute">direction</span> according <span class="hljs-selector-tag">to</span> pSurface
<span class="line"></span>else
<span class="line"></span>    pick <span class="hljs-attribute">direction</span> according <span class="hljs-selector-tag">to</span> pLight</code></pre><p>

</p></div>

<p></p><p>

But solving for the PDF value of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-495-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;pMixture&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5550" style="width: 3.773em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.102em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1003.1em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5551"><span class="mi" id="MathJax-Span-5552"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">M</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">u</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>pMixture</mi></math></span></span><script type="math/tex" id="MathJax-Element-495">\operatorname{pMixture}</script> is slightly more subtle. We can't just

</p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-keyword">if</span> (direction <span class="hljs-keyword">is</span> <span class="hljs-keyword">from</span> pSurface)
<span class="line"></span>    <span class="hljs-keyword">get</span> PDF <span class="hljs-keyword">value</span> of pSurface
<span class="line"></span><span class="hljs-keyword">else</span>
<span class="line"></span>    <span class="hljs-keyword">get</span> PDF <span class="hljs-keyword">value</span> of pLight</code></pre><p>



</p><div class="together">
For one, figuring out which PDF the random direction came from is probably not trivial. We don't
have any plumbing for <code>generate()</code> to tell <code>value()</code> what the original <code>random_double()</code> was, so we
can't trivially say which PDF the random direction comes from. If we thought that the above was
correct, we would have to solve backwards to figure which PDF the direction could come from. Which
honestly sounds like a nightmare, but fortunately we don't need to do that. There are some
directions that both PDFs could have generated. For example, a direction toward the light could have
been generated by either <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-496-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;pLight&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5553" style="width: 2.689em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.224em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1002.22em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5554"><span class="mi" id="MathJax-Span-5555"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">L</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">g</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">h</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>pLight</mi></math></span></span><script type="math/tex" id="MathJax-Element-496">\operatorname{pLight}</script> <em class="underscore">or</em> <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-497-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;pSurface&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5556" style="width: 3.567em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.947em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1002.95em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5557"><span class="mi" id="MathJax-Span-5558"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">S</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">u</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>pSurface</mi></math></span></span><script type="math/tex" id="MathJax-Element-497">\operatorname{pSurface}</script>. It is sufficient
for us to solve for the pdf value of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-498-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;pSurface&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5559" style="width: 3.567em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.947em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1002.95em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5560"><span class="mi" id="MathJax-Span-5561"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">S</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">u</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>pSurface</mi></math></span></span><script type="math/tex" id="MathJax-Element-498">\operatorname{pSurface}</script> and of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-499-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;pLight&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5562" style="width: 2.689em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.224em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1002.22em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5563"><span class="mi" id="MathJax-Span-5564"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">L</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">g</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">h</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>pLight</mi></math></span></span><script type="math/tex" id="MathJax-Element-499">\operatorname{pLight}</script> for a
random direction and then take the PDF mixture weights to solve for the total PDF value for that
direction. The mixture density class is actually pretty straightforward:

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">mixture_pdf</span> : <span class="hljs-keyword">public</span> pdf {
<span class="line"></span>  <span class="hljs-keyword">public</span>:
<span class="line"></span>    <span class="hljs-built_in">mixture_pdf</span>(shared_ptr&lt;pdf&gt; p0, shared_ptr&lt;pdf&gt; p1) {
<span class="line"></span>        p[<span class="hljs-number">0</span>] = p0;
<span class="line"></span>        p[<span class="hljs-number">1</span>] = p1;
<span class="line"></span>    }
<span class="line"></span>
<span class="line"></span>    <span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">value</span><span class="hljs-params">(<span class="hljs-type">const</span> vec3&amp; direction)</span> <span class="hljs-type">const</span> <span class="hljs-keyword">override</span> </span>{
<span class="line"></span>        <span class="hljs-keyword">return</span> <span class="hljs-number">0.5</span> * p[<span class="hljs-number">0</span>]-&gt;<span class="hljs-built_in">value</span>(direction) + <span class="hljs-number">0.5</span> *p[<span class="hljs-number">1</span>]-&gt;<span class="hljs-built_in">value</span>(direction);
<span class="line"></span>    }
<span class="line"></span>
<span class="line"></span>    <span class="hljs-function">vec3 <span class="hljs-title">generate</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> <span class="hljs-keyword">override</span> </span>{
<span class="line"></span>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">random_double</span>() &lt; <span class="hljs-number">0.5</span>)
<span class="line"></span>            <span class="hljs-keyword">return</span> p[<span class="hljs-number">0</span>]-&gt;<span class="hljs-built_in">generate</span>();
<span class="line"></span>        <span class="hljs-keyword">else</span>
<span class="line"></span>            <span class="hljs-keyword">return</span> p[<span class="hljs-number">1</span>]-&gt;<span class="hljs-built_in">generate</span>();
<span class="line"></span>    }
<span class="line"></span>
<span class="line"></span>  <span class="hljs-keyword">private</span>:
<span class="line"></span>    shared_ptr&lt;pdf&gt; p[<span class="hljs-number">2</span>];
<span class="line"></span>};</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_class-mixturep-df">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;43:</b> <kbd>[pdf.h]</kbd> The mixture_pdf class</div></center>
<p>


</p></div>

<p></p><p>

</p><div class="together">
Now we would like to do a mixture density of the cosine sampling and of the light sampling. We can
plug it into <code>ray_color()</code>:

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">camera</span> {
<span class="line"></span>  ...
<span class="line"></span>  <span class="hljs-keyword">private</span>:
<span class="line"></span>    ...
<span class="line"></span>    <span class="hljs-function">color <span class="hljs-title">ray_color</span><span class="hljs-params">(<span class="hljs-type">const</span> ray&amp; r, <span class="hljs-type">int</span> depth, <span class="hljs-type">const</span> hittable&amp; world, <span class="hljs-type">const</span> hittable&amp; lights)</span>
<span class="line"></span>    <span class="hljs-type">const</span> </span>{
<span class="line"></span>        ...
<span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">if</span> (!rec.mat-&gt;<span class="hljs-built_in">scatter</span>(r, rec, attenuation, scattered, pdf_val))
<span class="line"></span>            <span class="hljs-keyword">return</span> color_from_emission;
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>        <span class="hljs-keyword">auto</span> p0 = <span class="hljs-built_in">make_shared</span>&lt;hittable_pdf&gt;(light_ptr, rec.p);
<span class="line"></span>        <span class="hljs-keyword">auto</span> p1 = <span class="hljs-built_in">make_shared</span>&lt;cosine_pdf&gt;(rec.normal);
<span class="line"></span>        <span class="hljs-function">mixture_pdf <span class="hljs-title">mixed_pdf</span><span class="hljs-params">(p0, p1)</span></span>;
<span class="line"></span>
<span class="line"></span>        scattered = <span class="hljs-built_in">ray</span>(rec.p, mixed_pdf.<span class="hljs-built_in">generate</span>(), r.<span class="hljs-built_in">time</span>());
<span class="line"></span>        pdf_val = mixed_pdf.<span class="hljs-built_in">value</span>(scattered.<span class="hljs-built_in">direction</span>());</div><span class="line"></span>
<span class="line"></span>        <span class="hljs-type">double</span> scattering_pdf = rec.mat-&gt;<span class="hljs-built_in">scattering_pdf</span>(r, rec, scattered);
<span class="line"></span>
<span class="line"></span>        color sample_color = <span class="hljs-built_in">ray_color</span>(scattered, depth<span class="hljs-number">-1</span>, world, lights);
<span class="line"></span>        color color_from_scatter = (attenuation * scattering_pdf * sample_color) / pdf_val;
<span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">return</span> color_from_emission + color_from_scatter;
<span class="line"></span>    }</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_ray-color-mixture">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;44:</b> <kbd>[camera.h]</kbd> The ray_color function, using mixture PDF</div></center>
<p>


</p></div>

<p></p><p>

</p><div class="together">
1000 samples per pixel yields:

<p></p><p>

  </p><center><div class="image" style=""><a href="./input_files/img-3.11-cosine-and-light.jpg" target="_blank"><img class="markdeep pixel" src="./input_files/img-3.11-cosine-and-light.jpg"></a><center><span class="imagecaption"><span class="num">Image 11:</span> Cornell box, mixture density of cosine and light sampling
  </span></center></div></center>

<p></p><p>

</p></div>

<p></p>
<a class="target" name="somearchitecturaldecisions">&nbsp;</a><a class="target" name="somearchitecturaldecisions">&nbsp;</a><a class="target" name="toc11">&nbsp;</a><h1>Some Architectural Decisions</h1>
<p>

We won't write any code in this chapter. We’re at a crossroads and we need to make some
architectural decisions.

</p><p>

The mixture-density approach is an alternative to having more traditional shadow rays. These are
rays that check for an unobstructed path from an intersection point to a given light source. Rays
that intersect an object between a point and a given light source indicate that the intersection
point is in the shadow of that particular light source. The mixture-density approach is something
that I personally prefer, because in addition to lights, you can sample windows or bright cracks
under doors or whatever else you think might be bright — or important. But you'll still see shadow
rays in most professional path tracers. Typically they'll have a predefined number of shadow rays
(<em class="underscore">e.g</em> 1, 4, 8, 16) where over the course of rendering, at each place where the path tracing ray
intersects, they'll send these terminal shadow rays to random lights in the scene to determine if
the intersection is lit by that random light. The intersection will either be lit by that light, or
completely in shadow, where more shadow rays lead to a more accurate illumination. After all of the
shadow rays terminate (either at a light or at an occluding surface), the inital path tracing ray
continues on and more shadow rays are sent at the next intersection. You can't tell the shadow rays
what is important, you can only tell them what is emissive, so shadow rays work best on simpler
scenes that don't have overly complicated photon distribution. That said, shadow rays terminate at
the first thing they run into and don't bounce around, so one shadow ray is cheaper than one path
tracing ray, which is the reason that you'll typically see a lot more shadow rays than path tracing
rays (<em class="underscore">e.g</em> 1, 4, 8, 16). You could choose shadow rays over mixture-density in a more restricted
scene; that’s a personal design preference. Shadow rays tend to be cheaper for a crude result than
mixture-density and is becoming increasingly common in realtime.

</p><p>

There are some other issues with the code.

</p><p>

The PDF construction is hard coded in the <code>ray_color()</code> function. We should clean that up.

</p><p>

We've accidentally broken the specular rays (glass and metal), and they are no longer supported. The
math would continue to work out if we just made their scattering function a delta function, but that
would lead to all kinds of floating point disasters. We could either make specular reflection a
special case that skips <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-500-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5565" style="width: 2.43em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.017em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1002.02em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5566"><span class="mi" id="MathJax-Span-5567"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-5568"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mo" id="MathJax-Span-5569"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="texatom" id="MathJax-Span-5570"><span class="mrow" id="MathJax-Span-5571"><span class="mo" id="MathJax-Span-5572"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="mi" id="MathJax-Span-5573"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-5574"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mo" id="MathJax-Span-5575"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>p</mi><mo stretchy="false">(</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-500">f()/p()</script>, or we could set surface roughness to a very small — but nonzero
— value and have almost-mirrors that look perfectly smooth but that don’t generate NaNs. I don’t
have an opinion on which way to do it (I have tried both and they both have their advantages), but
we have smooth metal and glass code anyway, so we'll add perfect specular surfaces that just skip
over explicit <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-501-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5576" style="width: 2.43em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.017em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1002.02em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5577"><span class="mi" id="MathJax-Span-5578"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span><span class="mo" id="MathJax-Span-5579"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mo" id="MathJax-Span-5580"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="texatom" id="MathJax-Span-5581"><span class="mrow" id="MathJax-Span-5582"><span class="mo" id="MathJax-Span-5583"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="mi" id="MathJax-Span-5584"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span><span class="mo" id="MathJax-Span-5585"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mo" id="MathJax-Span-5586"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>p</mi><mo stretchy="false">(</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-501">f()/p()</script> calculations.

</p><p>

We also lack a real background function infrastructure in case we want to add an environment map or
a more interesting functional background. Some environment maps are HDR (the RGB components are
normalized floats rather than 0–255 bytes). Our output has been HDR all along; we’ve just been
truncating it.

</p><p>

Finally, our renderer is RGB. A more physically based one — like an automobile manufacturer might
use — would probably need to use spectral colors and maybe even polarization. For a movie renderer,
most studios still get away with RGB. You can make a hybrid renderer that has both modes, but that
is of course harder. I’m going to stick to RGB for now, but I will touch on this at the end of the
book.

</p>
<a class="target" name="cleaninguppdfmanagement">&nbsp;</a><a class="target" name="cleaninguppdfmanagement">&nbsp;</a><a class="target" name="toc12">&nbsp;</a><h1>Cleaning Up PDF Management</h1>
<p>

So far I have the <code>ray_color()</code> function create two hard-coded PDFs:

</p><p>

</p><ol start="1">
  <li class="number"><code>p0()</code> related to the shape of the light
</li>
  <li class="number"><code>p1()</code> related to the normal vector and type of surface</li></ol>

<p></p><p>

We can pass information about the light (or whatever <code>hittable</code> we want to sample) into the
<code>ray_color()</code> function, and we can ask the <code>material</code> function for a PDF (we would have to add
instrumentation to do that). We also need to know if the scattered ray is specular, and we can do
this either by asking the <code>hit()</code> function or the <code>material</code> class.

</p>
<a class="target" name="diffuseversusspecular">&nbsp;</a><a class="target" name="cleaninguppdfmanagement/diffuseversusspecular">&nbsp;</a><a class="target" name="toc12.1">&nbsp;</a><h2>Diffuse Versus Specular</h2>
<p>

One thing we would like to allow for is a material — like varnished wood — that is partially ideal
specular (the polish) and partially diffuse (the wood). Some renderers have the material generate
two rays: one specular and one diffuse. I am not fond of branching, so I would rather have the
material randomly decide whether it is diffuse or specular. The catch with that approach is that we
need to be careful when we ask for the PDF value, and <code>ray_color()</code> needs to be aware of whether
this ray is diffuse or specular. Fortunately, we have decided that we should only call the
<code>pdf_value()</code> if it is diffuse, so we can handle that implicitly.

</p><p>

</p><div class="together">
We can redesign <code>material</code> and stuff all the new arguments into a class like we did for <code>hittable</code>:

<p></p><pre class="listing tilde"><code><div class=" highlight"><span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">scatter_record</span> {
<span class="line"></span>  <span class="hljs-keyword">public</span>:
<span class="line"></span>    color attenuation;
<span class="line"></span>    shared_ptr&lt;pdf&gt; pdf_ptr;
<span class="line"></span>    <span class="hljs-type">bool</span> skip_pdf;
<span class="line"></span>    ray skip_pdf_ray;
<span class="line"></span>};</div><span class="line"></span>
<span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">material</span> {
<span class="line"></span>  <span class="hljs-keyword">public</span>:
<span class="line"></span>    ...
<span class="line"></span><div class=" highlight"><span class="line"></span>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">bool</span> <span class="hljs-title">scatter</span><span class="hljs-params">(<span class="hljs-type">const</span> ray&amp; r_in, <span class="hljs-type">const</span> hit_record&amp; rec, scatter_record&amp; srec)</span> <span class="hljs-type">const</span> </span>{
<span class="line"></span>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
<span class="line"></span>    }</div><span class="line"></span>
<span class="line"></span>    ...
<span class="line"></span>};</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_material-refactor">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;45:</b> <kbd>[material.h]</kbd> Refactoring the material class</div></center>
<p>


</p></div>

<p></p><p>

</p><div class="together">
The <code>lambertian</code> material becomes simpler:

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">lambertian</span> : <span class="hljs-keyword">public</span> material {
<span class="line"></span>  <span class="hljs-keyword">public</span>:
<span class="line"></span>    <span class="hljs-built_in">lambertian</span>(<span class="hljs-type">const</span> color&amp; albedo) : <span class="hljs-built_in">tex</span>(<span class="hljs-built_in">make_shared</span>&lt;solid_color&gt;(albedo)) {}
<span class="line"></span>    <span class="hljs-built_in">lambertian</span>(shared_ptr&lt;texture&gt; tex) : <span class="hljs-built_in">tex</span>(tex) {}
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">scatter</span><span class="hljs-params">(<span class="hljs-type">const</span> ray&amp; r_in, <span class="hljs-type">const</span> hit_record&amp; rec, scatter_record&amp; srec)</span> <span class="hljs-type">const</span> <span class="hljs-keyword">override</span> </span>{
<span class="line"></span>        srec.attenuation = tex-&gt;<span class="hljs-built_in">value</span>(rec.u, rec.v, rec.p);
<span class="line"></span>        srec.pdf_ptr = <span class="hljs-built_in">make_shared</span>&lt;cosine_pdf&gt;(rec.normal);
<span class="line"></span>        srec.skip_pdf = <span class="hljs-literal">false</span>;
<span class="line"></span>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
<span class="line"></span>    }</div><span class="line"></span>
<span class="line"></span>    <span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">scattering_pdf</span><span class="hljs-params">(<span class="hljs-type">const</span> ray&amp; r_in, <span class="hljs-type">const</span> hit_record&amp; rec, <span class="hljs-type">const</span> ray&amp; scattered)</span> <span class="hljs-type">const</span> </span>{
<span class="line"></span>        <span class="hljs-keyword">auto</span> cosine = <span class="hljs-built_in">dot</span>(rec.normal, <span class="hljs-built_in">unit_vector</span>(scattered.<span class="hljs-built_in">direction</span>()));
<span class="line"></span>        <span class="hljs-keyword">return</span> cosine &lt; <span class="hljs-number">0</span> ? <span class="hljs-number">0</span> : cosine/pi;
<span class="line"></span>    }
<span class="line"></span>
<span class="line"></span>  <span class="hljs-keyword">private</span>:
<span class="line"></span>    shared_ptr&lt;texture&gt; tex;
<span class="line"></span>};</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_lambertian-scatter">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;46:</b> <kbd>[material.h]</kbd> New lambertian scatter() method</div></center>
<p>


</p></div>

<p></p><p>

</p><div class="together">
As does the <code>isotropic</code> material:

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">isotropic</span> : <span class="hljs-keyword">public</span> material {
<span class="line"></span>  <span class="hljs-keyword">public</span>:
<span class="line"></span>    <span class="hljs-built_in">isotropic</span>(<span class="hljs-type">const</span> color&amp; albedo) : <span class="hljs-built_in">tex</span>(<span class="hljs-built_in">make_shared</span>&lt;solid_color&gt;(albedo)) {}
<span class="line"></span>    <span class="hljs-built_in">isotropic</span>(shared_ptr&lt;texture&gt; tex) : <span class="hljs-built_in">tex</span>(tex) {}
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">scatter</span><span class="hljs-params">(<span class="hljs-type">const</span> ray&amp; r_in, <span class="hljs-type">const</span> hit_record&amp; rec, scatter_record&amp; srec)</span> <span class="hljs-type">const</span> <span class="hljs-keyword">override</span> </span>{
<span class="line"></span>        srec.attenuation = tex-&gt;<span class="hljs-built_in">value</span>(rec.u, rec.v, rec.p);
<span class="line"></span>        srec.pdf_ptr = <span class="hljs-built_in">make_shared</span>&lt;sphere_pdf&gt;();
<span class="line"></span>        srec.skip_pdf = <span class="hljs-literal">false</span>;</div><span class="line"></span>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
<span class="line"></span>    }
<span class="line"></span>
<span class="line"></span>    <span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">scattering_pdf</span><span class="hljs-params">(<span class="hljs-type">const</span> ray&amp; r_in, <span class="hljs-type">const</span> hit_record&amp; rec, <span class="hljs-type">const</span> ray&amp; scattered)</span>
<span class="line"></span>    <span class="hljs-type">const</span> <span class="hljs-keyword">override</span> </span>{
<span class="line"></span>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span> / (<span class="hljs-number">4</span> * pi);
<span class="line"></span>    }
<span class="line"></span>
<span class="line"></span>  <span class="hljs-keyword">private</span>:
<span class="line"></span>    shared_ptr&lt;texture&gt; tex;
<span class="line"></span>};</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_isotropic-scatter">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;47:</b> <kbd>[material.h]</kbd> New isotropic scatter() method</div></center>
<p>


</p></div>

<p></p><p>

</p><div class="together">
And <code>ray_color()</code> changes are small:

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">camera</span> {
<span class="line"></span>  ...
<span class="line"></span>  <span class="hljs-keyword">private</span>:
<span class="line"></span>    ...
<span class="line"></span>    <span class="hljs-function">color <span class="hljs-title">ray_color</span><span class="hljs-params">(<span class="hljs-type">const</span> ray&amp; r, <span class="hljs-type">int</span> depth, <span class="hljs-type">const</span> hittable&amp; world, <span class="hljs-type">const</span> hittable&amp; lights)</span>
<span class="line"></span>    <span class="hljs-type">const</span> </span>{
<span class="line"></span>        <span class="hljs-comment">// If we've exceeded the ray bounce limit, no more light is gathered.</span>
<span class="line"></span>        <span class="hljs-keyword">if</span> (depth &lt;= <span class="hljs-number">0</span>)
<span class="line"></span>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">color</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>);
<span class="line"></span>
<span class="line"></span>        hit_record rec;
<span class="line"></span>
<span class="line"></span>        <span class="hljs-comment">// If the ray hits nothing, return the background color.</span>
<span class="line"></span>        <span class="hljs-keyword">if</span> (!world.<span class="hljs-built_in">hit</span>(r, <span class="hljs-built_in">interval</span>(<span class="hljs-number">0.001</span>, infinity), rec))
<span class="line"></span>            <span class="hljs-keyword">return</span> background;
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>        scatter_record srec;</div><span class="line"></span>        color color_from_emission = rec.mat-&gt;<span class="hljs-built_in">emitted</span>(r, rec, rec.u, rec.v, rec.p);
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>        <span class="hljs-keyword">if</span> (!rec.mat-&gt;<span class="hljs-built_in">scatter</span>(r, rec, srec))</div><span class="line"></span>            <span class="hljs-keyword">return</span> color_from_emission;
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>        <span class="hljs-keyword">auto</span> light_ptr = <span class="hljs-built_in">make_shared</span>&lt;hittable_pdf&gt;(lights, rec.p);
<span class="line"></span>        <span class="hljs-function">mixture_pdf <span class="hljs-title">p</span><span class="hljs-params">(light_ptr, srec.pdf_ptr)</span></span>;
<span class="line"></span>
<span class="line"></span>        ray scattered = <span class="hljs-built_in">ray</span>(rec.p, p.<span class="hljs-built_in">generate</span>(), r.<span class="hljs-built_in">time</span>());
<span class="line"></span>        <span class="hljs-keyword">auto</span> pdf_val = p.<span class="hljs-built_in">value</span>(scattered.<span class="hljs-built_in">direction</span>());</div><span class="line"></span>
<span class="line"></span>        <span class="hljs-type">double</span> scattering_pdf = rec.mat-&gt;<span class="hljs-built_in">scattering_pdf</span>(r, rec, scattered);
<span class="line"></span>
<span class="line"></span>        color sample_color = <span class="hljs-built_in">ray_color</span>(scattered, depth<span class="hljs-number">-1</span>, world, lights);<div class=" highlight"><span class="line"></span>        color color_from_scatter = (srec.attenuation * scattering_pdf * sample_color) / pdf_val;</div><span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">return</span> color_from_emission + color_from_scatter;
<span class="line"></span>    }
<span class="line"></span>};</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_ray-color-mixture">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;48:</b> <kbd>[camera.h]</kbd> The ray_color function, using mixture PDF</div></center>
<p>


</p></div>

<p></p>
<a class="target" name="handlingspecular">&nbsp;</a><a class="target" name="cleaninguppdfmanagement/handlingspecular">&nbsp;</a><a class="target" name="toc12.2">&nbsp;</a><h2>Handling Specular</h2>
<p>

We have not yet dealt with specular surfaces, nor instances that mess with the surface normal. But
this design is clean overall, and those are all fixable. For now, I will just fix <code>specular</code>. Metal
and dielectric materials are easy to fix.

</p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">metal</span> : <span class="hljs-keyword">public</span> material {
<span class="line"></span>  <span class="hljs-keyword">public</span>:
<span class="line"></span>    <span class="hljs-built_in">metal</span>(<span class="hljs-type">const</span> color&amp; albedo, <span class="hljs-type">double</span> fuzz) : <span class="hljs-built_in">albedo</span>(albedo), <span class="hljs-built_in">fuzz</span>(fuzz &lt; <span class="hljs-number">1</span> ? fuzz : <span class="hljs-number">1</span>) {}
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">scatter</span><span class="hljs-params">(<span class="hljs-type">const</span> ray&amp; r_in, <span class="hljs-type">const</span> hit_record&amp; rec, scatter_record&amp; srec)</span> <span class="hljs-type">const</span> <span class="hljs-keyword">override</span> </span>{</div><span class="line"></span>        vec3 reflected = <span class="hljs-built_in">reflect</span>(r_in.<span class="hljs-built_in">direction</span>(), rec.normal);
<span class="line"></span>        reflected = <span class="hljs-built_in">unit_vector</span>(reflected) + (fuzz * <span class="hljs-built_in">random_unit_vector</span>());
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>        srec.attenuation = albedo;
<span class="line"></span>        srec.pdf_ptr = <span class="hljs-literal">nullptr</span>;
<span class="line"></span>        srec.skip_pdf = <span class="hljs-literal">true</span>;
<span class="line"></span>        srec.skip_pdf_ray = <span class="hljs-built_in">ray</span>(rec.p, reflected, r_in.<span class="hljs-built_in">time</span>());
<span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;</div><span class="line"></span>    }
<span class="line"></span>
<span class="line"></span>  <span class="hljs-keyword">private</span>:
<span class="line"></span>    color albedo;
<span class="line"></span>    <span class="hljs-type">double</span> fuzz;
<span class="line"></span>};
<span class="line"></span>
<span class="line"></span>...
<span class="line"></span>
<span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">dielectric</span> : <span class="hljs-keyword">public</span> material {
<span class="line"></span>  <span class="hljs-keyword">public</span>:
<span class="line"></span>    <span class="hljs-built_in">dielectric</span>(<span class="hljs-type">double</span> refraction_index) : <span class="hljs-built_in">refraction_index</span>(refraction_index) {}
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">scatter</span><span class="hljs-params">(<span class="hljs-type">const</span> ray&amp; r_in, <span class="hljs-type">const</span> hit_record&amp; rec, scatter_record&amp; srec)</span> <span class="hljs-type">const</span> <span class="hljs-keyword">override</span> </span>{
<span class="line"></span>        srec.attenuation = <span class="hljs-built_in">color</span>(<span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>);
<span class="line"></span>        srec.pdf_ptr = <span class="hljs-literal">nullptr</span>;
<span class="line"></span>        srec.skip_pdf = <span class="hljs-literal">true</span>;</div><span class="line"></span>        <span class="hljs-type">double</span> ri = rec.front_face ? (<span class="hljs-number">1.0</span>/refraction_index) : refraction_index;
<span class="line"></span>
<span class="line"></span>        vec3 unit_direction = <span class="hljs-built_in">unit_vector</span>(r_in.<span class="hljs-built_in">direction</span>());
<span class="line"></span>        <span class="hljs-type">double</span> cos_theta = <span class="hljs-built_in">fmin</span>(<span class="hljs-built_in">dot</span>(-unit_direction, rec.normal), <span class="hljs-number">1.0</span>);
<span class="line"></span>        <span class="hljs-type">double</span> sin_theta = <span class="hljs-built_in">sqrt</span>(<span class="hljs-number">1.0</span> - cos_theta*cos_theta);
<span class="line"></span>
<span class="line"></span>        <span class="hljs-type">bool</span> cannot_refract = ri * sin_theta &gt; <span class="hljs-number">1.0</span>;
<span class="line"></span>        vec3 direction;
<span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">if</span> (cannot_refract || <span class="hljs-built_in">reflectance</span>(cos_theta, ri) &gt; <span class="hljs-built_in">random_double</span>())
<span class="line"></span>            direction = <span class="hljs-built_in">reflect</span>(unit_direction, rec.normal);
<span class="line"></span>        <span class="hljs-keyword">else</span>
<span class="line"></span>            direction = <span class="hljs-built_in">refract</span>(unit_direction, rec.normal, ri);
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>        srec.skip_pdf_ray = <span class="hljs-built_in">ray</span>(rec.p, direction, r_in.<span class="hljs-built_in">time</span>());</div><span class="line"></span>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
<span class="line"></span>    }
<span class="line"></span>
<span class="line"></span>  ...
<span class="line"></span>};</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_material-scatter">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;49:</b> <kbd>[material.h]</kbd> The metal and dielectric scatter methods</div></center>
<p>


Note that if the fuzziness is nonzero, this surface isn’t really ideally specular, but the implicit
sampling works just like it did before. We're effectively skipping all of our PDF work for the
materials that we're treating specularly.

</p><p>

</p><div class="together">
<code>ray_color()</code> just needs a new case to generate an implicitly sampled ray:

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">camera</span> {
<span class="line"></span>  ...
<span class="line"></span>  <span class="hljs-keyword">private</span>:
<span class="line"></span>    ...
<span class="line"></span>    <span class="hljs-function">color <span class="hljs-title">ray_color</span><span class="hljs-params">(<span class="hljs-type">const</span> ray&amp; r, <span class="hljs-type">int</span> depth, <span class="hljs-type">const</span> hittable&amp; world, <span class="hljs-type">const</span> hittable&amp; lights)</span>
<span class="line"></span>    <span class="hljs-type">const</span> </span>{
<span class="line"></span>        ...
<span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">if</span> (!rec.mat-&gt;<span class="hljs-built_in">scatter</span>(r, rec, srec))
<span class="line"></span>            <span class="hljs-keyword">return</span> color_from_emission;
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>        <span class="hljs-keyword">if</span> (srec.skip_pdf) {
<span class="line"></span>            <span class="hljs-keyword">return</span> srec.attenuation * <span class="hljs-built_in">ray_color</span>(srec.skip_pdf_ray, depth<span class="hljs-number">-1</span>, world, lights);
<span class="line"></span>        }</div><span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">auto</span> light_ptr = <span class="hljs-built_in">make_shared</span>&lt;hittable_pdf&gt;(lights, rec.p);
<span class="line"></span>        <span class="hljs-function">mixture_pdf <span class="hljs-title">p</span><span class="hljs-params">(light_ptr, srec.pdf_ptr)</span></span>;
<span class="line"></span>
<span class="line"></span>        ...
<span class="line"></span>    }
<span class="line"></span>};</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_ray-color-implicit">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;50:</b> <kbd>[camera.h]</kbd>
        Ray color function with implicitly-sampled rays
    </div></center>
<p>


</p></div>

<p></p><p>

We'll check our work by changing a block to metal. We'd also like to swap out one of the blocks for
a glass object, but we'll push that off for the next section. Glass objects are difficult to render
well, so we'd like to make a PDF for them, but we have some more work to do before we're able to do
that.

</p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
<span class="line"></span>    ...
<span class="line"></span>    <span class="hljs-comment">// Light</span>
<span class="line"></span>    world.<span class="hljs-built_in">add</span>(<span class="hljs-built_in">make_shared</span>&lt;quad&gt;(<span class="hljs-built_in">point3</span>(<span class="hljs-number">213</span>,<span class="hljs-number">554</span>,<span class="hljs-number">227</span>), <span class="hljs-built_in">vec3</span>(<span class="hljs-number">130</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>), <span class="hljs-built_in">vec3</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">105</span>), light));
<span class="line"></span>
<span class="line"></span>    <span class="hljs-comment">// Box 1</span><div class=" highlight"><span class="line"></span>    shared_ptr&lt;material&gt; aluminum = <span class="hljs-built_in">make_shared</span>&lt;metal&gt;(<span class="hljs-built_in">color</span>(<span class="hljs-number">0.8</span>, <span class="hljs-number">0.85</span>, <span class="hljs-number">0.88</span>), <span class="hljs-number">0.0</span>);
<span class="line"></span>    shared_ptr&lt;hittable&gt; box1 = <span class="hljs-built_in">box</span>(<span class="hljs-built_in">point3</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>), <span class="hljs-built_in">point3</span>(<span class="hljs-number">165</span>,<span class="hljs-number">330</span>,<span class="hljs-number">165</span>), aluminum);</div><span class="line"></span>    box1 = <span class="hljs-built_in">make_shared</span>&lt;rotate_y&gt;(box1, <span class="hljs-number">15</span>);
<span class="line"></span>    box1 = <span class="hljs-built_in">make_shared</span>&lt;translate&gt;(box1, <span class="hljs-built_in">vec3</span>(<span class="hljs-number">265</span>,<span class="hljs-number">0</span>,<span class="hljs-number">295</span>));
<span class="line"></span>    world.<span class="hljs-built_in">add</span>(box1);
<span class="line"></span>
<span class="line"></span>    <span class="hljs-comment">// Box 2</span>
<span class="line"></span>    shared_ptr&lt;hittable&gt; box2 = <span class="hljs-built_in">box</span>(<span class="hljs-built_in">point3</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>), <span class="hljs-built_in">point3</span>(<span class="hljs-number">165</span>,<span class="hljs-number">165</span>,<span class="hljs-number">165</span>), white);
<span class="line"></span>    box2 = <span class="hljs-built_in">make_shared</span>&lt;rotate_y&gt;(box2, <span class="hljs-number">-18</span>);
<span class="line"></span>    box2 = <span class="hljs-built_in">make_shared</span>&lt;translate&gt;(box2, <span class="hljs-built_in">vec3</span>(<span class="hljs-number">130</span>,<span class="hljs-number">0</span>,<span class="hljs-number">65</span>));
<span class="line"></span>    world.<span class="hljs-built_in">add</span>(box2);
<span class="line"></span>
<span class="line"></span>    <span class="hljs-comment">// Light Sources</span>
<span class="line"></span>    hittable_list lights;
<span class="line"></span>    <span class="hljs-keyword">auto</span> m = <span class="hljs-built_in">shared_ptr</span>&lt;material&gt;();
<span class="line"></span>    lights.<span class="hljs-built_in">add</span>(<span class="hljs-built_in">make_shared</span>&lt;quad&gt;(<span class="hljs-built_in">point3</span>(<span class="hljs-number">343</span>,<span class="hljs-number">554</span>,<span class="hljs-number">332</span>), <span class="hljs-built_in">vec3</span>(<span class="hljs-number">-130</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>), <span class="hljs-built_in">vec3</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">-105</span>), m));
<span class="line"></span>
<span class="line"></span>    ...
<span class="line"></span>}</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_scene-cornell-al">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;51:</b> <kbd>[main.cc]</kbd> Cornell box scene with aluminum material</div></center>
<p>


</p><div class="together">
The resulting image has a noisy reflection on the ceiling because the directions toward the box are
not sampled with more density.

<p></p><p>

  </p><center><div class="image" style=""><a href="./input_files/img-3.12-arbitrary-pdf.jpg" target="_blank"><img class="markdeep pixel" src="./input_files/img-3.12-arbitrary-pdf.jpg"></a><center><span class="imagecaption"><span class="num">Image 12:</span> Cornell box with arbitrary PDF functions
  </span></center></div></center>

<p></p><p>

</p></div>

<p></p>
<a class="target" name="samplingasphereobject">&nbsp;</a><a class="target" name="cleaninguppdfmanagement/samplingasphereobject">&nbsp;</a><a class="target" name="toc12.3">&nbsp;</a><h2>Sampling a Sphere Object</h2>
<p>

The noisiness on the ceiling could be reduced by making a PDF of the metal block. We would also want
a PDF for the block if we made it glass. But making a PDF for a block is quite a bit of work and
isn't terribly interesting, so let’s create a PDF for a glass sphere instead. It's quicker and makes
for a more interesting render. We need to figure out how to sample a sphere to determine an
appropriate PDF distribution. If we want to sample a sphere from a point outside of the sphere, we
can't just pick a random point on its surface and be done. If we did that, we would frequently pick
a point on the far side of the sphere, which would be occluded by the front side of the sphere. We
need a way to uniformly sample the side of the sphere that is visible from an arbitrary point. When
we sample a sphere’s solid angle uniformly from a point outside the sphere, we are really just
sampling a cone uniformly. The cone axis goes from the ray origin through the sphere center, with
the sides of the cone tangent to the sphere — see illustration below. Let’s say the code has
<code>theta_max</code>. Recall from the <a href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html#generatingrandomdirections">Generating Random Directions</a> chapter that to sample <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-502-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5587" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5588"><span class="mi" id="MathJax-Span-5589"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-502">\theta</script> we have:

</p><p>

  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Error" id="MathJax-Element-503-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>r</mi><mn>2</mn></msub><mo>=</mo><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>θ</mi></mrow></msubsup><mn>2</mn><mi>π</mi><mi>f</mi><mo stretchy="false">(</mo><msup><mi>θ</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><msup><mi>θ</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mi>d</mi><msup><mi>θ</mi><mo>′</mo></msup></math></span></span><script type="math/tex; mode=display" id="MathJax-Element-503"> r_2 = \int_{0}^{\theta} 2 \pi f(\theta') \sin(\theta') d\theta' </script>

</p><p>

Here <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_Error" id="MathJax-Element-504-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><msup><mi>θ</mi><mo>′</mo></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-504">f(\theta')</script> is an as-of-yet uncalculated constant <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-505-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5618" style="width: 0.726em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.571em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.57em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5619"><span class="mi" id="MathJax-Span-5620"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-505">C</script>, so:

</p><p>

  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Error" id="MathJax-Element-506-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><span aria-hidden="true">[Math Processing Error]</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>r</mi><mn>2</mn></msub><mo>=</mo><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>θ</mi></mrow></msubsup><mn>2</mn><mi>π</mi><mi>C</mi><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><msup><mi>θ</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mi>d</mi><msup><mi>θ</mi><mo>′</mo></msup></math></span></span><script type="math/tex; mode=display" id="MathJax-Element-506"> r_2 = \int_{0}^{\theta} 2 \pi C \sin(\theta') d\theta' </script>

</p><p>

If we solve through the calculus:

</p><p>

  <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-507-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5644" style="width: 10.23em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.422em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1008.42em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5645"><span class="msubsup" id="MathJax-Span-5646"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5647"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-5648" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-5649" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-5650" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-5651"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span class="mo" id="MathJax-Span-5652" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mi" id="MathJax-Span-5653" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span></span><span class="mo" id="MathJax-Span-5654" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mo" id="MathJax-Span-5655" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-5656"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-5657" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mi" id="MathJax-Span-5658" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-5659"></span><span class="mo" id="MathJax-Span-5660"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-5661"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-5662"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-5663"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>r</mi><mn>2</mn></msub><mo>=</mo><mn>2</mn><mi>π</mi><mo>⋅</mo><mi>C</mi><mo>⋅</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-507"> r_2 = 2\pi \cdot C \cdot (1-\cos(\theta)) </script>

</p><p>

So

</p><p>

  <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-508-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5664" style="width: 8.319em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.872em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.467em, 1006.87em, 3.412em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5665"><span class="mi" id="MathJax-Span-5666"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span></span><span class="mi" id="MathJax-Span-5667"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span></span><span class="mi" id="MathJax-Span-5668"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-5669"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-5670"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-5671"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-5672" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-5673" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-5674" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mfrac" id="MathJax-Span-5675" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 2.12em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(3.05em, 1000.62em, 4.496em, -999.997em); top: -4.801em; left: 50%; margin-left: -0.307em;"><span class="msubsup" id="MathJax-Span-5676"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5677"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-5678" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(1.346em, 1002.02em, 2.637em, -999.997em); top: -1.495em; left: 50%; margin-left: -0.979em;"><span class="mrow" id="MathJax-Span-5679"><span class="mn" id="MathJax-Span-5680"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-5681"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span class="mo" id="MathJax-Span-5682" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mi" id="MathJax-Span-5683" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1002.12em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.12em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.253em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>−</mo><mfrac><msub><mi>r</mi><mn>2</mn></msub><mrow><mn>2</mn><mi>π</mi><mo>⋅</mo><mi>C</mi></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-508"> cos(\theta) = 1 - \frac{r_2}{2 \pi \cdot C} </script>

</p><p>

We are constraining our distribution so that the random direction must be less than <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-509-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5684" style="width: 1.81em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.501em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.054em, 1001.5em, 1.501em, -999.997em); top: -0.979em; left: 0em;"><span class="mrow" id="MathJax-Span-5685"><span class="msubsup" id="MathJax-Span-5686"><span style="display: inline-block; position: relative; width: 1.501em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5687"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="texatom" id="MathJax-Span-5688"><span class="mrow" id="MathJax-Span-5689"><span class="mi" id="MathJax-Span-5690" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">m</span></span><span class="mi" id="MathJax-Span-5691" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mi" id="MathJax-Span-5692" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.984em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-509">\theta_{max}</script>.
This means that the integral from 0 to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-510-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5693" style="width: 1.81em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.501em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.054em, 1001.5em, 1.501em, -999.997em); top: -0.979em; left: 0em;"><span class="mrow" id="MathJax-Span-5694"><span class="msubsup" id="MathJax-Span-5695"><span style="display: inline-block; position: relative; width: 1.501em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5696"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="texatom" id="MathJax-Span-5697"><span class="mrow" id="MathJax-Span-5698"><span class="mi" id="MathJax-Span-5699" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">m</span></span><span class="mi" id="MathJax-Span-5700" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mi" id="MathJax-Span-5701" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.984em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-510">\theta_{max}</script> must be one, and therefore <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-511-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5702" style="width: 2.585em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.12em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1002.12em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5703"><span class="msubsup" id="MathJax-Span-5704"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5705"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-5706" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-5707" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-5708" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>r</mi><mn>2</mn></msub><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-511">r_2 = 1</script>. We can
use this to solve for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-512-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5709" style="width: 0.726em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.571em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.57em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5710"><span class="mi" id="MathJax-Span-5711"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-512">C</script>:

</p><p>

  <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-513-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5712" style="width: 10.23em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.422em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1008.42em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5713"><span class="msubsup" id="MathJax-Span-5714"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5715"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-5716" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-5717" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-5718" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-5719"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span class="mo" id="MathJax-Span-5720" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mi" id="MathJax-Span-5721" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span></span><span class="mo" id="MathJax-Span-5722" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mo" id="MathJax-Span-5723" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-5724"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-5725" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mi" id="MathJax-Span-5726" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-5727"></span><span class="mo" id="MathJax-Span-5728"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-5729"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-5730"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-5731"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>r</mi><mn>2</mn></msub><mo>=</mo><mn>2</mn><mi>π</mi><mo>⋅</mo><mi>C</mi><mo>⋅</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-513"> r_2 = 2\pi \cdot C \cdot (1-\cos(\theta)) </script>
  <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-514-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5732" style="width: 11.263em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.3em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1009.3em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5733"><span class="mn" id="MathJax-Span-5734"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-5735" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-5736" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-5737"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span class="mo" id="MathJax-Span-5738" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mi" id="MathJax-Span-5739" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span></span><span class="mo" id="MathJax-Span-5740" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mo" id="MathJax-Span-5741" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-5742"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-5743" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mi" id="MathJax-Span-5744" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-5745"></span><span class="mo" id="MathJax-Span-5746"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-5747"><span style="display: inline-block; position: relative; width: 1.501em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5748"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="texatom" id="MathJax-Span-5749"><span class="mrow" id="MathJax-Span-5750"><span class="mi" id="MathJax-Span-5751" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">m</span></span><span class="mi" id="MathJax-Span-5752" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mi" id="MathJax-Span-5753" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-5754"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-5755"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mn>1</mn><mo>=</mo><mn>2</mn><mi>π</mi><mo>⋅</mo><mi>C</mi><mo>⋅</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-514"> 1 = 2\pi \cdot C \cdot (1-\cos(\theta_{max})) </script>
  <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-515-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5756" style="width: 10.023em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.267em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.622em, 1008.27em, 3.567em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5757"><span class="mi" id="MathJax-Span-5758"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span></span><span class="mo" id="MathJax-Span-5759" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mfrac" id="MathJax-Span-5760" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 6.408em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.89em; left: 50%; margin-left: -0.204em;"><span class="mn" id="MathJax-Span-5761"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.346em, 1006.3em, 2.792em, -999.997em); top: -1.495em; left: 50%; margin-left: -3.148em;"><span class="mrow" id="MathJax-Span-5762"><span class="mn" id="MathJax-Span-5763"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-5764"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span class="mo" id="MathJax-Span-5765" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mo" id="MathJax-Span-5766" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-5767"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-5768" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mi" id="MathJax-Span-5769" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-5770"></span><span class="mo" id="MathJax-Span-5771"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-5772"><span style="display: inline-block; position: relative; width: 1.501em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5773"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="texatom" id="MathJax-Span-5774"><span class="mrow" id="MathJax-Span-5775"><span class="mi" id="MathJax-Span-5776" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">m</span></span><span class="mi" id="MathJax-Span-5777" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mi" id="MathJax-Span-5778" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-5779"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1006.41em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 6.408em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.434em; border-left: 0px solid; width: 0px; height: 3.253em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>C</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mi>π</mi><mo>⋅</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo stretchy="false">)</mo></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-515"> C = \frac{1}{2\pi \cdot (1-\cos(\theta_{max})} </script>

</p><p>

Which gives us an equality between <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-516-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5780" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5781"><span class="mi" id="MathJax-Span-5782"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-516">\theta</script>, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-517-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5783" style="width: 1.81em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.501em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.054em, 1001.5em, 1.501em, -999.997em); top: -0.979em; left: 0em;"><span class="mrow" id="MathJax-Span-5784"><span class="msubsup" id="MathJax-Span-5785"><span style="display: inline-block; position: relative; width: 1.501em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5786"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="texatom" id="MathJax-Span-5787"><span class="mrow" id="MathJax-Span-5788"><span class="mi" id="MathJax-Span-5789" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">m</span></span><span class="mi" id="MathJax-Span-5790" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mi" id="MathJax-Span-5791" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.984em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-517">\theta_{max}</script>, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-518-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5792" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.054em, 1000.62em, 1.501em, -999.997em); top: -0.979em; left: 0em;"><span class="mrow" id="MathJax-Span-5793"><span class="msubsup" id="MathJax-Span-5794"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5795"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-5796" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.984em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>r</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-518">r_2</script>:

</p><p>

  <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-519-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5797" style="width: 13.277em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.953em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1010.95em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5798"><span class="mi" id="MathJax-Span-5799"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-5800"></span><span class="mo" id="MathJax-Span-5801"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-5802"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-5803"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-5804" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-5805" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-5806" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">+</span></span><span class="msubsup" id="MathJax-Span-5807" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5808"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-5809" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-5810" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mo" id="MathJax-Span-5811" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-5812"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-5813"></span><span class="mo" id="MathJax-Span-5814"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-5815"><span style="display: inline-block; position: relative; width: 1.501em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5816"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="texatom" id="MathJax-Span-5817"><span class="mrow" id="MathJax-Span-5818"><span class="mi" id="MathJax-Span-5819" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">m</span></span><span class="mi" id="MathJax-Span-5820" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mi" id="MathJax-Span-5821" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-5822"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-5823" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mn" id="MathJax-Span-5824" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-5825"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>+</mo><msub><mi>r</mi><mn>2</mn></msub><mo>⋅</mo><mo stretchy="false">(</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo stretchy="false">)</mo><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-519"> \cos(\theta) = 1 + r_2 \cdot (\cos(\theta_{max})-1) </script>

</p><p>

We sample <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-520-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5826" style="width: 0.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.52em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-5827"><span class="mi" id="MathJax-Span-5828"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ϕ</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϕ</mi></math></span></span><script type="math/tex" id="MathJax-Element-520">\phi</script> like before, so:

</p><p>

  <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-521-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5829" style="width: 15.034em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.399em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1012.4em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5830"><span class="mi" id="MathJax-Span-5831"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">z</span></span><span class="mo" id="MathJax-Span-5832" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-5833" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-5834"></span><span class="mo" id="MathJax-Span-5835"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-5836"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-5837"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-5838" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-5839" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-5840" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">+</span></span><span class="msubsup" id="MathJax-Span-5841" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5842"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-5843" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-5844" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mo" id="MathJax-Span-5845" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-5846"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-5847"></span><span class="mo" id="MathJax-Span-5848"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-5849"><span style="display: inline-block; position: relative; width: 1.501em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5850"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="texatom" id="MathJax-Span-5851"><span class="mrow" id="MathJax-Span-5852"><span class="mi" id="MathJax-Span-5853" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">m</span></span><span class="mi" id="MathJax-Span-5854" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mi" id="MathJax-Span-5855" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-5856"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-5857" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mn" id="MathJax-Span-5858" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-5859"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>z</mi><mo>=</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>+</mo><msub><mi>r</mi><mn>2</mn></msub><mo>⋅</mo><mo stretchy="false">(</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo stretchy="false">)</mo><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-521"> z = \cos(\theta) = 1 + r_2 \cdot (\cos(\theta_{max}) - 1) </script>
  <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-522-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msqrt&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/msqrt&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5860" style="width: 17.771em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.672em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.932em, 1014.67em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5861"><span class="mi" id="MathJax-Span-5862"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span><span class="mo" id="MathJax-Span-5863" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-5864" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-5865"></span><span class="mo" id="MathJax-Span-5866"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-5867"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ϕ</span></span><span class="mo" id="MathJax-Span-5868"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-5869" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mi" id="MathJax-Span-5870" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mo" id="MathJax-Span-5871"></span><span class="mo" id="MathJax-Span-5872"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-5873"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-5874"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-5875" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-5876" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-5877"></span><span class="mo" id="MathJax-Span-5878"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-5879"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-5880"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span class="mo" id="MathJax-Span-5881" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="msubsup" id="MathJax-Span-5882" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5883"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-5884" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-5885"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-5886" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="msqrt" id="MathJax-Span-5887" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 2.895em; height: 0px;"><span style="position: absolute; clip: rect(1.139em, 1002.12em, 2.637em, -999.997em); top: -2.27em; left: 0.777em;"><span class="mrow" id="MathJax-Span-5888"><span class="mn" id="MathJax-Span-5889"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-5890" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="msubsup" id="MathJax-Span-5891" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5892"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">z</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.27em; left: 0.364em;"><span class="mn" id="MathJax-Span-5893" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(0.984em, 1002.12em, 1.294em, -999.997em); top: -2.322em; left: 0.777em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 2.12em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span><span style="position: absolute; clip: rect(3.05em, 1000.78em, 4.341em, -999.997em); top: -4.388em; left: 0em;"><span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">√</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 2.003em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>x</mi><mo>=</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>ϕ</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><mo>⋅</mo><msub><mi>r</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>⋅</mo><msqrt><mn>1</mn><mo>−</mo><msup><mi>z</mi><mn>2</mn></msup></msqrt></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-522"> x = \cos(\phi) \cdot \sin(\theta) = \cos(2\pi \cdot r_1) \cdot \sqrt{1-z^2} </script>
  <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-523-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msqrt&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/msqrt&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5894" style="width: 17.461em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.414em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.932em, 1014.41em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5895"><span class="mi" id="MathJax-Span-5896"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">y</span></span><span class="mo" id="MathJax-Span-5897" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-5898" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mo" id="MathJax-Span-5899"></span><span class="mo" id="MathJax-Span-5900"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-5901"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">ϕ</span></span><span class="mo" id="MathJax-Span-5902"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-5903" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mi" id="MathJax-Span-5904" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mo" id="MathJax-Span-5905"></span><span class="mo" id="MathJax-Span-5906"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-5907"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-5908"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-5909" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-5910" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mo" id="MathJax-Span-5911"></span><span class="mo" id="MathJax-Span-5912"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-5913"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-5914"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span class="mo" id="MathJax-Span-5915" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="msubsup" id="MathJax-Span-5916" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.26em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5917"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.261em;"><span class="mn" id="MathJax-Span-5918" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-5919"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-5920" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="msqrt" id="MathJax-Span-5921" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 2.895em; height: 0px;"><span style="position: absolute; clip: rect(1.139em, 1002.12em, 2.637em, -999.997em); top: -2.27em; left: 0.777em;"><span class="mrow" id="MathJax-Span-5922"><span class="mn" id="MathJax-Span-5923"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-5924" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="msubsup" id="MathJax-Span-5925" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5926"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">z</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.27em; left: 0.364em;"><span class="mn" id="MathJax-Span-5927" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(0.984em, 1002.12em, 1.294em, -999.997em); top: -2.322em; left: 0.777em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 2.12em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span><span style="position: absolute; clip: rect(3.05em, 1000.78em, 4.341em, -999.997em); top: -4.388em; left: 0em;"><span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">√</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 2.003em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>y</mi><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>ϕ</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><mo>⋅</mo><msub><mi>r</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>⋅</mo><msqrt><mn>1</mn><mo>−</mo><msup><mi>z</mi><mn>2</mn></msup></msqrt></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-523"> y = \sin(\phi) \cdot \sin(\theta) = \sin(2\pi \cdot r_1) \cdot \sqrt{1-z^2} </script>

</p><p>

Now what is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-524-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5928" style="width: 1.81em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.501em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.054em, 1001.5em, 1.501em, -999.997em); top: -0.979em; left: 0em;"><span class="mrow" id="MathJax-Span-5929"><span class="msubsup" id="MathJax-Span-5930"><span style="display: inline-block; position: relative; width: 1.501em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5931"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="texatom" id="MathJax-Span-5932"><span class="mrow" id="MathJax-Span-5933"><span class="mi" id="MathJax-Span-5934" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">m</span></span><span class="mi" id="MathJax-Span-5935" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mi" id="MathJax-Span-5936" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.984em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-524">\theta_{max}</script>?

</p><p>

  </p><center><div class="image" style=""><a href="./input_files/fig-3.12-sphere-enclosing-cone.jpg" target="_blank"><img class="markdeep" src="./input_files/fig-3.12-sphere-enclosing-cone.jpg"></a><center><span class="imagecaption"><a class="target" name="figure_sphere-enclosing-cone">&nbsp;</a><b style="font-style:normal;">Figure&nbsp;12:</b> A sphere-enclosing cone
  </span></center></div></center>

<p></p><p>

We can see from the figure that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-525-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5937" style="width: 11.263em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.3em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1009.3em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5938"><span class="mi" id="MathJax-Span-5939"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mo" id="MathJax-Span-5940"></span><span class="mo" id="MathJax-Span-5941"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-5942"><span style="display: inline-block; position: relative; width: 1.501em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5943"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="texatom" id="MathJax-Span-5944"><span class="mrow" id="MathJax-Span-5945"><span class="mi" id="MathJax-Span-5946" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">m</span></span><span class="mi" id="MathJax-Span-5947" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mi" id="MathJax-Span-5948" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-5949"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-5950" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-5951" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">R</span></span><span class="texatom" id="MathJax-Span-5952"><span class="mrow" id="MathJax-Span-5953"><span class="mo" id="MathJax-Span-5954"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="mi" id="MathJax-Span-5955"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span></span><span class="mi" id="MathJax-Span-5956"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span><span class="mi" id="MathJax-Span-5957"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mi" id="MathJax-Span-5958"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">g</span></span><span class="mi" id="MathJax-Span-5959"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span></span><span class="mi" id="MathJax-Span-5960"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">h</span></span><span class="mo" id="MathJax-Span-5961"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="texatom" id="MathJax-Span-5962"><span class="mrow" id="MathJax-Span-5963"><span class="mi" id="MathJax-Span-5964"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span></span></span></span><span class="mo" id="MathJax-Span-5965" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="texatom" id="MathJax-Span-5966" style="padding-left: 0.209em;"><span class="mrow" id="MathJax-Span-5967"><span class="mi" id="MathJax-Span-5968"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span></span></span><span class="mo" id="MathJax-Span-5969"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mi>R</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>l</mi><mi>e</mi><mi>n</mi><mi>g</mi><mi>t</mi><mi>h</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">c</mi></mrow><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">p</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-525">\sin(\theta_{max}) = R / length(\mathbf{c} - \mathbf{p})</script>. So:

</p><p>

  <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-526-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msqrt&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;msup&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mrow&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/msqrt&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5970" style="width: 13.897em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.47em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.364em, 1011.47em, 3.463em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5971"><span class="mi" id="MathJax-Span-5972"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-5973"></span><span class="mo" id="MathJax-Span-5974"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-5975"><span style="display: inline-block; position: relative; width: 1.501em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5976"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="texatom" id="MathJax-Span-5977"><span class="mrow" id="MathJax-Span-5978"><span class="mi" id="MathJax-Span-5979" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">m</span></span><span class="mi" id="MathJax-Span-5980" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mi" id="MathJax-Span-5981" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-5982"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-5983" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="msqrt" id="MathJax-Span-5984" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 7.234em; height: 0px;"><span style="position: absolute; clip: rect(0.571em, 1006.46em, 3.463em, -999.997em); top: -2.27em; left: 0.777em;"><span class="mrow" id="MathJax-Span-5985"><span class="mn" id="MathJax-Span-5986"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-5987" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mfrac" id="MathJax-Span-5988" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 4.858em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(2.947em, 1000.93em, 4.341em, -999.997em); top: -4.646em; left: 50%; margin-left: -0.462em;"><span class="msubsup" id="MathJax-Span-5989"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.57em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5990"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">R</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.167em; left: 0.571em;"><span class="mn" id="MathJax-Span-5991" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(1.242em, 1004.75em, 2.637em, -999.997em); top: -1.444em; left: 50%; margin-left: -2.373em;"><span class="mrow" id="MathJax-Span-5992"><span class="mi" id="MathJax-Span-5993"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span></span><span class="mi" id="MathJax-Span-5994"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span><span class="mi" id="MathJax-Span-5995"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mi" id="MathJax-Span-5996"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">g</span></span><span class="mi" id="MathJax-Span-5997"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">t</span></span><span class="msubsup" id="MathJax-Span-5998"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-5999"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">h</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -2.167em; left: 0.416em;"><span class="mn" id="MathJax-Span-6000" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-6001"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="texatom" id="MathJax-Span-6002"><span class="mrow" id="MathJax-Span-6003"><span class="mi" id="MathJax-Span-6004"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span></span></span></span><span class="mo" id="MathJax-Span-6005" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="texatom" id="MathJax-Span-6006" style="padding-left: 0.209em;"><span class="mrow" id="MathJax-Span-6007"><span class="mi" id="MathJax-Span-6008"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span></span></span><span class="mo" id="MathJax-Span-6009"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1004.86em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.858em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span><span style="position: absolute; clip: rect(0.984em, 1006.46em, 1.294em, -999.997em); top: -2.89em; left: 0.777em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 6.459em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span><span style="position: absolute; clip: rect(3.05em, 1000.78em, 4.341em, -999.997em); top: -4.956em; left: 0em;"><span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">√</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.309em; border-left: 0px solid; width: 0px; height: 3.503em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><msqrt><mn>1</mn><mo>−</mo><mfrac><msup><mi>R</mi><mn>2</mn></msup><mrow><mi>l</mi><mi>e</mi><mi>n</mi><mi>g</mi><mi>t</mi><msup><mi>h</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">c</mi></mrow><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">p</mi></mrow><mo stretchy="false">)</mo></mrow></mfrac></msqrt></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-526"> \cos(\theta_{max}) = \sqrt{1 - \frac{R^2}{length^2(\mathbf{c} - \mathbf{p})}} </script>

</p><p>

We also need to evaluate the PDF of directions. For a uniform distribution toward the sphere the PDF
is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-527-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;solid_angle&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6010" style="width: 5.478em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.496em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1004.5em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-6011"><span class="mn" id="MathJax-Span-6012"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="texatom" id="MathJax-Span-6013"><span class="mrow" id="MathJax-Span-6014"><span class="mo" id="MathJax-Span-6015"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">/</span></span></span></span><span class="mtext" id="MathJax-Span-6016"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">_</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">g</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mtext>solid_angle</mtext></math></span></span><script type="math/tex" id="MathJax-Element-527">1/\text{solid_angle}</script>. What is the solid angle of the sphere? It has something to do with
the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-528-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6017" style="width: 0.726em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.571em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.57em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-6018"><span class="mi" id="MathJax-Span-6019"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">C</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-528">C</script> above. It is — by definition — the area on the unit sphere, so the integral is

</p><p>

  <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-529-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtext&gt;solid_angle&lt;/mtext&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6020" style="width: 21.025em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.358em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.932em, 1017.36em, 2.998em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-6021"><span class="mtext" id="MathJax-Span-6022"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">d</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">_</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">g</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">e</span></span><span class="mo" id="MathJax-Span-6023" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="msubsup" id="MathJax-Span-6024" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.637em, -999.997em); top: -2.218em; left: 0em;"><span class="mo" id="MathJax-Span-6025" style="vertical-align: -0.049em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∫</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.62em, 2.172em, -999.997em); top: -2.322em; left: 0.364em;"><span class="texatom" id="MathJax-Span-6026"><span class="mrow" id="MathJax-Span-6027"><span class="mn" id="MathJax-Span-6028" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-6029" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -1.444em; left: 0.364em;"><span class="texatom" id="MathJax-Span-6030"><span class="mrow" id="MathJax-Span-6031"><span class="mn" id="MathJax-Span-6032" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-6033" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.501em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.36em, 2.637em, -999.997em); top: -2.218em; left: 0em;"><span class="mo" id="MathJax-Span-6034" style="vertical-align: -0.049em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">∫</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.14em, 4.393em, -999.997em); top: -4.595em; left: 0.364em;"><span class="texatom" id="MathJax-Span-6035"><span class="mrow" id="MathJax-Span-6036"><span class="msubsup" id="MathJax-Span-6037"><span style="display: inline-block; position: relative; width: 1.087em; height: 0px;"><span style="position: absolute; clip: rect(1.139em, 1000.31em, 2.172em, -999.997em); top: -1.857em; left: 0em;"><span class="mi" id="MathJax-Span-6038" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span><span style="position: absolute; top: -1.444em; left: 0.313em;"><span class="texatom" id="MathJax-Span-6039"><span class="mrow" id="MathJax-Span-6040"><span class="mi" id="MathJax-Span-6041" style="font-size: 50%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">m</span></span><span class="mi" id="MathJax-Span-6042" style="font-size: 50%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mi" id="MathJax-Span-6043" style="font-size: 50%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.604em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(1.139em, 1000.36em, 2.172em, -999.997em); top: -1.444em; left: 0.364em;"><span class="texatom" id="MathJax-Span-6044"><span class="mrow" id="MathJax-Span-6045"><span class="mn" id="MathJax-Span-6046" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mi" id="MathJax-Span-6047" style="padding-left: 0.158em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mo" id="MathJax-Span-6048"></span><span class="mo" id="MathJax-Span-6049"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-6050"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span class="mo" id="MathJax-Span-6051"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-6052" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-6053" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-6054"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span><span class="mo" id="MathJax-Span-6055" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">⋅</span></span><span class="mo" id="MathJax-Span-6056" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-6057"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-6058" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="mi" id="MathJax-Span-6059" style="padding-left: 0.209em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-6060"></span><span class="mo" id="MathJax-Span-6061"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-6062"><span style="display: inline-block; position: relative; width: 1.501em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-6063"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="texatom" id="MathJax-Span-6064"><span class="mrow" id="MathJax-Span-6065"><span class="mi" id="MathJax-Span-6066" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">m</span></span><span class="mi" id="MathJax-Span-6067" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mi" id="MathJax-Span-6068" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-6069"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-6070"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.747em; border-left: 0px solid; width: 0px; height: 2.191em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>solid_angle</mtext><mo>=</mo><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mn>2</mn><mi>π</mi></mrow></msubsup><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></mrow></msubsup><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mn>2</mn><mi>π</mi><mo>⋅</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-529"> \text{solid_angle} = \int_{0}^{2\pi} \int_{0}^{\theta_{max}} \sin(\theta)
       = 2 \pi \cdot (1-\cos(\theta_{max})) </script>

</p><p>

It’s good to check the math on all such calculations. I usually plug in the extreme cases (thank you
for that concept, Mr. Horton — my high school physics teacher). For a zero radius sphere
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-530-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6071" style="width: 5.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.651em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1004.65em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-6072"><span class="mi" id="MathJax-Span-6073"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-6074"></span><span class="mo" id="MathJax-Span-6075"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-6076"><span style="display: inline-block; position: relative; width: 1.501em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-6077"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="texatom" id="MathJax-Span-6078"><span class="mrow" id="MathJax-Span-6079"><span class="mi" id="MathJax-Span-6080" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">m</span></span><span class="mi" id="MathJax-Span-6081" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mi" id="MathJax-Span-6082" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-6083"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-6084" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-6085" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-530">\cos(\theta_{max}) = 1</script>, and that works. For a sphere tangent at <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-531-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6086" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-6087"><span class="texatom" id="MathJax-Span-6088"><span class="mrow" id="MathJax-Span-6089"><span class="mi" id="MathJax-Span-6090"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">p</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">p</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-531">\mathbf{p}</script>,
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-532-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6091" style="width: 5.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.651em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1004.65em, 2.792em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-6092"><span class="mi" id="MathJax-Span-6093"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">c</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">s</span></span><span class="mo" id="MathJax-Span-6094"></span><span class="mo" id="MathJax-Span-6095"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="msubsup" id="MathJax-Span-6096"><span style="display: inline-block; position: relative; width: 1.501em; height: 0px;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mi" id="MathJax-Span-6097"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span><span style="position: absolute; top: -1.65em; left: 0.416em;"><span class="texatom" id="MathJax-Span-6098"><span class="mrow" id="MathJax-Span-6099"><span class="mi" id="MathJax-Span-6100" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">m</span></span><span class="mi" id="MathJax-Span-6101" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">a</span></span><span class="mi" id="MathJax-Span-6102" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.862em;"></span></span></span></span><span class="mo" id="MathJax-Span-6103"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span><span class="mo" id="MathJax-Span-6104" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-6105" style="padding-left: 0.261em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-532">\cos(\theta_{max}) = 0</script>, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-533-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6106" style="width: 1.036em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.83em, 2.585em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-6107"><span class="mn" id="MathJax-Span-6108"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span class="mi" id="MathJax-Span-6109"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">π</span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-533">2\pi</script> is the area of a hemisphere, so that works too.

</p>
<a class="target" name="updatingthespherecode">&nbsp;</a><a class="target" name="cleaninguppdfmanagement/updatingthespherecode">&nbsp;</a><a class="target" name="toc12.4">&nbsp;</a><h2>Updating the Sphere Code</h2>
<p>

The sphere class needs the two PDF-related functions:

</p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">sphere</span> : <span class="hljs-keyword">public</span> hittable {
<span class="line"></span>  <span class="hljs-keyword">public</span>:
<span class="line"></span>    ...
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>    <span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">pdf_value</span><span class="hljs-params">(<span class="hljs-type">const</span> point3&amp; origin, <span class="hljs-type">const</span> vec3&amp; direction)</span> <span class="hljs-type">const</span> <span class="hljs-keyword">override</span> </span>{
<span class="line"></span>        <span class="hljs-comment">// This method only works for stationary spheres.</span>
<span class="line"></span>
<span class="line"></span>        hit_record rec;
<span class="line"></span>        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>-&gt;<span class="hljs-built_in">hit</span>(<span class="hljs-built_in">ray</span>(origin, direction), <span class="hljs-built_in">interval</span>(<span class="hljs-number">0.001</span>, infinity), rec))
<span class="line"></span>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
<span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">auto</span> cos_theta_max = <span class="hljs-built_in">sqrt</span>(<span class="hljs-number">1</span> - radius*radius/(center1 - origin).<span class="hljs-built_in">length_squared</span>());
<span class="line"></span>        <span class="hljs-keyword">auto</span> solid_angle = <span class="hljs-number">2</span>*pi*(<span class="hljs-number">1</span>-cos_theta_max);
<span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">return</span>  <span class="hljs-number">1</span> / solid_angle;
<span class="line"></span>    }
<span class="line"></span>
<span class="line"></span>    <span class="hljs-function">vec3 <span class="hljs-title">random</span><span class="hljs-params">(<span class="hljs-type">const</span> point3&amp; origin)</span> <span class="hljs-type">const</span> <span class="hljs-keyword">override</span> </span>{
<span class="line"></span>        vec3 direction = center1 - origin;
<span class="line"></span>        <span class="hljs-keyword">auto</span> distance_squared = direction.<span class="hljs-built_in">length_squared</span>();
<span class="line"></span>        onb uvw;
<span class="line"></span>        uvw.<span class="hljs-built_in">build_from_w</span>(direction);
<span class="line"></span>        <span class="hljs-keyword">return</span> uvw.<span class="hljs-built_in">local</span>(<span class="hljs-built_in">random_to_sphere</span>(radius, distance_squared));
<span class="line"></span>    }</div><span class="line"></span>
<span class="line"></span>  <span class="hljs-keyword">private</span>:
<span class="line"></span>    ...
<span class="line"></span><div class=" highlight"><span class="line"></span>    <span class="hljs-function"><span class="hljs-type">static</span> vec3 <span class="hljs-title">random_to_sphere</span><span class="hljs-params">(<span class="hljs-type">double</span> radius, <span class="hljs-type">double</span> distance_squared)</span> </span>{
<span class="line"></span>        <span class="hljs-keyword">auto</span> r1 = <span class="hljs-built_in">random_double</span>();
<span class="line"></span>        <span class="hljs-keyword">auto</span> r2 = <span class="hljs-built_in">random_double</span>();
<span class="line"></span>        <span class="hljs-keyword">auto</span> z = <span class="hljs-number">1</span> + r2*(<span class="hljs-built_in">sqrt</span>(<span class="hljs-number">1</span>-radius*radius/distance_squared) - <span class="hljs-number">1</span>);
<span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">auto</span> phi = <span class="hljs-number">2</span>*pi*r1;
<span class="line"></span>        <span class="hljs-keyword">auto</span> x = <span class="hljs-built_in">cos</span>(phi)*<span class="hljs-built_in">sqrt</span>(<span class="hljs-number">1</span>-z*z);
<span class="line"></span>        <span class="hljs-keyword">auto</span> y = <span class="hljs-built_in">sin</span>(phi)*<span class="hljs-built_in">sqrt</span>(<span class="hljs-number">1</span>-z*z);
<span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">vec3</span>(x, y, z);
<span class="line"></span>    }</div><span class="line"></span>};</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_sphere-pdf">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;52:</b> <kbd>[sphere.h]</kbd> Sphere with PDF</div></center>
<p>


</p><div class="together">
We can first try just sampling the sphere rather than the light:

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
<span class="line"></span>    ...
<span class="line"></span>
<span class="line"></span>    <span class="hljs-comment">// Light</span>
<span class="line"></span>    world.<span class="hljs-built_in">add</span>(<span class="hljs-built_in">make_shared</span>&lt;quad&gt;(<span class="hljs-built_in">point3</span>(<span class="hljs-number">213</span>,<span class="hljs-number">554</span>,<span class="hljs-number">227</span>), <span class="hljs-built_in">vec3</span>(<span class="hljs-number">130</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>), <span class="hljs-built_in">vec3</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">105</span>), light));
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>    <span class="hljs-comment">// Box</span>
<span class="line"></span>    shared_ptr&lt;hittable&gt; box1 = <span class="hljs-built_in">box</span>(<span class="hljs-built_in">point3</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>), <span class="hljs-built_in">point3</span>(<span class="hljs-number">165</span>,<span class="hljs-number">330</span>,<span class="hljs-number">165</span>), white);
<span class="line"></span>    box1 = <span class="hljs-built_in">make_shared</span>&lt;rotate_y&gt;(box1, <span class="hljs-number">15</span>);
<span class="line"></span>    box1 = <span class="hljs-built_in">make_shared</span>&lt;translate&gt;(box1, <span class="hljs-built_in">vec3</span>(<span class="hljs-number">265</span>,<span class="hljs-number">0</span>,<span class="hljs-number">295</span>));
<span class="line"></span>    world.<span class="hljs-built_in">add</span>(box1);
<span class="line"></span>
<span class="line"></span>    <span class="hljs-comment">// Glass Sphere</span>
<span class="line"></span>    <span class="hljs-keyword">auto</span> glass = <span class="hljs-built_in">make_shared</span>&lt;dielectric&gt;(<span class="hljs-number">1.5</span>);
<span class="line"></span>    world.<span class="hljs-built_in">add</span>(<span class="hljs-built_in">make_shared</span>&lt;sphere&gt;(<span class="hljs-built_in">point3</span>(<span class="hljs-number">190</span>,<span class="hljs-number">90</span>,<span class="hljs-number">190</span>), <span class="hljs-number">90</span>, glass));</div><span class="line"></span>
<span class="line"></span>    <span class="hljs-comment">// Light Sources</span>
<span class="line"></span>    hittable_list lights;
<span class="line"></span>    <span class="hljs-keyword">auto</span> m = <span class="hljs-built_in">shared_ptr</span>&lt;material&gt;();
<span class="line"></span>    lights.<span class="hljs-built_in">add</span>(<span class="hljs-built_in">make_shared</span>&lt;quad&gt;(<span class="hljs-built_in">point3</span>(<span class="hljs-number">343</span>,<span class="hljs-number">554</span>,<span class="hljs-number">332</span>), <span class="hljs-built_in">vec3</span>(<span class="hljs-number">-130</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>), <span class="hljs-built_in">vec3</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">-105</span>), m));
<span class="line"></span>
<span class="line"></span>    ...
<span class="line"></span>}</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_sampling-sphere">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;53:</b> <kbd>[main.cc]</kbd> Sampling just the sphere</div></center>
<p>


</p></div>

<p></p><p>

</p><div class="together">
This yields a noisy room, but the caustic under the sphere is good. It took five times as long as
sampling the light did for my code. This is probably because those rays that hit the glass are
expensive!

<p></p><p>

  </p><center><div class="image" style=""><a href="./input_files/img-3.13-cornell-glass-sphere.jpg" target="_blank"><img class="markdeep pixel" src="./input_files/img-3.13-cornell-glass-sphere.jpg"></a><center><span class="imagecaption"><span class="num">Image 13:</span> Cornell box with glass sphere, using new PDF functions
  </span></center></div></center>

<p></p><p>

</p></div>

<p></p>
<a class="target" name="addingpdffunctionstohittablelists">&nbsp;</a><a class="target" name="cleaninguppdfmanagement/addingpdffunctionstohittablelists">&nbsp;</a><a class="target" name="toc12.5">&nbsp;</a><h2>Adding PDF Functions to Hittable Lists</h2>
<p>

We should probably just sample both the sphere and the light. We can do that by creating a mixture
density of their two distributions. We could do that in the <code>ray_color()</code> function by passing a list
of hittables in and building a mixture PDF, or we could add PDF functions to <code>hittable_list</code>. I
think both tactics would work fine, but I will go with instrumenting <code>hittable_list</code>.

</p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">hittable_list</span> : <span class="hljs-keyword">public</span> hittable {
<span class="line"></span>  <span class="hljs-keyword">public</span>:
<span class="line"></span>    ...
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>    <span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">pdf_value</span><span class="hljs-params">(<span class="hljs-type">const</span> point3&amp; origin, <span class="hljs-type">const</span> vec3&amp; direction)</span> <span class="hljs-type">const</span> <span class="hljs-keyword">override</span> </span>{
<span class="line"></span>        <span class="hljs-keyword">auto</span> weight = <span class="hljs-number">1.0</span> / objects.<span class="hljs-built_in">size</span>();
<span class="line"></span>        <span class="hljs-keyword">auto</span> sum = <span class="hljs-number">0.0</span>;
<span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">for</span> (<span class="hljs-type">const</span> <span class="hljs-keyword">auto</span>&amp; object : objects)
<span class="line"></span>            sum += weight * object-&gt;<span class="hljs-built_in">pdf_value</span>(origin, direction);
<span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">return</span> sum;
<span class="line"></span>    }
<span class="line"></span>
<span class="line"></span>    <span class="hljs-function">vec3 <span class="hljs-title">random</span><span class="hljs-params">(<span class="hljs-type">const</span> point3&amp; origin)</span> <span class="hljs-type">const</span> <span class="hljs-keyword">override</span> </span>{
<span class="line"></span>        <span class="hljs-keyword">auto</span> int_size = <span class="hljs-built_in">int</span>(objects.<span class="hljs-built_in">size</span>());
<span class="line"></span>        <span class="hljs-keyword">return</span> objects[<span class="hljs-built_in">random_int</span>(<span class="hljs-number">0</span>, int_size<span class="hljs-number">-1</span>)]-&gt;<span class="hljs-built_in">random</span>(origin);
<span class="line"></span>    }</div><span class="line"></span>
<span class="line"></span>    ...
<span class="line"></span>};</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_density-mixture">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;54:</b> <kbd>[hittable_list.h]</kbd> Creating a mixture of densities</div></center>
<p>


</p><div class="together">
We assemble a list to pass to <code>render()</code> from <code>main()</code>:

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
<span class="line"></span>    ...
<span class="line"></span>
<span class="line"></span>    <span class="hljs-comment">// Light Sources</span>
<span class="line"></span>    hittable_list lights;
<span class="line"></span>    <span class="hljs-keyword">auto</span> m = <span class="hljs-built_in">shared_ptr</span>&lt;material&gt;();
<span class="line"></span>    lights.<span class="hljs-built_in">add</span>(<span class="hljs-built_in">make_shared</span>&lt;quad&gt;(<span class="hljs-built_in">point3</span>(<span class="hljs-number">343</span>,<span class="hljs-number">554</span>,<span class="hljs-number">332</span>), <span class="hljs-built_in">vec3</span>(<span class="hljs-number">-130</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>), <span class="hljs-built_in">vec3</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">-105</span>), m));<div class=" highlight"><span class="line"></span>    lights.<span class="hljs-built_in">add</span>(<span class="hljs-built_in">make_shared</span>&lt;sphere&gt;(<span class="hljs-built_in">point3</span>(<span class="hljs-number">190</span>, <span class="hljs-number">90</span>, <span class="hljs-number">190</span>), <span class="hljs-number">90</span>, m));</div><span class="line"></span>
<span class="line"></span>    ...
<span class="line"></span>}</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_scene-density-mixture">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;55:</b> <kbd>[main.cc]</kbd> Updating the scene</div></center>
<p>


</p></div>

<p></p><p>

</p><div class="together">
And we get a decent image with 1000 samples as before:

<p></p><p>

  </p><center><div class="image" style=""><a href="./input_files/img-3.14-glass-and-light.jpg" target="_blank"><img class="markdeep pixel" src="./input_files/img-3.14-glass-and-light.jpg"></a><center><span class="imagecaption"><span class="num">Image 14:</span> Cornell box using a mixture of glass &amp; light PDFs
  </span></center></div></center>

<p></p><p>

</p></div>

<p></p>
<a class="target" name="handlingsurfaceacne">&nbsp;</a><a class="target" name="cleaninguppdfmanagement/handlingsurfaceacne">&nbsp;</a><a class="target" name="toc12.6">&nbsp;</a><h2>Handling Surface Acne</h2>
<p>

An astute reader pointed out there are some black specks in the image above. All Monte Carlo Ray
Tracers have this as a main loop:

</p><pre class="listing tilde"><code><span class="line"></span>pixel_color = average(many many samples)</code></pre><p>

If you find yourself getting some form of acne in your renders, and this acne is white or black —
where one “bad” sample seems to kill the whole pixel — then that sample is probably a huge number
or a <code>NaN</code> (Not A Number). This particular acne is probably a <code>NaN</code>. Mine seems to come up once in
every 10–100 million rays or so.

</p><p>

</p><div class="together">
So big decision: sweep this bug under the rug and check for <code>NaN</code>s, or just kill <code>NaN</code>s and hope
this doesn't come back to bite us later. I will always opt for the lazy strategy, especially when I
know that working with floating point is hard. First, how do we check for a <code>NaN</code>? The one thing I
always remember for <code>NaN</code>s is that a <code>NaN</code> does not equal itself. Using this trick, we update the
<code>write_color()</code> function to replace any <code>NaN</code> components with zero:

<p></p><pre class="listing tilde"><code><span class="line"></span><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">write_color</span><span class="hljs-params">(std::ostream&amp; out, <span class="hljs-type">const</span> color&amp; pixel_color)</span> </span>{
<span class="line"></span>    <span class="hljs-keyword">auto</span> r = pixel_color.<span class="hljs-built_in">x</span>();
<span class="line"></span>    <span class="hljs-keyword">auto</span> g = pixel_color.<span class="hljs-built_in">y</span>();
<span class="line"></span>    <span class="hljs-keyword">auto</span> b = pixel_color.<span class="hljs-built_in">z</span>();
<span class="line"></span>
<span class="line"></span><div class=" highlight"><span class="line"></span>    <span class="hljs-comment">// Replace NaN components with zero.</span>
<span class="line"></span>    <span class="hljs-keyword">if</span> (r != r) r = <span class="hljs-number">0.0</span>;
<span class="line"></span>    <span class="hljs-keyword">if</span> (g != g) g = <span class="hljs-number">0.0</span>;
<span class="line"></span>    <span class="hljs-keyword">if</span> (b != b) b = <span class="hljs-number">0.0</span>;</div><span class="line"></span>
<span class="line"></span>    <span class="hljs-comment">// Apply a linear to gamma transform for gamma 2</span>
<span class="line"></span>    r = <span class="hljs-built_in">linear_to_gamma</span>(r);
<span class="line"></span>    g = <span class="hljs-built_in">linear_to_gamma</span>(g);
<span class="line"></span>    b = <span class="hljs-built_in">linear_to_gamma</span>(b);
<span class="line"></span>
<span class="line"></span>    <span class="hljs-comment">// Translate the [0,1] component values to the byte range [0,255].</span>
<span class="line"></span>    <span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">const</span> interval <span class="hljs-title">intensity</span><span class="hljs-params">(<span class="hljs-number">0.000</span>, <span class="hljs-number">0.999</span>)</span></span>;
<span class="line"></span>    <span class="hljs-type">int</span> rbyte = <span class="hljs-built_in">int</span>(<span class="hljs-number">256</span> * intensity.<span class="hljs-built_in">clamp</span>(r));
<span class="line"></span>    <span class="hljs-type">int</span> gbyte = <span class="hljs-built_in">int</span>(<span class="hljs-number">256</span> * intensity.<span class="hljs-built_in">clamp</span>(g));
<span class="line"></span>    <span class="hljs-type">int</span> bbyte = <span class="hljs-built_in">int</span>(<span class="hljs-number">256</span> * intensity.<span class="hljs-built_in">clamp</span>(b));
<span class="line"></span>
<span class="line"></span>    <span class="hljs-comment">// Write out the pixel color components.</span>
<span class="line"></span>    out &lt;&lt; rbyte &lt;&lt; <span class="hljs-string">' '</span> &lt;&lt; gbyte &lt;&lt; <span class="hljs-string">' '</span> &lt;&lt; bbyte &lt;&lt; <span class="hljs-string">'\n'</span>;
<span class="line"></span>}</code></pre><center><div class="listingcaption tilde"><a class="target" name="listing_write-color-nan">&nbsp;</a><b style="font-style:normal;">Listing&nbsp;56:</b> <kbd>[color.h]</kbd> NaN-tolerant write_color function</div></center>
<p>


</p></div>

<p></p><p>

</p><div class="together">
Happily, the black specks are gone:

<p></p><p>

  </p><center><div class="image" style=""><a href="./input_files/img-3.15-book3-final.jpg" target="_blank"><img class="markdeep pixel" src="./input_files/img-3.15-book3-final.jpg"></a><center><span class="imagecaption"><span class="num">Image 15:</span> Cornell box with anti-acne color function
  </span></center></div></center>

<p></p><p>

</p></div>

<p></p>
<a class="target" name="therestofyourlife">&nbsp;</a><a class="target" name="therestofyourlife">&nbsp;</a><a class="target" name="toc13">&nbsp;</a><h1>The Rest of Your Life</h1>
<p>

The purpose of this book was to walk through all of the little details (dotting all the i's and
crossing all of the t's) necessary when organizing a physically based renderer’s sampling approach.
You should now be able to take all of this detail and explore a lot of different potential paths.

</p><p>

If you want to explore Monte Carlo methods, look into bidirectional and path spaced approaches such
as Metropolis. Your probability space won't be over solid angle, but will instead be over path
space, where a path is a multidimensional point in a high-dimensional space. Don’t let that scare
you — if you can describe an object with an array of numbers, mathematicians call it a point in the
space of all possible arrays of such points. That’s not just for show. Once you get a clean
abstraction like that, your code can get clean too. Clean abstractions are what programming is all
about!

</p><p>

If you want to do movie renderers, look at the papers out of studios and Solid Angle. They are
surprisingly open about their craft.

</p><p>

If you want to do high-performance ray tracing, look first at papers from Intel and NVIDIA. They are
also surprisingly open.

</p><p>

If you want to do hard-core physically based renderers, convert your renderer from RGB to spectral.
I am a big fan of each ray having a random wavelength and almost all the RGBs in your program
turning into floats. It sounds inefficient, but it isn’t!

</p><p>

Regardless of what direction you take, add a glossy BRDF model. There are many to choose from, and
each has its advantages.

</p><p>

Have fun!

</p><p>

<a href="https://github.com/petershirley">Peter Shirley</a><br>
Salt Lake City, March, 2016

</p>
<a class="target" name="acknowledgments">&nbsp;</a><a class="target" name="acknowledgments">&nbsp;</a><a class="target" name="toc14">&nbsp;</a><h1>Acknowledgments</h1>
<p>


</p><div class="credit-list"> <strong class="asterisk">Original Manuscript Help</strong>

<p></p><p>

</p><ul>
  <li class="minus">Dave Hart
</li>
  <li class="minus">Jean Buckley</li></ul>

<p></p><p>

</p></div>

<p></p><p>

</p><div class="credit-list"> <strong class="asterisk">Web Release</strong>

<p></p><p>

</p><ul>
  <li class="minus"><a href="https://github.com/bernakabadayi">Berna Kabadayı</a>
</li>
  <li class="minus"><a href="https://github.com/lmancini">Lorenzo Mancini</a>
</li>
  <li class="minus"><a href="https://github.com/lorihollasch">Lori Whippler Hollasch</a>
</li>
  <li class="minus"><a href="https://github.com/ronaldfw">Ronald Wotzlaw</a></li></ul>

<p></p><p>

</p></div>

<p></p><p>

</p><div class="credit-list"> <strong class="asterisk">Corrections and Improvements</strong>

<p></p><p>

</p><ul>
  <li class="minus"><a href="https://github.com/jammm">Aaryaman Vasishta</a>
</li>
  <li class="minus">Andrew Kensler
</li>
  <li class="minus"><a href="https://github.com/antoniogamiz">Antonio Gamiz</a>
</li>
  <li class="minus">Apoorva Joshi
</li>
  <li class="minus"><a href="https://github.com/aras-p">Aras Pranckevičius</a>
</li>
  <li class="minus"><a href="https://github.com/armansito">Arman Uguray</a>
</li>
  <li class="minus">Becker
</li>
  <li class="minus">Ben Kerl
</li>
  <li class="minus">Benjamin Summerton
</li>
  <li class="minus">Bennett Hardwick
</li>
  <li class="minus"><a href="https://bthtsang.github.io/">Benny Tsang</a>
</li>
  <li class="minus">Dan Drummond
</li>
  <li class="minus"><a href="https://github.com/dafhi">David Chambers</a>
</li>
  <li class="minus">David Hart
</li>
  <li class="minus"><a href="https://github.com/mu-lambda">Dmitry Lomov</a>
</li>
  <li class="minus"><a href="https://github.com/erich666">Eric Haines</a>
</li>
  <li class="minus">Fabio Sancinetti
</li>
  <li class="minus">Filipe Scur
</li>
  <li class="minus">Frank He
</li>
  <li class="minus"><a href="https://github.com/TheThief">Gareth Martin</a>
</li>
  <li class="minus"><a href="https://github.com/celeph">Gerrit Wessendorf</a>
</li>
  <li class="minus">Grue Debry
</li>
  <li class="minus"><a href="https://github.com/xaldew">Gustaf Waldemarson</a>
</li>
  <li class="minus">Ingo Wald
</li>
  <li class="minus">Jason Stone
</li>
  <li class="minus"><a href="https://github.com/JC-ProgJava">JC-ProgJava</a>
</li>
  <li class="minus">Jean Buckley
</li>
  <li class="minus">Joey Cho
</li>
  <li class="minus"><a href="https://github.com/rjkilpatrick">John Kilpatrick</a>
</li>
  <li class="minus"><a href="https://github.com/D-K-E">Kaan Eraslan</a>
</li>
  <li class="minus"><a href="https://github.com/lmancini">Lorenzo Mancini</a>
</li>
  <li class="minus"><a href="https://github.com/manas96">Manas Kale</a>
</li>
  <li class="minus">Marcus Ottosson
</li>
  <li class="minus"><a href="https://github.com/mrmcsoftware">Mark Craig</a>
</li>
  <li class="minus">Markus Boos
</li>
  <li class="minus">Matthew Heimlich
</li>
  <li class="minus">Nakata Daisuke
</li>
  <li class="minus"><a href="https://github.com/rupsis">Nate Rupsis</a>
</li>
  <li class="minus">Paul Melis
</li>
  <li class="minus">Phil Cristensen
</li>
  <li class="minus"><a href="https://github.com/LollipopFt">LollipopFt</a>
</li>
  <li class="minus"><a href="https://github.com/ronaldfw">Ronald Wotzlaw</a>
</li>
  <li class="minus"><a href="https://github.com/shaunplee">Shaun P. Lee</a>
</li>
  <li class="minus"><a href="https://github.com/estshorter">Shota Kawajiri</a>
</li>
  <li class="minus">Tatsuya Ogawa
</li>
  <li class="minus">Thiago Ize
</li>
  <li class="minus">Vahan Sosoyan
</li>
  <li class="minus"><a href="https://github.com/wlbksy">WANG Lei</a>
</li>
  <li class="minus"><a href="https://github.com/ymherklotz">Yann Herklotz</a>
</li>
  <li class="minus"><a href="https://github.com/oxine">ZeHao Chen</a></li></ul>

<p></p><p>

</p></div>

<p></p><p>

</p><div class="credit-list"> <strong class="asterisk">Special Thanks</strong>

<p></p><p>

  </p><div class="indented">
  Thanks to the team at <a href="https://limnu.com/">Limnu</a> for help on the figures.

<p></p><p>

  These books are entirely written in Morgan McGuire's fantastic and free
  <a href="https://casual-effects.com/markdeep/">Markdeep</a> library. To see what this looks like, view the
  page source from your browser.

</p><p>

  Thanks to <a href="https://github.com/hhu">Helen Hu</a> for graciously donating her
  <a href="https://github.com/RayTracing/" class="url">https://github.com/RayTracing/</a> GitHub organization to this project.

</p><p>

  </p></div>
</div>

<p></p><p>

<link rel="stylesheet" href="./input_files/book.css">

</p>
<a class="target" name="citingthisbook">&nbsp;</a><a class="target" name="citingthisbook">&nbsp;</a><a class="target" name="toc15">&nbsp;</a><h1>Citing This Book</h1>
<p>

Consistent citations make it easier to identify the source, location and versions of this work. If
you are citing this book, we ask that you try to use one of the following forms if possible.

</p>
<a class="target" name="basicdata">&nbsp;</a><a class="target" name="citingthisbook/basicdata">&nbsp;</a><a class="target" name="toc15.1">&nbsp;</a><h2>Basic Data</h2>
<p>


</p><ul>
  <li class="minus"><strong class="asterisk">Title (series)</strong>: “Ray Tracing in One Weekend Series”
</li>
  <li class="minus"><strong class="asterisk">Title (book)</strong>: “Ray Tracing: The Rest of Your Life”
</li>
  <li class="minus"><strong class="asterisk">Author</strong>: Peter Shirley, Trevor David Black, Steve Hollasch
</li>
  <li class="minus"><strong class="asterisk">Version/Edition</strong>: v4.0.0-alpha.2
</li>
  <li class="minus"><strong class="asterisk">Date</strong>: 2024-04-07
</li>
  <li class="minus"><strong class="asterisk">URL (series)</strong>: <a href="https://raytracing.github.io/" class="url">https://raytracing.github.io</a>
</li>
  <li class="minus"><strong class="asterisk">URL (book)</strong>: <a href="https://raytracing.github.io/books/raytracingtherestofyourlife.html" class="url">https://raytracing.github.io/books/raytracingtherestofyourlife.html</a></li></ul>

<p></p>
<a class="target" name="snippets">&nbsp;</a><a class="target" name="citingthisbook/snippets">&nbsp;</a><a class="target" name="toc15.2">&nbsp;</a><h2>Snippets</h2>

<a class="target" name="markdown">&nbsp;</a><a class="target" name="citingthisbook/snippets/markdown">&nbsp;</a><a class="target" name="toc15.2.1">&nbsp;</a><h3>Markdown</h3>
<pre class="listing tilde"><code><span class="line"></span>[<span class="hljs-meta">_Ray Tracing: The Rest of Your Life_</span>](https:<span class="hljs-comment">//raytracing.github.io/books/RayTracingTheRestOfYourLife.html)</span></code></pre>
<a class="target" name="html">&nbsp;</a><a class="target" name="citingthisbook/snippets/html">&nbsp;</a><a class="target" name="toc15.2.2">&nbsp;</a><h3>HTML</h3>
<pre class="listing tilde"><code><span class="line"></span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html"</span>&gt;</span>
<span class="line"></span>    <span class="hljs-tag">&lt;<span class="hljs-name">cite</span>&gt;</span>Ray Tracing: The Rest of Your Life<span class="hljs-tag">&lt;/<span class="hljs-name">cite</span>&gt;</span>
<span class="line"></span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>
<a class="target" name="latexandbibtex">&nbsp;</a><a class="target" name="citingthisbook/snippets/latexandbibtex">&nbsp;</a><a class="target" name="toc15.2.3">&nbsp;</a><h3>LaTeX and BibTex</h3>
<pre class="listing tilde"><code><span class="line"></span>~\cite{Shirley2024RTW3}
<span class="line"></span>
<span class="line"></span><span class="hljs-meta">@misc</span>{Shirley2024RTW3,
<span class="line"></span>   title = {Ray Tracing: The Rest of Your Life},
<span class="line"></span>   author = {Peter Shirley, Trevor David Black, Steve Hollasch},
<span class="line"></span>   year = {<span class="hljs-number">2024</span>},
<span class="line"></span>   month = {April},
<span class="line"></span>   note = {\small \texttt{https:<span class="hljs-comment">//raytracing.github.io/books/RayTracingTheRestOfYourLife.html}},</span>
<span class="line"></span>   url = {https:<span class="hljs-comment">//raytracing.github.io/books/RayTracingTheRestOfYourLife.html}</span>
<span class="line"></span>}</code></pre>
<a class="target" name="biblatex">&nbsp;</a><a class="target" name="citingthisbook/snippets/biblatex">&nbsp;</a><a class="target" name="toc15.2.4">&nbsp;</a><h3>BibLaTeX</h3>
<pre class="listing tilde"><code><span class="line"></span>\usepackage{biblatex}
<span class="line"></span>
<span class="line"></span>~\cite{Shirley2024RTW3}
<span class="line"></span>
<span class="line"></span><span class="hljs-meta">@online</span>{Shirley2024RTW3,
<span class="line"></span>   title = {Ray Tracing: The Rest of Your Life},
<span class="line"></span>   author = {Peter Shirley, Trevor David Black, Steve Hollasch},
<span class="line"></span>   year = {<span class="hljs-number">2024</span>},
<span class="line"></span>   month = {April},
<span class="line"></span>   url = {https:<span class="hljs-comment">//raytracing.github.io/books/RayTracingTheRestOfYourLife.html}</span>
<span class="line"></span>}</code></pre>
<a class="target" name="ieee">&nbsp;</a><a class="target" name="citingthisbook/snippets/ieee">&nbsp;</a><a class="target" name="toc15.2.5">&nbsp;</a><h3>IEEE</h3>
<pre class="listing tilde"><code><span class="line"></span>“Ray Tracing: The Rest of Your Life.”
<span class="line"></span>raytracing.github.io/books/RayTracingTheRestOfYourLife.html
<span class="line"></span>(accessed MMM. DD, YYYY)</code></pre>
<a class="target" name="mla:">&nbsp;</a><a class="target" name="citingthisbook/snippets/mla:">&nbsp;</a><a class="target" name="toc15.2.6">&nbsp;</a><h3>MLA:</h3>
<pre class="listing tilde"><code><span class="line"></span>Ray Tracing: The Rest of Your Life. raytracing.github.io/books/RayTracingTheRestOfYourLife.html
<span class="line"></span>Accessed DD MMM. YYYY.</code></pre><p>














<link rel="stylesheet" href="./input_files/book.css">

</p><p>

</p></span><div id="mdContextMenu" style="visibility:hidden"></div><div class="markdeepFooter"><i>formatted by <a href="https://casual-effects.com/markdeep" style="color:#999">Markdeep&nbsp;1.15&nbsp;&nbsp;</a></i><div style="display:inline-block;font-size:13px;font-family:&#39;Times New Roman&#39;,serif;vertical-align:middle;transform:translate(-3px,-1px)rotate(135deg);">✒</div></div><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; min-width: 0px; max-width: none; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: STIXSizeOneSym, monospace;"></div></div></body></html>